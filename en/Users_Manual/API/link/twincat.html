<!DOCTYPE HTML>
<html lang="en" class="navy sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>TwinCAT - AUTD3 Developers Manual v36.0.2</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../../favicon.svg">
        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../../css/codeblock_filename.css">
        <link rel="stylesheet" href="../../../css/lightbox.css">
        <link rel="stylesheet" href="../../../css/open-in.css">
        <link rel="stylesheet" href="../../../css/no-link-summary.css">
        <link rel="stylesheet" href="../../../css/tab.css">
        <link rel="stylesheet" href="../../../css/faq.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">AUTD3 Developers Manual v36.0.2</h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shinolab/autd3-doc" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="twincat"><a class="header" href="#twincat">TwinCAT</a></h1>
<p>TwinCAT is the only official way to use EtherCAT on a Windows PC.
TwinCAT is specialized software that only supports Windows and forces Windows to operate in real-time.</p>
<p>TwinCAT requires specific network controllers, so please check the <a href="https://infosys.beckhoff.com/english.php?content=../content/1033/tc3_overview/9309844363.html&amp;id=">list of compatible network controllers</a>.</p>
<blockquote>
<p>Note: Alternatively, after installing TwinCAT, you can see the Vendor ID and Device ID of supported network controllers in <code>C:/TwinCAT/3.1/Driver/System/TcI8254x.inf</code>. The Vendor ID and Device ID of your network controller can be checked in “Device Manager” → “Ethernet Adapter” → “Properties” → “Details” → “Hardware ID”.</p>
</blockquote>
<p>It may work with network controllers other than those listed above, but in that case, normal operation and real-time performance are not guaranteed.</p>
<ul>
<li><a href="#prerequisites">Prerequisites</a>
<ul>
<li><a href="#installing-twincat">Installing TwinCAT</a></li>
<li><a href="#installing-autd3-server">Installing AUTD3 Server</a></li>
<li><a href="#initial-setup">Initial Setup</a></li>
<li><a href="#running-autd-server">Running AUTD Server</a></li>
<li><a href="#license">License</a></li>
</ul>
</li>
<li><a href="#twincat-link">TwinCAT Link</a>
<ul>
<li><a href="#install">Install</a></li>
<li><a href="#apis">APIs</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
</ul>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<p>As a prerequisite, TwinCAT cannot coexist with Hyper-V or Virtual Machine Platform.
Therefore, these features need to be disabled.
For example, you can disable them by opening PowerShell with administrator privileges and typing:</p>
<pre><code class="language-PowerShell">Disable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V-Hypervisor
Disable-WindowsOptionalFeature -Online -FeatureName VirtualMachinePlatform
</code></pre>
<p>Also, for Windows 11, you need to turn off the virtualization-based security feature.
Go to “Windows Security” → “Device Security” → “Core Isolation” → “Memory Integrity” and turn it off.
From Windows 11 24H2, you may also need to set the registry value <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceGuard\EnableVirtualizationBasedSecurity</code> to 0.</p>
<h3 id="installing-twincat"><a class="header" href="#installing-twincat">Installing TwinCAT</a></h3>
<p>Refer to the <a href="https://infosys.beckhoff.com/content/1033/tc3_installation/15698617995.html?id=7523796010185393366">official site</a> and install TwinCAT 3.1 Build 4026.
(You will need to register for a myBeckhoff account (free) to install it.)
Make sure to install the 64-bit version of TwinCAT Xae Shell.
Visual Studio Integration is not required.</p>
<p>After installing the Package Manager, you can install “TwinCAT Standard” using the Package Manager.</p>
<h3 id="installing-autd3-server"><a class="header" href="#installing-autd3-server">Installing AUTD3 Server</a></h3>
<p>To use TwinCAT Link, you first need to install <code>AUTD3 Server</code>.
The installer is distributed on <a href="https://github.com/shinolab/autd3-server">GitHub</a>, so download it and follow the instructions to install it.</p>
<blockquote>
<p>NOTE: There is also a <a href="https://github.com/shinolab/TwinCATAUTDServer/releases">CLI version</a>.</p>
</blockquote>
<p>When you run <code>AUTD3 Server</code>, the following screen will appear, so open the <code>TwinCAT</code> tab.</p>
<figure>
  <img src="../../../fig/Users_Manual/autdserver_twincat.jpg"/>
</figure>
<h3 id="initial-setup"><a class="header" href="#initial-setup">Initial Setup</a></h3>
<p>The following tasks are required only for the first time.</p>
<p>First, press the “Copy AUTD.xml” button.
If a message like “AUTD.xml is successfully copied” appears, it is successful.</p>
<p>Next, press the “Open XAE Shell” button to open the XAE Shell.
From the top menu of TwinCAT XAE Shell, open “TwinCAT” → “Show Realtime Ethernet Compatible Devices”, select the compatible device from “Compatible devices”, and click Install.
If the installed adapter is displayed in “Installed and ready to use devices (realtime capable)”, it is successful.</p>
<p>If nothing is displayed in “Compatible devices”, the Ethernet device of that PC is not compatible with TwinCAT.
Drivers in “Incompatible devices” can also be installed, and if installed, they will be displayed as “Installed and ready to use devices (for demo use only)”.
In this case, it can be used but is not guaranteed to work.</p>
<h3 id="running-autd-server"><a class="header" href="#running-autd-server">Running AUTD Server</a></h3>
<p>Connect AUTD3 to the PC and with AUTD3 powered on, press the “Run” button.
At this time, leave the “Client IP address” field blank.</p>
<p>If a message appears indicating that the AUTD3 device has been found, as shown in the screen below, it is successful.</p>
<figure>
  <img src="../../../fig/Users_Manual/autdserver_twincat_run.jpg"/>
</figure>
<p>Note that TwinCAT will disconnect when the PC is powered off, enters sleep mode, etc., so you need to run it again each time.</p>
<h3 id="license"><a class="header" href="#license">License</a></h3>
<p>The first time, a license-related error will appear, so open “Solution Explorer” → “SYSTEM” → “License” in XAE Shell, click “7 Days Trial License …”, and enter the characters displayed on the screen.
Note that the license is a 7-day trial license, but you can reissue it by performing the same operation again after it expires.
After issuing the license, close “TwinCAT XAE Shell” and run it again.</p>
<h2 id="twincat-link"><a class="header" href="#twincat-link">TwinCAT Link</a></h2>
<h3 id="install"><a class="header" href="#install">Install</a></h3>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C#-tab-0">C#</label><input id="Unity-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Unity-tab-0">Unity</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-shell">cargo add autd3-link-twincat
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp name=CMakeLists.txt">target_link_libraries(&lt;TARGET&gt; PRIVATE autd3::link::twincat)
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Unity-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<p>Included in the main library.</p>
</div></div>
<h3 id="apis"><a class="header" href="#apis">APIs</a></h3>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust">use autd3_link_twincat::TwinCAT;

<span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let _ = 
</span>TwinCAT::new()?;
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp">#include "autd3/link/twincat.hpp"

<span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>link::TwinCAT();
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs">using AUTD3Sharp.Link;

new TwinCAT();
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python">from pyautd3.link.twincat import TwinCAT

TwinCAT()
</code></pre>
</div></div>
<h3 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h3>
<p>When trying to use a large number of devices, an error like the one shown below may occur.</p>
<figure>
  <img src="../../../fig/Users_Manual/tcerror.jpg"/>
  <figcaption>TwinCAT error when using 9 AUTD3 devices</figcaption>
</figure>
<p>In this case, increase the values of <code>Sync0 cycle time</code> and <code>Send task cycle time</code> in <code>AUTD3 Server</code>, and run AUTD Server again.
The default values for these options are <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">ms</span></span></span></span></span></span> each.</p>
<p>The appropriate values depend on the number of devices connected.
The smallest possible value that does not cause an error is desirable.
For example, for 9 devices, a value of about <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.5</span></span></span></span>–<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">ms</span></span></span></span></span></span> should work.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/link/twincat.md">Edit this page on GitHub.</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../Users_Manual/API/link.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../../Users_Manual/API/link/ethercrab.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../Users_Manual/API/link.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../../Users_Manual/API/link/ethercrab.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../elasticlunr.min.js"></script>
        <script src="../../../mark.min.js"></script>
        <script src="../../../searcher.js"></script>

        <script src="../../../clipboard.min.js"></script>
        <script src="../../../highlight.js"></script>
        <script src="../../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../../js/codeblock_filename.js"></script>
        <script src="../../../js/lightbox-plus-jquery.min.js"></script>


    </div>
    </body>
</html>
