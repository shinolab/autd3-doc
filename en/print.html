<!DOCTYPE HTML>
<html lang="en" class="navy sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>AUTD3 Developers Manual v36.0.2</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="css/codeblock_filename.css">
        <link rel="stylesheet" href="css/lightbox.css">
        <link rel="stylesheet" href="css/open-in.css">
        <link rel="stylesheet" href="css/no-link-summary.css">
        <link rel="stylesheet" href="css/tab.css">
        <link rel="stylesheet" href="css/faq.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">AUTD3 Developers Manual v36.0.2</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shinolab/autd3-doc" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="about-autd3"><a class="header" href="#about-autd3">About AUTD3</a></h1>
<p>AUTD3 is an ultrasound phased array device for midair haptics.
An ultrasound phased array is an array of ultrasound transducers whose phases can be individually controlled (typically arranged in a grid).
By controlling the phase of the ultrasound, it is possible to generate arbitrary sound fields in space.</p>
<p>The energy of sound waves sufficiently focused using a phased array generates acoustic radiation pressure.
This pressure can be used to push the surface of the human body without contact.
The position of the focal point can be freely controlled by electronically controlling the phased array.
Additionally, by solving the inverse problem, it is possible to create more complex sound pressure spatial distributions, not just a single focal point.</p>
<p>The upper limit of the pressure that can be generated by a phased array is currently about <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">50</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">mN/c</span><span class="mord"><span class="mord mathrm">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">5</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">gf/c</span><span class="mord"><span class="mord mathrm">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span>.
The spatial resolution is up to the wavelength used (about <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">8.5</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">mm</span></span></span></span></span></span> at <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord">40</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">kHz</span></span></span></span></span></span>).
Although there are such limitations with phased arrays, it is attracting attention as a technology that can freely design the spatiotemporal distribution of force and create various haptic sensations.</p>
<p>This field of technology, which stimulates haptics without contact, is called <strong>Midair Haptics</strong>, and we call this ultrasound midair haptic device <strong>Airborne Ultrasound Tactile Display (AUTD)</strong>.
The essential part of AUTD was proposed and established by the University of Tokyo from 2008<sup class="footnote-reference"><a href="#1">1</a></sup> to the early 2010s<sup class="footnote-reference"><a href="#2">2</a></sup>.
Since then, universities and companies around the world have entered the field, and active research and development are being conducted.
AUTD3 is the third version of AUTD developed by our Shinoda-Makino Laboratory at the University of Tokyo.</p>
<p>A list of research using AUTD is posted on the <a href="https://hapislab.org/airborne-ultrasound-tactile-display">laboratory’s homepage</a>. Please refer to it as well.</p>
<p>This manual summarizes the <a href="https://github.com/shinolab/autd3">autd3</a> software library for operating this AUTD3.</p>
<div class="footnote-definition" id="1"><sup class="footnote-definition-label">1</sup>
<p><a href="https://hapislab.org/public/hiroyuki_shinoda/research/pdf/08Eurohaptics_iwamoto.pdf">Takayuki Iwamoto, Mari Tatezono, and Hiroyuki Shinoda: Non-contact Method for Producing Tactile Sensation Using Airborne Ultrasound, Haptics: Perception, Devices and Scenarios: 6th International Conference, Eurohaptics 2008 Proceedings (Lecture Notes in Computer Science), pp.504-513, 2008.</a></p>
</div>
<div class="footnote-definition" id="2"><sup class="footnote-definition-label">2</sup>
<p><a href="https://hapislab.org/public/hiroyuki_shinoda/research/pdf/10_Trans_Haptics_Hoshi.pdf">Takayuki Hoshi, Masafumi Takahashi, Takayuki Iwamoto, and Hiroyuki Shinoda: Noncontact Tactile Display Based on Radiation Pressure of Airborne Ultrasound, IEEE Trans. on Haptics, Vol. 3, No. 3, pp.155-165, 2010.</a></p>
</div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/about_AUTD3.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h1>
<p>This section first describes the setup of AUTD3 hardware, firmware, and software.</p>
<ul>
<li><a href="Users_Manual/./getting_started/hardware.html">Hardware</a></li>
<li><a href="Users_Manual/./getting_started/firmware.html">Firmware</a></li>
<li><a href="Users_Manual/./getting_started/software.html">Software</a></li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/getting_started.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="hardware"><a class="header" href="#hardware">Hardware</a></h1>
<h2 id="autd3-device"><a class="header" href="#autd3-device">AUTD3 Device</a></h2>
<p>The AUTD3 device consists of 249 transducers per unit<sup class="footnote-reference"><a href="#fn_asm">1</a></sup>.
Furthermore, multiple devices can be connected and expanded via daisy-chain.
From the SDK, the phase/intensity of all these transducers can be individually specified.</p>
<figure>
  <img src="Users_Manual/getting_started/../../fig/Users_Manual/autd_trans_idx.jpg"/>
  <figcaption>Surface photo of AUTD</figcaption>
</figure>
<figure>
  <img src="Users_Manual/getting_started/../../fig/Users_Manual/autd_back.jpg"/>
  <figcaption>Back photo of AUTD</figcaption>
</figure>
<p>The coordinate system of AUTD3 adopts the right-handed coordinate system, with the center of the 0-th transducer as the origin.
The x-axis is in the long axis direction, i.e., the direction from 0 to 17, and the y-axis is in the direction from 0 to 18.</p>
<p>Also, the unit of distance is mm.
The transducers are arranged at intervals of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">10.16</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">mm</span></span></span></span></span></span>, and the size including the board is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">192</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">mm</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">151.4</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">mm</span></span></span></span></span></span>.</p>
<h2 id="setup"><a class="header" href="#setup">Setup</a></h2>
<p>Connect the PC and “EtherCAT In” of the first device with an ethernet cable (CAT 5e or higher), and connect “EtherCAT Out” of the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>-th device to “EtherCAT In” of the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>-th device.</p>
<p>The power supply for AUTD3 uses a <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">24</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm" style="margin-right:0.01389em;">V</span></span></span></span></span> DC.
The power supply can be connected mutually, and any of the three power connectors can be used.
The power connector on the AUTD3 device side uses Molex 5566-02A.</p>
<blockquote>
<p>NOTE: AUTD3 consumes a maximum of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathrm">A</span></span></span></span></span> per device. Pay attention to the maximum output current of the power supply.</p>
</blockquote>
<h2 id="dimension-diagram"><a class="header" href="#dimension-diagram">Dimension Diagram</a></h2>
<figure>
  <img src="Users_Manual/getting_started/../../fig/Users_Manual/transducers_array.jpg"/>
  <figcaption>Dimensions diagram of the AUTD3 device</figcaption>
</figure>
<div class="footnote-definition" id="fn_asm"><sup class="footnote-definition-label">1</sup>
<p>Out of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">18</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">14</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">252</span></span></span></span>, 3 transducers are removed for screws. The reason for placing the screw holes in this position is to minimize the gap when multiple units are lined up.</p>
</div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/getting_started/hardware.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="firmware"><a class="header" href="#firmware">Firmware</a></h1>
<p>To update the firmware, you need a Windows 10/11 64bit PC with <a href="https://www.xilinx.com/products/design-tools/vivado.html">Vivado</a> and <a href="https://www.segger.com/downloads/jlink/">J-Link Software</a> installed.
We tested with Vivado 2025.1 and J-Link Software v8.10.</p>
<blockquote>
<p>NOTE: If the sole purpose is to update the firmware, it is strongly recommended to use “<strong>Vivado Lab Edition</strong>”.
ML Edition requires more than 60 GB of disk space for installation. Lab Edition requires about 6 GB of disk space.</p>
</blockquote>
<blockquote>
<p>NOTE: When using an old J-Link device, check “<strong>Install legacy USB Driver for J-Link</strong>”.
For example, J-Link Plus V10 and earlier require a legacy USB Driver. (The version is written on the back of the J-Link Plus device.)
For more details, refer to the <a href="https://wiki.segger.com/J-Link_Model_Overview">Segger Wiki</a>. If the device you are using has the WinUSB feature, the legacy USB Driver is not required.</p>
</blockquote>
<p>First, connect the AUTD3 device and the PC with a <a href="https://www.xilinx.com/products/boards-and-kits/hw-usb-ii-g.html">XILINX Platform Cable</a> and a <a href="https://www.segger-pocjapan.com/j-link-9-pin-cortex-m-adapter">J-Link 9-Pin Cortex-M Adapter</a> attached to a <a href="https://www.segger.com/products/debug-probes/j-link/models/j-link-plus/">J-Link Plus</a>, and turn on the power of the AUTD3.
Next, execute <code>autd_firmware_writer.ps1</code> in the <a href="https://github.com/shinolab/autd3-firmware">autd3-firmware</a> from PowerShell and follow the instructions. The update takes a few minutes.</p>
<pre><code class="language-shell">git clone https://github.com/shinolab/autd3-firmware
cd autd3-firmware
pwsh autd_firmware_writer.ps1
</code></pre>
<figure>
    <img src="Users_Manual/getting_started/../../fig/Users_Manual/cable.jpg"/>
    <figcaption>Firmware update cable connection</figcaption>
</figure>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/getting_started/firmware.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="software"><a class="header" href="#software">Software</a></h1>
<p>Basically, it supports the standard package managers for each language.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C#-tab-0">C#</label><input id="Unity-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Unity-tab-0">Unity</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<ul>
<li><a href="https://crates.io/crates/autd3">autd3</a></li>
<li><a href="https://crates.io/crates/autd3-gain-holo">autd3-gain-holo</a></li>
<li><a href="https://crates.io/crates/autd3-modulation-audio-file">autd3-modulation-audio-file</a></li>
<li><a href="https://crates.io/crates/autd3-link-twincat">autd3-link-twincat</a></li>
<li><a href="https://crates.io/crates/autd3-link-ethercrab">autd3-link-ethercrab</a></li>
<li><a href="https://crates.io/crates/autd3-link-simulator">autd3-link-simulator</a></li>
<li><a href="https://crates.io/crates/autd3-link-soem">autd3-link-soem</a></li>
<li><a href="https://crates.io/crates/autd3-emulator">autd3-emulator</a></li>
</ul>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<p>Can be installed using CMake’s FetchContent.</p>
<ul>
<li>autd3
<ul>
<li>Windows: <a href="https://github.com/shinolab/autd3-cpp/releases/download/v36.0.2/autd3-v36.0.2-win-x64.zip">https://github.com/shinolab/autd3-cpp/releases/download/v36.0.2/autd3-v36.0.2-win-x64.zip</a></li>
<li>macOS: <a href="https://github.com/shinolab/autd3-cpp/releases/download/v36.0.2/autd3-v36.0.2-macos-aarch64.tar.gz">https://github.com/shinolab/autd3-cpp/releases/download/v36.0.2/autd3-v36.0.2-macos-aarch64.tar.gz</a></li>
<li>Linux: <a href="https://github.com/shinolab/autd3-cpp/releases/download/v36.0.2/autd3-v36.0.2-linux-x64.tar.gz">https://github.com/shinolab/autd3-cpp/releases/download/v36.0.2/autd3-v36.0.2-linux-x64.tar.gz</a></li>
</ul>
</li>
</ul>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<p>Published on NuGet.</p>
<ul>
<li><a href="https://www.nuget.org/packages/AUTD3Sharp">AUTD3Sharp</a></li>
</ul>
</div><div class="mdbook-inpage-tab-content" id=Unity-content>
<p>Can be installed via Unity Package Manager.
Add the following repositories.</p>
<ul>
<li>AUTD3Sharp: <a href="https://github.com/shinolab/AUTD3Sharp.git#upm/latest">https://github.com/shinolab/AUTD3Sharp.git#upm/latest</a></li>
</ul>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<p>Published on PyPI.</p>
<ul>
<li><a href="https://pypi.org/project/pyautd3/">pyautd3</a></li>
<li><a href="https://pypi.org/project/pyautd3_emulator/">pyautd3_emulator</a></li>
</ul>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/getting_started/software.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="tutorial"><a class="header" href="#tutorial">Tutorial</a></h1>
<p>This section describes the steps to actually operate the AUTD3 devices.</p>
<ul>
<li><a href="Users_Manual/./tutorial/single.html">Single Device</a></li>
<li><a href="Users_Manual/./tutorial/multiple.html">Multiple Devices</a></li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/tutorial.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="single-device"><a class="header" href="#single-device">Single Device</a></h1>
<p>This section explains how to drive a single device.</p>
<h2 id="installing-dependencies"><a class="header" href="#installing-dependencies">Installing Dependencies</a></h2>
<p>This tutorial uses <a href="https://github.com/ethercrab-rs/ethercrab">EtherCrab</a>.
If you are using Windows, install <a href="https://npcap.com/">Npcap</a> in “<strong>WinPcap API-compatible Mode</strong>”.</p>
<p>Note that if the firmware is outdated, proper operation is not guaranteed.
The firmware version assumed in this document is v10 or later.
Refer to <a href="Users_Manual/tutorial/../getting_started/firmware.html">Getting Started/Firmware</a> for firmware updates.</p>
<h2 id="sample-programs"><a class="header" href="#sample-programs">Sample Programs</a></h2>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<p>First, create a project and add the <code>autd3</code> library as a dependency.
Also, add the <code>autd3-link-ethercrab</code> library for communication with the device.</p>
<pre><code class="language-shell">cargo new --bin autd3-sample
cd autd3-sample
cargo add autd3
cargo add autd3-link-ethercrab
</code></pre>
<p>Next, edit the <code>src/main.rs</code> file as follows.
This is the source code for applying AM modulation of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">150</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">Hz</span></span></span></span></span></span> to a single focal point.</p>
<pre><code class="language-rust should_panic name=main.rs edition2024">use autd3::prelude::*;
use autd3_link_ethercrab::{EtherCrab, EtherCrabOption};

fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
    // Open controller with EtherCrab link
    // Here, the AUTD3 device is placed at the origin
    let mut autd = Controller::open(
        [AUTD3 {
            pos: Point3::origin(),
            rot: UnitQuaternion::identity(),
        }],
        EtherCrab::new(
            // The first argument is a callback that is called when error occurs
            |idx, status| {
                eprintln!("Device[{}]: {}", idx, status);
            },
            // The second argument is a option of EtherCrab link.
            EtherCrabOption::default(),
        ),
    )?;

    // Check firmware version
    // This code assumes that the version is v10 or later.
    autd.firmware_version()?.iter().for_each(|firm_info| {
        println!("{}", firm_info);
    });

    // Enable silencer
    // Note that this is enabled by default, so it is not actually necessary
    // To disable, send Silencer::disable()
    autd.send(Silencer::default())?;

    // A focus at 150mm directly above the center of the device
    let g = Focus {
        pos: autd.center() + Vector3::new(0., 0., 150.0 * mm),
        option: FocusOption::default(),
    };

    // 150 Hz sine wave modulation
    let m = Sine {
        freq: 150 * Hz,
        option: SineOption::default(),
    };

    // Send data
    autd.send((m, g))?;

    println!("press enter to quit...");
    let mut _s = String::new();
    std::io::stdin().read_line(&amp;mut _s)?;

    // Close controller
    autd.close()?;

    Ok(())
}</code></pre>
<p>Then, run it.</p>
<pre><code class="language-shell">cargo run --release
</code></pre>
<h2 id="notes-for-linux-and-macos-users"><a class="header" href="#notes-for-linux-and-macos-users">Notes for Linux and macOS Users</a></h2>
<p>On Linux and macOS, administrator privileges could be required.
In that case, run:</p>
<pre><code class="language-shell">cargo build --release &amp;&amp; sudo ./target/release/autd3_sample
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<h3 id="installing-dependencies-1"><a class="header" href="#installing-dependencies-1">Installing Dependencies</a></h3>
<p>This tutorial uses <a href="https://cmake.org/">CMake</a>, so make sure it is installed.</p>
<h3 id="creating-an-autd3-client-program"><a class="header" href="#creating-an-autd3-client-program">Creating an AUTD3 Client Program</a></h3>
<p>First, open a terminal and prepare an appropriate directory.</p>
<pre><code class="language-shell">mkdir autd3-sample
cd autd3-sample
</code></pre>
<p>Next, create <code>CMakeLists.txt</code> and <code>main.cpp</code> files under <code>autd3-sample</code>.</p>
<pre><code class="language-shell name=">└─autd3-sample
        CMakeLists.txt
        main.cpp
</code></pre>
<p>Next, edit <code>CMakeLists.txt</code> as follows.</p>
<pre><code class="language-ignore name=CMakeLists.txt">cmake_minimum_required(VERSION 3.21)

project(autd3-sample)

set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)

if(${CMAKE_VERSION} VERSION_GREATER_EQUAL "3.24.0") 
  cmake_policy(SET CMP0135 NEW)
endif()

include(FetchContent)
if(WIN32)
  FetchContent_Declare(
    autd3
    URL https://github.com/shinolab/autd3-cpp/releases/download/v36.0.2/autd3-v36.0.2-win-x64.zip
  )
elseif(APPLE)
  FetchContent_Declare(
    autd3
    URL https://github.com/shinolab/autd3-cpp/releases/download/v36.0.2/autd3-v36.0.2-macos-aarch64.tar.gz
  )
else()
  FetchContent_Declare(
    autd3
    URL https://github.com/shinolab/autd3-cpp/releases/download/v36.0.2/autd3-v36.0.2-linux-x64.tar.gz
  )
endif()
set(USE_SYSTEM_EIGEN OFF)
FetchContent_MakeAvailable(autd3)

add_executable(main main.cpp)

target_link_libraries(main PRIVATE autd3::autd3 autd3::link::ethercrab)
</code></pre>
<blockquote>
<p>NOTE: In the above example, the dependency library (Eigen3) is automatically downloaded.
If Eigen3 is already installed, you can disable the automatic download by turning on <code>USE_SYSTEM_EIGEN</code> and use the installed one.</p>
</blockquote>
<p>Also, edit <code>main.cpp</code> as follows. This is the source code for applying AM modulation of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">150</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">Hz</span></span></span></span></span></span> to a single focal point.</p>
<pre><code class="language-cpp name=main.cpp">#include &lt;iostream&gt;

#include "autd3.hpp"
#include "autd3/link/ethercrab.hpp"

using namespace autd3;

int main() try {
  auto autd = Controller::open(
      {AUTD3{
          .pos = Point3::origin(),
          .rot = Quaternion::Identity(),
      }},
      link::EtherCrab(
          [](const uint16_t idx, const link::Status status) {
            std::cout &lt;&lt; "Device[" &lt;&lt; idx &lt;&lt; "]: " &lt;&lt; status &lt;&lt; std::endl;
          },
          link::EtherCrabOption{}));

  const auto firm_version = autd.firmware_version();
  std::copy(firm_version.begin(), firm_version.end(),
            std::ostream_iterator&lt;FirmwareVersion&gt;(std::cout, "\n"));

  autd.send(Silencer{});

  Focus g(autd.center() + Vector3(0, 0, 150), FocusOption{});
  Sine m(150 * Hz, SineOption{});

  autd.send((m, g));

  std::cout &lt;&lt; "press enter to finish..." &lt;&lt; std::endl;
  std::cin.ignore();

  autd.close();

  return 0;
} catch (std::exception&amp; ex) {
  std::cerr &lt;&lt; ex.what() &lt;&lt; std::endl;
}
</code></pre>
<p>Next, build with CMake.</p>
<pre><code class="language-shell">mkdir build
cd build
cmake .. -DCMAKE_BUILD_TYPE=Release
cmake --build . --config Release
</code></pre>
<p>This will generate an executable file, so run it.</p>
<pre><code class="language-shell filename=Windows">.\Release\main.exe
</code></pre>
<pre><code class="language-shell filename=Linux/macOS">sudo ./main
</code></pre>
<h3 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h3>
<ul>
<li>There may be build errors if anaconda (miniconda) is activated.
<ul>
<li>In this case, delete the <code>build</code> directory, run <code>conda deactivate</code>, and then run <code>cmake</code> again.</li>
</ul>
</li>
</ul>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<p>First, open a terminal, create an appropriate project, and add the AUTD3Sharp library.</p>
<pre><code class="language-shell">dotnet new console --name autd3-sample
cd autd3-sample
dotnet add package AUTD3Sharp
</code></pre>
<p>Next, edit <code>Program.cs</code> as follows.
This is the source code for applying AM modulation of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">150</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">Hz</span></span></span></span></span></span> to a single focal point.</p>
<pre><code class="language-csharp name=Program.cs">using AUTD3Sharp;
using AUTD3Sharp.Utils;
using AUTD3Sharp.Link;
using AUTD3Sharp.Gain;
using AUTD3Sharp.Modulation;
using static AUTD3Sharp.Units;

using var autd = Controller.Open(
    [new AUTD3(pos: Point3.Origin, rot: Quaternion.Identity)],
    new EtherCrab(
        (idx, status) =&gt;
            {
                Console.Error.WriteLine($"Device[{idx}]: {status}");
            },
        new EtherCrabOption()
    )
);

var firmList = autd.FirmwareVersion();
foreach (var firm in firmList)
    Console.WriteLine(firm);

autd.Send(new Silencer());

var g = new Focus(
    pos: autd.Center() + new Vector3(0, 0, 150),
    option: new FocusOption()
);
var m = new Sine(
    freq: 150u * Hz,
    option: new SineOption()
);
autd.Send((m, g));

Console.ReadKey(true);

autd.Close();
</code></pre>
<p>Then, run it.</p>
<pre><code class="language-shell">dotnet run -c:Release
</code></pre>
<h3 id="notes-for-linux-and-macos-users-1"><a class="header" href="#notes-for-linux-and-macos-users-1">Notes for Linux and macOS Users</a></h3>
<p>On Linux and macOS, administrator privileges may be required.
In that case, run:</p>
<pre><code class="language-shell">sudo dotnet run -c:Release
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<h3 id="installing-the-pyautd3-library"><a class="header" href="#installing-the-pyautd3-library">Installing the pyautd3 Library</a></h3>
<p>First, install the <code>pyautd3</code> libraries via pip.</p>
<pre><code class="language-shell">pip install pyautd3
</code></pre>
<p>Next, create <code>main.py</code> and edit it as follows.
This is the source code for applying AM modulation of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">150</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">Hz</span></span></span></span></span></span> to a single focal point.</p>
<pre><code class="language-python name=main.py">import numpy as np
from pyautd3 import (
    AUTD3,
    Controller,
    Focus,
    FocusOption,
    Hz,
    Silencer,
    Sine,
    SineOption,
)
from pyautd3.link.ethercrab import EtherCrab, EtherCrabOption, Status


def err_handler(idx: int, status: Status) -&gt; None:
    print(f"Device[{idx}]: {status}")


if __name__ == "__main__":
    with Controller.open(
        [AUTD3(pos=[0.0, 0.0, 0.0], rot=[1, 0, 0, 0])],
        EtherCrab(err_handler=err_handler, option=EtherCrabOption()),
    ) as autd:
        firmware_version = autd.firmware_version()
        print(
            "\n".join(
                [f"[{i}]: {firm}" for i, firm in enumerate(firmware_version)],
            ),
        )

        autd.send(Silencer())

        g = Focus(
            pos=autd.center() + np.array([0.0, 0.0, 150.0]),
            option=FocusOption(),
        )
        m = Sine(
            freq=150 * Hz,
            option=SineOption(),
        )
        autd.send((m, g))

        _ = input()

        autd.close()
</code></pre>
<p>Then, run it.</p>
<pre><code class="language-shell">python main.py
</code></pre>
<h3 id="notes-for-linux-users"><a class="header" href="#notes-for-linux-users">Notes for Linux Users</a></h3>
<p>On Linux, administrator privileges could be required.
In that case, run:</p>
<pre><code class="language-shell">sudo setcap cap_net_raw,cap_net_admin=eip &lt;your python path&gt;
</code></pre>
<p>Then, run <code>main.py</code>.</p>
<pre><code class="language-shell">python main.py
</code></pre>
<h3 id="notes-for-macos-users"><a class="header" href="#notes-for-macos-users">Notes for macOS Users</a></h3>
<p>On macOS, administrator privileges may be required.
In that case, run:</p>
<pre><code class="language-shell">sudo chmod +r /dev/bpf*
</code></pre>
<p>Then, run <code>main.py</code>.</p>
<pre><code class="language-shell">python main.py
</code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/tutorial/single.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="multiple-devices"><a class="header" href="#multiple-devices">Multiple Devices</a></h1>
<p>AUTD3 can connect multiple devices in a daisy-chain to form a large array.
The SDK is designed to be used transparently even when multiple devices are connected.</p>
<p>When using multiple devices with the SDK, specify the <code>AUTD3</code> structure for each connected device in order in the first argument of the <code>Controller::open</code> function.
Refer to <a href="Users_Manual/tutorial/../getting_started/hardware.html">Getting Started/Hardware</a> for hardware connection methods.</p>
<p>Below are the steps for connecting two devices.</p>
<ul>
<li><a href="Users_Manual/tutorial/multiple.html#translation-only">Translation Only</a></li>
<li><a href="Users_Manual/tutorial/multiple.html#setting-global-coordinates">Setting Global Coordinates</a></li>
<li><a href="Users_Manual/tutorial/multiple.html#translation-and-rotation">Translation and Rotation</a></li>
</ul>
<h2 id="translation-only"><a class="header" href="#translation-only">Translation Only</a></h2>
<figure>
  <img src="Users_Manual/tutorial/../../fig/Users_Manual/hor_left_ori_left_1.png"/>
</figure>
<p>For example, if the devices are arranged and connected as shown above, with the device on the left being the first and the device on the right being the second, and the global coordinates are taken to be the same as the local coordinates of the first device, the code is as follows.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">
</span><span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let link = autd3::link::Nop::new();
</span><span class="boring">let _ =
</span>Controller::open(
    [
        AUTD3 {
            pos: Point3::origin(),
            rot: UnitQuaternion::identity(),
        },
        AUTD3 {
            pos: Point3::new(AUTD3::DEVICE_WIDTH, 0., 0.),
            rot: UnitQuaternion::identity(),
        },
    ],
    link,
)?;
<span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;chrono&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">link::Nop link;
</span>Controller::open({AUTD3{
                      .pos = Point3::origin(),
                      .rot = Quaternion::Identity(),
                  },
                  AUTD3{
                      .pos = Point3(AUTD3::DEVICE_WIDTH, 0, 0),
                      .rot = Quaternion::Identity(),
                  }},
                 std::move(link));
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Link;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">var link = new Nop();
</span>Controller.Open([
   new AUTD3(pos: Point3.Origin, rot: Quaternion.Identity),
   new AUTD3(pos: new Point3(AUTD3.DeviceWidth, 0, 0), rot: Quaternion.Identity)
], link)
<span class="boring">;
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import AUTD3, Controller
</span><span class="boring">from pyautd3.link.nop import Nop
</span><span class="boring">link = Nop()
</span>Controller.open(
    [
        AUTD3(pos=[0.0, 0.0, 0.0], rot=[1, 0, 0, 0]),
        AUTD3(pos=[AUTD3.DEVICE_WIDTH, 0.0, 0.0], rot=[1, 0, 0, 0]),
    ],
    link,
)
</code></pre>
</div></div>
<p>Here, <code>pos</code> represents the position of the device in global coordinates.
Note that <code>AUTD3::DEVICE_WIDTH</code> is the width of the device (including the outer shape of the board).</p>
<h2 id="setting-global-coordinates"><a class="header" href="#setting-global-coordinates">Setting Global Coordinates</a></h2>
<p>The origin and orientation of the global coordinates used by the SDK can be freely set by the user.</p>
<figure>
  <img src="Users_Manual/tutorial/../../fig/Users_Manual/hor_right_ori_left_1.png"/>
</figure>
<p>For example, if the global coordinates are taken to be the same as the local coordinates of the second device, the code is as follows.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">
</span><span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let link = autd3::link::Nop::new();
</span><span class="boring">let _ =
</span>Controller::open(
    [
        AUTD3 {
            pos: Point3::new(-AUTD3::DEVICE_WIDTH, 0., 0.),
            rot: UnitQuaternion::identity(),
        },
        AUTD3 {
            pos: Point3::origin(),
            rot: UnitQuaternion::identity(),
        },
    ],
    link,
)?;
<span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;chrono&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">link::Nop link;
</span>Controller::open(
    {
        AUTD3{
            .pos = Point3(-AUTD3::DEVICE_WIDTH, 0, 0),
            .rot = Quaternion::Identity(),
        },
        AUTD3{
            .pos = Point3::origin(),
            .rot = Quaternion::Identity(),
        },
    },
    std::move(link));
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Link;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">var link = new Nop();
</span>Controller.Open([
   new AUTD3(pos: new Point3(-AUTD3.DeviceWidth, 0, 0), rot: Quaternion.Identity),
   new AUTD3(pos: Point3.Origin, rot: Quaternion.Identity)
], link)
<span class="boring">;
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import AUTD3, Controller
</span><span class="boring">from pyautd3.link.nop import Nop
</span><span class="boring">link = Nop()
</span>Controller.open(
    [
        AUTD3(pos=[-AUTD3.DEVICE_WIDTH, 0.0, 0.0], rot=[1, 0, 0, 0]),
        AUTD3(pos=[0.0, 0.0, 0.0], rot=[1, 0, 0, 0]),
    ],
    link,
)
</code></pre>
</div></div>
<h2 id="translation-and-rotation"><a class="header" href="#translation-and-rotation">Translation and Rotation</a></h2>
<p>To specify the rotation of the device, use <code>rot</code>.
Rotation can be specified using Euler angles or quaternions.</p>
<figure>
  <img src="Users_Manual/tutorial/../../fig/Users_Manual/vert.png"/>
</figure>
<p>For example, if the devices are arranged as shown above, with the bottom being the first device and the left being the second device, and the global coordinates are taken to be the same as the local coordinates of the first device, the code is as follows.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-2">Rust</label><input id="C++-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-2">C++</label><input id="C#-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-2">C#</label><input id="Python-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-2">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">
</span><span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let link = autd3::link::Nop::new();
</span><span class="boring">let _ =
</span>Controller::open(
    [
        AUTD3 {
            pos: Point3::origin(),
            rot: UnitQuaternion::identity(),
        },
        AUTD3 {
            pos: Point3::new(0., 0., AUTD3::DEVICE_WIDTH),
            rot: EulerAngle::ZYZ(0. * rad, PI/2.0 * rad, 0. * rad).into(),
        },
    ],
    link,
)?;
<span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;chrono&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">link::Nop link;
</span>Controller::open({AUTD3{
                      .pos = Point3::origin(),
                      .rot = Quaternion::Identity(),
                  },
                  AUTD3{
                      .pos = Point3(0, 0, AUTD3::DEVICE_WIDTH),
                      .rot = EulerAngles::ZYZ(0. * rad, pi / 2.0 * rad,
                                              0. * rad),
                  }},
                 std::move(link));
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using System;
</span><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Link;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using static AUTD3Sharp.Units;
</span><span class="boring">var link = new Nop();
</span>Controller.Open([
   new AUTD3(pos: Point3.Origin, rot: Quaternion.Identity),
   new AUTD3(
      pos: new Point3(0, 0, AUTD3.DeviceWidth),
      rot: EulerAngles.Zyz(0 * rad, MathF.PI / 2 * rad, 0 * rad))
], link)
<span class="boring">;
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">import numpy as np
</span><span class="boring">from pyautd3 import AUTD3, Controller, EulerAngles, Nop, rad
</span><span class="boring">link = Nop()
</span>Controller.open(
    [
        AUTD3(pos=[0.0, 0.0, 0.0], rot=[1.0, 0.0, 0.0, 0.0]),
        AUTD3(
            pos=[0.0, 0.0, AUTD3.DEVICE_WIDTH],
            rot=EulerAngles.ZYZ(0 * rad, np.pi / 2 * rad, 0 * rad),
        ),
    ],
    link,
)
</code></pre>
</div></div>
<blockquote>
<p>NOTE: Only the Rust version supports all 12 types of Euler angles.
Other languages support only XYZ and ZYZ.</p>
</blockquote>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/tutorial/multiple.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="concept"><a class="header" href="#concept">Concept</a></h1>
<p>The main components that make up the SDK are as follows.</p>
<ul>
<li><code>Controller</code> - All operations on the AUTD3 device are performed through this.</li>
<li><code>Geometry</code> - Container for <code>Device</code>.
<ul>
<li><code>Device</code> - Corresponds to the AUTD3 device. Manages how the device is positioned in the real world. Container for <code>Transducer</code>.</li>
<li><code>Transducer</code> - Corresponds to the transducer. Manages where the transducer is located in the real world.</li>
</ul>
</li>
<li><code>Link</code> - Interface with the device.</li>
<li><code>Gain</code> - Manages the phase/intensity of each transducer.</li>
<li><code>STM</code> - Provides Spatio-Temporal Modulation (STM) functionality. Manages the time series of phase/intensity data for each transducer.</li>
<li><code>Modulation</code> - Provides AM modulation functionality. Manages the time series of modulation data.</li>
<li><code>Silencer</code> - Manages the silencing process.</li>
</ul>
<p>The usage of the software is as follows.</p>
<p>First, specify the arrangement of the AUTD3 devices in the real world, decide which <code>Link</code> to use, and open the <code>Controller</code>.
Then, through the <code>Controller</code>, send <code>Gain</code> (or <code>STM</code>), <code>Modulation</code>, and <code>Silencer</code> data to the device.</p>
<p>Based on the sent data, PWM signals are applied to the transducers.
The flow until the signal is generated is as follows.</p>
<figure>
  <a href="Users_Manual/../fig/Users_Manual/concept.svg" data-lightbox="image"><img src="Users_Manual/../fig/Users_Manual/concept.svg"/></a>
  <figcaption>Conceptual diagram of signal generation</figcaption>
</figure>
<p>The intensity data specified by <code>Gain</code>/<code>STM</code> is sequentially multiplied by the modulation data specified by <code>Modulation</code> and then passed to the <code>Silencer</code>.
The phase data specified by <code>Gain</code>/<code>STM</code> is passed directly to the <code>Silencer</code>.
The <code>Silencer</code> processes these data for silencing<sup class="footnote-reference"><a href="#silencer">1</a></sup>.
Finally, based on the intensity/phase data processed by the <code>Silencer</code>, PWM signals are generated and applied to the transducers.</p>
<p>Note that the intensity/phase data and modulation data are all <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord">8</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">bit</span></span></span></span></span></span>.</p>
<div class="footnote-definition" id="silencer"><sup class="footnote-definition-label">1</sup>
<p>For details, refer to <a href="Users_Manual/./API/silencer.html">Silencer</a>.</p>
</div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/concept.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="geometry"><a class="header" href="#geometry">Geometry</a></h1>
<p>Geometry manages how AUTD3 devices are arranged in the real world.</p>
<ul>
<li><a href="Users_Manual/API/geometry.html#devicetransducer-index">Device/Transducer Index</a></li>
<li><a href="Users_Manual/API/geometry.html#geometry-api">Geometry API</a>
<ul>
<li><a href="Users_Manual/API/geometry.html#getting-a-device">Getting a Device</a></li>
</ul>
</li>
<li><a href="Users_Manual/API/geometry.html#device-api">Device API</a>
<ul>
<li><a href="Users_Manual/API/geometry.html#getting-a-transducer">Getting a Transducer</a></li>
</ul>
</li>
<li><a href="Users_Manual/API/geometry.html#transducer-api">Transducer API</a></li>
</ul>
<h2 id="devicetransducer-index"><a class="header" href="#devicetransducer-index">Device/Transducer Index</a></h2>
<p>Devices are assigned an index starting from 0 in the order they are connected.</p>
<p>Each device has 249 transducers arranged, and they are assigned local indices (refer to “AUTD Surface Photo” in <a href="Users_Manual/API/../getting_started/hardware.html">Getting Started/Hardware</a>).</p>
<h2 id="geometry-api"><a class="header" href="#geometry-api">Geometry API</a></h2>
<ul>
<li><code>num_devices()</code>: Get the number of devices</li>
<li><code>num_transducers()</code>: Get the number of all transducers</li>
<li><code>center()</code>: Get the center of all transducers</li>
</ul>
<p>Note that <code>Geometry</code> can be accessed directly from <code>Controller</code>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span><span class="boring">#[allow(unused_variables)]
</span><span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let autd = Controller::open([AUTD3::default()], autd3::link::Nop::new())?;
</span>let num_dev = autd.num_devices();
let num_tr = autd.num_transducers();
let center = autd.center();
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;chrono&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">auto autd =
</span><span class="boring">Controller::open({AUTD3{}}, link::Nop{});
</span>const auto num_dev = autd.num_devices();
const auto num_tr = autd.num_transducers();
const auto center = autd.center();
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Link;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using var autd = Controller.Open([new AUTD3()], new Nop());
</span>var numDevices = autd.NumDevices();
var numTransducers = autd.NumTransducers();
var center = autd.Center();
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import AUTD3, Controller
</span><span class="boring">from pyautd3.link.nop import Nop
</span><span class="boring">autd = Controller.open([AUTD3()], Nop())
</span>num_devices = autd.num_devices()
num_transducers = autd.num_transducers()
center = autd.center()
</code></pre>
</div></div>
<h3 id="getting-a-device"><a class="header" href="#getting-a-device">Getting a Device</a></h3>
<p><code>Geometry</code> is a container of <code>Device</code>, and <code>Device</code> is a container of <code>Transducer</code>.</p>
<p>To get a <code>Device</code>, use an indexer.
Alternatively, you can use an iterator.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span><span class="boring">#[allow(unused_variables)]
</span><span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let autd = Controller::open([AUTD3::default()], autd3::link::Nop::new())?;
</span>let dev = &amp;autd[0];
for dev in &amp;autd {
    // do something
}
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;chrono&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">auto autd =
</span><span class="boring">Controller::open({AUTD3{}}, link::Nop{});
</span><span class="boring">{
</span>auto dev = autd[0];
<span class="boring">}
</span><span class="boring">{
</span>for (auto&amp; dev : autd) {
  // do something
}
<span class="boring">}
</span><span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Link;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using var autd = Controller.Open([new AUTD3()], new Nop());
</span><span class="boring">{
</span>var dev = autd[0];
<span class="boring">}
</span>foreach (var dev in autd)
{
  // do something
}
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import AUTD3, Controller
</span><span class="boring">from pyautd3.link.nop import Nop
</span><span class="boring">autd = Controller.open([AUTD3()], Nop())
</span>dev = autd[0]
for _dev in autd:
    pass
</code></pre>
</div></div>
<h2 id="device-api"><a class="header" href="#device-api">Device API</a></h2>
<ul>
<li><code>idx()</code>: Device index</li>
<li><code>rotation()</code>: Rotation of the device</li>
<li><code>x_direction()</code>: X-direction vector of the device</li>
<li><code>y_direction()</code>: Y-direction vector of the device</li>
<li><code>axial_direction()</code>: Axial direction vector of the device (direction the transducers face)</li>
</ul>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-2">Rust</label><input id="C++-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-2">C++</label><input id="C#-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-2">C#</label><input id="Python-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-2">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span><span class="boring">#[allow(unused_variables)]
</span><span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let mut autd = Controller::open([AUTD3::default()], autd3::link::Nop::new())?;
</span>let dev = &amp;mut autd[0];
let idx = dev.idx();
let rotation = dev.rotation();
let x_dir = dev.x_direction();
let y_dir = dev.y_direction();
let axial_dir = dev.axial_direction();
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;chrono&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">auto autd =
</span><span class="boring">Controller::open({AUTD3{}}, link::Nop{});
</span>auto dev = autd[0];
const auto idx = dev.idx();
const auto rotation = dev.rotation();
const auto x_dir = dev.x_direction();
const auto y_dir = dev.y_direction();
const auto axial_dir = dev.axial_direction();
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Link;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using var autd = Controller.Open([new AUTD3()], new Nop());
</span>var dev = autd[0];
var idx = dev.Idx();
var rotation = dev.Rotation();
var xDir = dev.XDirection();
var yDir = dev.YDirection();
var axialDir = dev.AxialDirection();
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import AUTD3, Controller
</span><span class="boring">from pyautd3.link.nop import Nop
</span><span class="boring">autd = Controller.open([AUTD3()], Nop())
</span>dev = autd[0]
idx = dev.idx()
rotation = dev.rotation()
x_dir = dev.x_direction()
y_dir = dev.y_direction()
axial_dir = dev.axial_direction()
</code></pre>
</div></div>
<h3 id="getting-a-transducer"><a class="header" href="#getting-a-transducer">Getting a Transducer</a></h3>
<p><code>Device</code> is a container of <code>Transducer</code>, and <code>Transducer</code> stores information about each transducer.</p>
<p>To get a <code>Transducer</code>, use an indexer.
Alternatively, you can use an iterator.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-3" type="radio" class="mdbook-inpage-tab" name="tab-3" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-3">Rust</label><input id="C++-tab-3" type="radio" class="mdbook-inpage-tab" name="tab-3">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-3">C++</label><input id="C#-tab-3" type="radio" class="mdbook-inpage-tab" name="tab-3">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-3">C#</label><input id="Python-tab-3" type="radio" class="mdbook-inpage-tab" name="tab-3">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-3">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span><span class="boring">#[allow(unused_variables)] 
</span><span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let autd = Controller::open([AUTD3::default()], autd3::link::Nop::new())?;
</span>let tr = &amp;autd[0][0];
for tr in autd[0].iter() {
    // do something
}
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;chrono&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">auto autd =
</span><span class="boring">Controller::open({AUTD3{}}, link::Nop{});
</span><span class="boring">{
</span>auto tr = autd[0][0];
<span class="boring">}
</span><span class="boring">{
</span>for (auto&amp; tr : autd[0]) {
  // do something
}
<span class="boring">}
</span><span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Link;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using var autd = Controller.Open([new AUTD3()], new Nop());
</span><span class="boring">{
</span>var tr = autd[0][0];
<span class="boring">}
</span>foreach (var tr in autd[0])
{
  // do something
}
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import AUTD3, Controller
</span><span class="boring">from pyautd3.link.nop import Nop
</span><span class="boring">autd = Controller.open([AUTD3()], Nop())
</span>tr = autd[0][0]
for _tr in autd[0]:
    pass
</code></pre>
</div></div>
<h2 id="transducer-api"><a class="header" href="#transducer-api">Transducer API</a></h2>
<p>The following information can be obtained.</p>
<ul>
<li><code>idx()</code>: (Local) index of the transducer</li>
<li><code>dev_idx()</code>: Index of the device to which the transducer belongs</li>
<li><code>position()</code>: Position of the transducer</li>
</ul>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-4" type="radio" class="mdbook-inpage-tab" name="tab-4" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-4">Rust</label><input id="C++-tab-4" type="radio" class="mdbook-inpage-tab" name="tab-4">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-4">C++</label><input id="C#-tab-4" type="radio" class="mdbook-inpage-tab" name="tab-4">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-4">C#</label><input id="Python-tab-4" type="radio" class="mdbook-inpage-tab" name="tab-4">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-4">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span><span class="boring">#[allow(unused_variables)]
</span><span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let autd = Controller::open([AUTD3::default()], autd3::link::Nop::new())?;
</span>let tr = &amp;autd[0][0];
let idx = tr.idx();
let dev_idx = tr.dev_idx();
let position = tr.position();
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">auto autd =
</span><span class="boring">Controller::open({AUTD3{}}, link::Nop{});
</span>const auto tr = autd[0][0];
const auto idx = tr.idx();
const auto dev_idx = tr.dev_idx();
const auto position = tr.position();
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Link;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using var autd = Controller.Open([new AUTD3()], new Nop());
</span>var tr = autd[0][0];
var trIdx = tr.Idx();
var devIdx = tr.DevIdx();
var position = tr.Position();
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import AUTD3, Controller
</span><span class="boring">from pyautd3.link.nop import Nop
</span><span class="boring">autd = Controller.open([AUTD3()], Nop())
</span>tr = autd[0][0]
idx = tr.idx()
dev_idx = tr.dev_idx()
position = tr.position()
</code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/geometry.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="link"><a class="header" href="#link">Link</a></h1>
<p>Link is the interface to the AUTD3 device.
You need to choose one from the following.</p>
<ul>
<li><a href="Users_Manual/API/./link/twincat.html">TwinCAT</a></li>
<li><a href="Users_Manual/API/./link/soem.html">SOEM</a></li>
<li><a href="Users_Manual/API/./link/simulator.html">Simulator</a></li>
<li><a href="Users_Manual/API/./link/remote_twincat.html">RemoteTwinCAT</a></li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/link.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="twincat"><a class="header" href="#twincat">TwinCAT</a></h1>
<p>TwinCAT is the only official way to use EtherCAT on a Windows PC.
TwinCAT is specialized software that only supports Windows and forces Windows to operate in real-time.</p>
<p>TwinCAT requires specific network controllers, so please check the <a href="https://infosys.beckhoff.com/english.php?content=../content/1033/tc3_overview/9309844363.html&amp;id=">list of compatible network controllers</a>.</p>
<blockquote>
<p>Note: Alternatively, after installing TwinCAT, you can see the Vendor ID and Device ID of supported network controllers in <code>C:/TwinCAT/3.1/Driver/System/TcI8254x.inf</code>. The Vendor ID and Device ID of your network controller can be checked in “Device Manager” → “Ethernet Adapter” → “Properties” → “Details” → “Hardware ID”.</p>
</blockquote>
<p>It may work with network controllers other than those listed above, but in that case, normal operation and real-time performance are not guaranteed.</p>
<ul>
<li><a href="Users_Manual/API/link/twincat.html#prerequisites">Prerequisites</a>
<ul>
<li><a href="Users_Manual/API/link/twincat.html#installing-twincat">Installing TwinCAT</a></li>
<li><a href="Users_Manual/API/link/twincat.html#installing-autd3-server">Installing AUTD3 Server</a></li>
<li><a href="Users_Manual/API/link/twincat.html#initial-setup">Initial Setup</a></li>
<li><a href="Users_Manual/API/link/twincat.html#running-autd-server">Running AUTD Server</a></li>
<li><a href="Users_Manual/API/link/twincat.html#license">License</a></li>
</ul>
</li>
<li><a href="Users_Manual/API/link/twincat.html#twincat-link">TwinCAT Link</a>
<ul>
<li><a href="Users_Manual/API/link/twincat.html#install">Install</a></li>
<li><a href="Users_Manual/API/link/twincat.html#apis">APIs</a></li>
<li><a href="Users_Manual/API/link/twincat.html#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
</ul>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<p>As a prerequisite, TwinCAT cannot coexist with Hyper-V or Virtual Machine Platform.
Therefore, these features need to be disabled.
For example, you can disable them by opening PowerShell with administrator privileges and typing:</p>
<pre><code class="language-PowerShell">Disable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V-Hypervisor
Disable-WindowsOptionalFeature -Online -FeatureName VirtualMachinePlatform
</code></pre>
<p>Also, for Windows 11, you need to turn off the virtualization-based security feature.
Go to “Windows Security” → “Device Security” → “Core Isolation” → “Memory Integrity” and turn it off.
From Windows 11 24H2, you may also need to set the registry value <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceGuard\EnableVirtualizationBasedSecurity</code> to 0.</p>
<h3 id="installing-twincat"><a class="header" href="#installing-twincat">Installing TwinCAT</a></h3>
<p>Refer to the <a href="https://infosys.beckhoff.com/content/1033/tc3_installation/15698617995.html?id=7523796010185393366">official site</a> and install TwinCAT 3.1 Build 4026.
(You will need to register for a myBeckhoff account (free) to install it.)
Make sure to install the 64-bit version of TwinCAT Xae Shell.
Visual Studio Integration is not required.</p>
<p>After installing the Package Manager, you can install “TwinCAT Standard” using the Package Manager.</p>
<h3 id="installing-autd3-server"><a class="header" href="#installing-autd3-server">Installing AUTD3 Server</a></h3>
<p>To use TwinCAT Link, you first need to install <code>AUTD3 Server</code>.
The installer is distributed on <a href="https://github.com/shinolab/autd3-server">GitHub</a>, so download it and follow the instructions to install it.</p>
<blockquote>
<p>NOTE: There is also a <a href="https://github.com/shinolab/TwinCATAUTDServer/releases">CLI version</a>.</p>
</blockquote>
<p>When you run <code>AUTD3 Server</code>, the following screen will appear, so open the <code>TwinCAT</code> tab.</p>
<figure>
  <img src="Users_Manual/API/link/../../../fig/Users_Manual/autdserver_twincat.jpg"/>
</figure>
<h3 id="initial-setup"><a class="header" href="#initial-setup">Initial Setup</a></h3>
<p>The following tasks are required only for the first time.</p>
<p>First, press the “Copy AUTD.xml” button.
If a message like “AUTD.xml is successfully copied” appears, it is successful.</p>
<p>Next, press the “Open XAE Shell” button to open the XAE Shell.
From the top menu of TwinCAT XAE Shell, open “TwinCAT” → “Show Realtime Ethernet Compatible Devices”, select the compatible device from “Compatible devices”, and click Install.
If the installed adapter is displayed in “Installed and ready to use devices (realtime capable)”, it is successful.</p>
<p>If nothing is displayed in “Compatible devices”, the Ethernet device of that PC is not compatible with TwinCAT.
Drivers in “Incompatible devices” can also be installed, and if installed, they will be displayed as “Installed and ready to use devices (for demo use only)”.
In this case, it can be used but is not guaranteed to work.</p>
<h3 id="running-autd-server"><a class="header" href="#running-autd-server">Running AUTD Server</a></h3>
<p>Connect AUTD3 to the PC and with AUTD3 powered on, press the “Run” button.
At this time, leave the “Client IP address” field blank.</p>
<p>If a message appears indicating that the AUTD3 device has been found, as shown in the screen below, it is successful.</p>
<figure>
  <img src="Users_Manual/API/link/../../../fig/Users_Manual/autdserver_twincat_run.jpg"/>
</figure>
<p>Note that TwinCAT will disconnect when the PC is powered off, enters sleep mode, etc., so you need to run it again each time.</p>
<h3 id="license"><a class="header" href="#license">License</a></h3>
<p>The first time, a license-related error will appear, so open “Solution Explorer” → “SYSTEM” → “License” in XAE Shell, click “7 Days Trial License …”, and enter the characters displayed on the screen.
Note that the license is a 7-day trial license, but you can reissue it by performing the same operation again after it expires.
After issuing the license, close “TwinCAT XAE Shell” and run it again.</p>
<h2 id="twincat-link"><a class="header" href="#twincat-link">TwinCAT Link</a></h2>
<h3 id="install"><a class="header" href="#install">Install</a></h3>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C#-tab-0">C#</label><input id="Unity-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Unity-tab-0">Unity</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-shell">cargo add autd3-link-twincat
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp name=CMakeLists.txt">target_link_libraries(&lt;TARGET&gt; PRIVATE autd3::link::twincat)
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Unity-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<p>Included in the main library.</p>
</div></div>
<h3 id="apis"><a class="header" href="#apis">APIs</a></h3>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust">use autd3_link_twincat::TwinCAT;

<span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let _ = 
</span>TwinCAT::new()?;
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp">#include "autd3/link/twincat.hpp"

<span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>link::TwinCAT();
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs">using AUTD3Sharp.Link;

new TwinCAT();
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python">from pyautd3.link.twincat import TwinCAT

TwinCAT()
</code></pre>
</div></div>
<h3 id="troubleshooting-1"><a class="header" href="#troubleshooting-1">Troubleshooting</a></h3>
<p>When trying to use a large number of devices, an error like the one shown below may occur.</p>
<figure>
  <img src="Users_Manual/API/link/../../../fig/Users_Manual/tcerror.jpg"/>
  <figcaption>TwinCAT error when using 9 AUTD3 devices</figcaption>
</figure>
<p>In this case, increase the values of <code>Sync0 cycle time</code> and <code>Send task cycle time</code> in <code>AUTD3 Server</code>, and run AUTD Server again.
The default values for these options are <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">ms</span></span></span></span></span></span> each.</p>
<p>The appropriate values depend on the number of devices connected.
The smallest possible value that does not cause an error is desirable.
For example, for 9 devices, a value of about <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.5</span></span></span></span>–<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">ms</span></span></span></span></span></span> should work.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/link/twincat.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="ethercrab"><a class="header" href="#ethercrab">EtherCrab</a></h1>
<blockquote>
<p>NOTE: If TwinCAT is available, we generally recommend using TwinCAT.</p>
</blockquote>
<p>This link uses <a href="https://github.com/ethercrab-rs/ethercrab">EtherCrab</a>, an open-source EtherCAT master library.</p>
<p>On Windows, install <a href="https://nmap.org/npcap/">npcap</a> in “WinPcap API compatible mode”.
On Linux/macOS, no additional setup is required.</p>
<h2 id="install-1"><a class="header" href="#install-1">Install</a></h2>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C#-tab-0">C#</label><input id="Unity-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Unity-tab-0">Unity</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-shell">cargo add autd3-link-ethercrab
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp name=CMakeLists.txt">target_link_libraries(&lt;TARGET&gt; PRIVATE autd3::link::ethercrab)
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Unity-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<p>Included in the main library.</p>
</div></div>
<h2 id="apis-1"><a class="header" href="#apis-1">APIs</a></h2>
<p>Pass the error callback function as the first argument, and options as the second argument.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust">use autd3_link_ethercrab::{EtherCrab, EtherCrabOption};
<span class="boring">use std::time::Duration;
</span>
<span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>EtherCrab::new(
    |idx, status| {
        eprintln!("Device[{}]: {}", idx, status);
    },
    EtherCrabOption {
        ifname: None,
        state_check_period: Duration::from_millis(100),
        sync0_period: Duration::from_millis(2),
        sync_tolerance: Duration::from_micros(1),
        sync_timeout: Duration::from_secs(10),
        ..Default::default()
    },
);
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include &lt;iostream&gt;
</span>#include &lt;autd3/link/ethercrab.hpp&gt;

<span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>link::EtherCrab(
    [](const uint16_t idx, const link::Status status) {
      std::cout &lt;&lt; "Device[" &lt;&lt; idx &lt;&lt; "]: " &lt;&lt; status &lt;&lt; std::endl;
    },
    link::EtherCrabOption{
        .ifname = std::nullopt,
        .state_check_period = std::chrono::milliseconds(100),
        .sync0_period = std::chrono::milliseconds(2),
        .sync_tolerance = std::chrono::microseconds(1),
        .sync_timeout = std::chrono::seconds(10),
    });
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span>using AUTD3Sharp.Link;
<span class="boring">using AUTD3Sharp.Utils;
</span>
new EtherCrab(
    errHandler: (idx, status) =&gt;
    {
        Console.Error.WriteLine($"Device[{idx}]: {status}");
    },
    option: new EtherCrabOption
    {
        Ifname = null,
        StateCheckPeriod = Duration.FromMillis(100),
        Sync0Period = Duration.FromMillis(2),
        SyncTolerance = Duration.FromMicros(1),
        SyncTimeout = Duration.FromSecs(10),
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python">from pyautd3 import Duration
from pyautd3.link.ethercrab import (
    EtherCrab,
    EtherCrabOption,
    Status,
)


def err_handler(idx: int, status: Status) -&gt; None:
    print(f"Device[{idx}]: {status}")


EtherCrab(
    err_handler=err_handler,
    option=EtherCrabOption(
        ifname=None,
        state_check_period=Duration.from_millis(100),
        sync0_period=Duration.from_millis(2),
        sync_tolerance=Duration.from_micros(1),
        sync_timeout=Duration.from_secs(10),
    ),
)
</code></pre>
</div></div>
<p>The options available for the <code>EtherCrab</code> link are as follows. Default values are as shown above.</p>
<ul>
<li><code>ifname</code>: Network interface name. If <code>None</code>, the network interface to which the AUTD3 devices are connected is selected automatically.</li>
<li><code>state_check_period</code>: Interval at which to check for errors.</li>
<li><code>sync0_period</code>: Period of the SYNC0 signal.
<ul>
<li>When connecting a large number of devices, behavior may become unstable. In that case, increase <code>sync0_period</code>. These values should be as small as possible without causing errors. The appropriate values depend on the number of connected units.</li>
</ul>
</li>
<li><code>sync_tolerance</code>: Synchronization tolerance. During initialization, the system waits until the difference in system time among devices falls below this value. If synchronization is not achieved within the timeout below, an error occurs. Changing this value is NOT recommended.</li>
<li><code>sync_timeout</code>: Synchronization timeout. Timeout for the system time difference measurement described above.</li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/link/ethercrab.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="simulator"><a class="header" href="#simulator">Simulator</a></h1>
<p>The Simulator link is used when using the <a href="Users_Manual/API/link/../../Simulator/simulator.html">AUTD Simulator</a>.</p>
<p>Before using this link, you need to start the AUTD Simulator.</p>
<h2 id="install-2"><a class="header" href="#install-2">Install</a></h2>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C#-tab-0">C#</label><input id="Unity-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Unity-tab-0">Unity</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-shell">cargo add autd3-link-simulator --features blocking
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp name=CMakeLists.txt">target_link_libraries(&lt;TARGET&gt; PRIVATE autd3::link::simulator)
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Unity-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<p>Included in the main library.</p>
</div></div>
<h2 id="apis-2"><a class="header" href="#apis-2">APIs</a></h2>
<p>In the constructor of <code>Simulator</code>, specify the IP address and port number of the AUTD Simulator.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust">use autd3_link_simulator::Simulator;

<span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let _ = 
</span>Simulator::new("127.0.0.1:8080".parse()?);
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp">#include "autd3/link/simulator.hpp"

<span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>link::Simulator("127.0.0.1:8080");
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using System.Net;
</span>using AUTD3Sharp.Link;

new Simulator(new IPEndPoint(IPAddress.Parse("127.0.0.1"), 8080));
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python">from pyautd3.link.simulator import Simulator

Simulator("127.0.0.1:8080")
</code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/link/simulator.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="remotetwincat"><a class="header" href="#remotetwincat">RemoteTwinCAT</a></h1>
<p>As mentioned earlier, using AUTD3 with TwinCAT requires a Windows OS and a specific network adapter.
If you want to develop on a non-Windows PC, you can use the <code>RemoteTwinCAT</code> link to remotely operate TwinCAT from Linux/macOS.</p>
<h2 id="install-3"><a class="header" href="#install-3">Install</a></h2>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C#-tab-0">C#</label><input id="Unity-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Unity-tab-0">Unity</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-shell">cargo add autd3-link-twincat --features remote
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp name=CMakeLists.txt">target_link_libraries(&lt;TARGET&gt; PRIVATE autd3::link::twincat)
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Unity-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<p>Included in the main library.</p>
</div></div>
<h2 id="setup-1"><a class="header" href="#setup-1">Setup</a></h2>
<p>To use <code>RemoteTwinCAT</code>, you need two PCs.
One of these PCs must be able to use <a href="Users_Manual/API/link/./twincat.html"><code>TwinCAT</code></a>.
Hereby, this PC is referred to as the “server”.
The other PC, which is the development PC using the SDK, has no particular restrictions as long as it is connected to the same LAN as the server. H
ereby, this PC is referred to as the “client”.</p>
<p>First, connect the server to the AUTD device.
The LAN adapter used for this connection must be a TwinCAT-compatible adapter.
Then, connect the server and client via a different LAN.
This LAN adapter does not need to be TwinCAT-compatible<sup class="footnote-reference"><a href="#fn_remote_twin">1</a></sup>.
Next, check the IP addresses of the LAN between the server and client.
For example, let’s assume the server’s IP is <code>172.16.99.104</code> and the client’s IP is <code>172.16.99.62</code>.
Next, start the <code>AUTD Server</code> on the server.
Specify the client’s IP address (in this example, <code>172.16.99.62</code>) in the <code>Client IP address</code> field.</p>
<figure>
  <img src="Users_Manual/API/link/../../../fig/Users_Manual/autdserver_remotetwincat.jpg"/>
</figure>
<p>The “Server AmsNetId” and “Client AmsNetId” will be displayed on the right side of the screen, so make a note of them.</p>
<blockquote>
<p>NOTE: The first four digits of the “Server AmsNetId” do not necessarily represent the server’s IP address.</p>
</blockquote>
<h2 id="apis-3"><a class="header" href="#apis-3">APIs</a></h2>
<p>In the constructor of <code>RemoteTwinCAT</code>, specify the “Server AmsNetId”.</p>
<p>You can also specify the server’s IP address and the client’s NetId with <code>server_ip</code> and <code>client_ams_net_id</code>.
These can be omitted, but it is generally recommended to specify them.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust">use autd3_link_twincat::remote::{RemoteTwinCAT, RemoteTwinCATOption};

<span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>RemoteTwinCAT::new("172.16.99.111.1.1", RemoteTwinCATOption {
    server_ip: "172.16.99.104".to_string(),
    client_ams_net_id: "172.16.99.62.1.1".to_string(),
});
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp">#include "autd3/link/twincat.hpp"

<span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>link::RemoteTwinCAT("172.16.99.111.1.1",
                    link::RemoteTwinCATOption{
                        .server_ip = "172.16.99.104",
                        .client_ams_net_id = "172.16.99.62.1.1"});
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span>using AUTD3Sharp.Link;

new RemoteTwinCAT(
        serverAmsNetId: "172.16.99.111.1.1",
        option: new RemoteTwinCATOption
        {
                ServerIp = "172.16.99.104",
                ClientAmsNetId = "172.16.99.62.1.1"
        }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python">from pyautd3.link.twincat import RemoteTwinCAT, RemoteTwinCATOption

RemoteTwinCAT(
    server_ams_net_id="172.16.99.111.1.1",
    option=RemoteTwinCATOption(
        server_ip="172.16.99.104",
        client_ams_net_id="172.16.99.62.1.1",
    ),
)
</code></pre>
</div></div>
<h3 id="firewall"><a class="header" href="#firewall">Firewall</a></h3>
<p>If you encounter TCP-related errors, it is possible that the ADS protocol is being blocked by the firewall.
In that case, configure the firewall to allow connections on TCP/UDP port 48898.</p>
<div class="footnote-definition" id="fn_remote_twin"><sup class="footnote-definition-label">1</sup>
<p>Wireless LAN is also acceptable.</p>
</div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/link/remote_twincat.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="soem"><a class="header" href="#soem">SOEM</a></h1>
<blockquote>
<p>NOTE: This link is only available in Rust.</p>
</blockquote>
<blockquote>
<p>NOTE: This link is distributed under the GPLv3 license.</p>
</blockquote>
<p><a href="https://github.com/OpenEtherCATsociety/SOEM">SOEM</a> is an open-source EtherCAT Master library developed by volunteers.
Unlike TwinCAT, real-time performance is not guaranteed.
Therefore, it is generally recommended to use TwinCAT.
Using SOEM should be limited to unavoidable reasons or for development purposes only.
On the other hand, SOEM has the advantage of being cross-platform and simple to install.</p>
<p>For Windows, install <a href="https://nmap.org/npcap/">npcap</a> in “<strong>WinPcap API compatible mode</strong>”.
For Linux/macOS, no special preparation is required.</p>
<h2 id="install-4"><a class="header" href="#install-4">Install</a></h2>
<pre><code class="language-shell">cargo add autd3-link-soem
</code></pre>
<h2 id="apis-4"><a class="header" href="#apis-4">APIs</a></h2>
<p>The first argument is a callback function for errors, and the second argument specifies options.</p>
<pre><code class="language-rust">use autd3_link_soem::{Status, ThreadPriority, SOEM, SOEMOption};
<span class="boring">use std::num::NonZeroUsize;
</span><span class="boring">use std::time::Duration;
</span>
<span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>SOEM::new(
    |slave, status| {
        eprintln!("slave [{}]: {}", slave, status);
        if status == Status::Lost {
            std::process::exit(-1);
        }
    },
    SOEMOption {
        buf_size: NonZeroUsize::new(16).unwrap(),
        ifname: None,
        state_check_interval: Duration::from_millis(100),
        sync0_cycle: Duration::from_millis(1),
        send_cycle: Duration::from_millis(1),
        thread_priority: ThreadPriority::Max,
        sync_tolerance: Duration::from_micros(1),
        sync_timeout: Duration::from_secs(10),
        affinity: None
    },
);
<span class="boring">}</span></code></pre>
<p>The options that can be specified for the SOEM link are as follows.
The default values are as above.</p>
<ul>
<li><code>buf_size</code>: Transmission queue buffer size. Usually, there is no need to change this.</li>
<li><code>ifname</code>: Network interface name. If empty, the network interface to which the AUTD3 device is connected is automatically selected.</li>
<li><code>state_check_interval</code>: Interval to check for errors</li>
<li><code>sync0_cycle</code>: Synchronization signal cycle</li>
<li><code>send_cycle</code>: Transmission cycle
<ul>
<li><code>SOEM</code> may become unstable when connecting a large number of devices. In this case, increase the values of <code>sync0_cycle</code> and <code>send_cycle</code>. These values should be as small as possible without causing errors. The appropriate values depend on the number of connected devices. For example, for 9 devices, a value of about <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1.5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">ms</span></span></span></span></span></span> should work.</li>
</ul>
</li>
<li><code>thread_priority</code>: Thread priority</li>
<li><code>process_priority</code>: Process priority (Windows only)</li>
<li><code>sync_tolerance</code>: Synchronization tolerance level. During initialization, this link waits until the system time difference of each device is below this value. If synchronization is not completed within the timeout period below, an error occurs. It is not recommended to change this value.</li>
<li><code>sync_timeout</code>: Synchronization timeout. Timeout period for the system time difference measurement above.
‐ <code>affinity</code>: CPU affinity. If <code>None</code>, it is left to the OS.</li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/link/soem.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="controller"><a class="header" href="#controller">Controller</a></h1>
<p>This section introduces the APIs available in the <code>Controller</code>.</p>
<ul>
<li><a href="Users_Manual/API/controller.html#fpga_state">fpga_state</a></li>
<li><a href="Users_Manual/API/controller.html#send">send</a></li>
<li><a href="Users_Manual/API/controller.html#sender">sender</a>
<ul>
<li><a href="Users_Manual/API/controller.html#about-ack-check">About ack check</a></li>
<li><a href="Users_Manual/API/controller.html#about-parallel-computation">About Parallel Computation</a></li>
</ul>
</li>
<li><a href="Users_Manual/API/controller.html#inspect-available-only-in-rust"><code>inspect</code> (available only in Rust)</a></li>
</ul>
<h2 id="fpga_state"><a class="header" href="#fpga_state">fpga_state</a></h2>
<p>Retrieve the state of the FPGA.
Before using this, you need to enable state retrieval with <code>ReadsFPGAState</code>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">#[allow(unused_variables)]
</span><span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let mut autd = Controller::open([AUTD3::default()], autd3::link::Nop::new())?;
</span>autd.send(ReadsFPGAState::new(|_dev| true))?;

let info = autd.fpga_state()?;
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">auto autd =
</span><span class="boring">Controller::open({AUTD3{}}, link::Nop{});
</span>autd.send(ReadsFPGAState([](const auto&amp;) { return true; }));

const auto info = autd.fpga_state();
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Link;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using var autd = Controller.Open([new AUTD3()], new Nop());
</span>autd.Send(new ReadsFPGAState(_ =&gt; true));

var info = autd.FPGAState();
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Controller, AUTD3, ReadsFPGAState
</span><span class="boring">from pyautd3.link.nop import Nop
</span><span class="boring">autd = Controller.open([AUTD3()], Nop())
</span>autd.send(ReadsFPGAState(lambda _: True))

info = autd.fpga_state()
</code></pre>
</div></div>
<p>The argument of the <code>ReadsFPGAState</code> constructor is <code>Fn(&amp;Device) -&gt; bool</code>, which specifies whether to enable state retrieval for each device.</p>
<p><code>fpga_state</code> returns <code>None</code> for devices that are not enabled.</p>
<p>The following information can currently be obtained as the state of the FPGA:</p>
<ul>
<li><code>is_thermal_assert</code>: Whether the temperature sensor for fan control is asserted</li>
<li><code>current_mod_segment</code>: Current Modulation Segment</li>
<li><code>current_stm_segment</code>: Current FociSTM/GainSTM Segment</li>
<li><code>current_gain_segment</code>: Current Gain Segment</li>
<li><code>is_gain_mode</code>: Whether Gain is currently being used</li>
<li><code>is_stm_mode</code>: Whether FociSTM/GainSTM is currently being used</li>
</ul>
<h2 id="send"><a class="header" href="#send">send</a></h2>
<p>Send data to the device.</p>
<p>Data can be sent either individually or two at a time.</p>
<h2 id="sender"><a class="header" href="#sender">sender</a></h2>
<p>You can specify settings for sending via <code>sender</code>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">use std::time::Duration;
</span><span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let mut autd = Controller::open([AUTD3::default()], autd3::link::Nop::new())?;
</span>let mut sender = autd.sender(
    SenderOption {
        send_interval: Duration::from_millis(1),
        receive_interval: Duration::from_millis(1),
        timeout: None,
        parallel: ParallelMode::Auto,
        strict: true
    },
    FixedSchedule::default(),
);
<span class="boring">let d = Null {};
</span>sender.send(d)?;
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;chrono&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">auto autd = Controller::open({AUTD3{}}, link::Nop{});
</span>auto sender =
    autd.sender(SenderOption{.send_interval = std::chrono::milliseconds(1),
                             .receive_interval = std::chrono::milliseconds(1),
                             .timeout = std::nullopt,
                             .parallel = ParallelMode::Auto,
                             .strict = true},
                FixedSchedule{});
<span class="boring">const Null d;
</span>sender.send(d);
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Link;
</span><span class="boring">using AUTD3Sharp.Gain;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using var autd = Controller.Open([new AUTD3()], new Nop());
</span>var sender = autd.Sender(
    new SenderOption
    {
        SendInterval = Duration.FromMillis(1),
        ReceiveInterval = Duration.FromMillis(1),
        Timeout = null,
        Parallel = ParallelMode.Auto,
        Strict = true,
    },
    new FixedSchedule()
);
<span class="boring">var d = new Null();
</span>sender.Send(d);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import AUTD3, Controller, Duration, Null, SenderOption, FixedSchedule, ParallelMode
</span><span class="boring">from pyautd3.link.nop import Nop
</span><span class="boring">autd = Controller.open([AUTD3()], Nop())
</span>sender = autd.sender(
    SenderOption(
        send_interval=Duration.from_millis(1),
        receive_interval=Duration.from_millis(1),
        timeout=None,
        parallel=ParallelMode.Auto,
        strict=True
    ),
    FixedSchedule(),
)
<span class="boring">d = Null()
</span>sender.send(d)
</code></pre>
</div></div>
<p>Here,</p>
<ul>
<li><code>send_interval</code>: Send interval</li>
<li><code>receive_interval</code>: Receive interval</li>
<li><code>timeout</code>: Timeout duration. See <a href="Users_Manual/API/controller.html#about-ack-check">About Ack check</a> for details.</li>
<li><code>parallel</code>: Parallel computation mode. See <a href="Users_Manual/API/controller.html#about-parallel-computation">About Parallel Computation</a> for details.</li>
<li><code>strict</code>: Whether to strictly check the data to be sent. See <a href="Users_Manual/API/controller.html#about-ack-check">About Ack check</a> for details.</li>
</ul>
<p>and the default values are as above.</p>
<p>The second argument is a structure to adjust send/receive intervals, and you can choose from the following:</p>
<ul>
<li><code>FixedSchedule</code>: Starts the next send at the specified interval from the start time of the previous send, regardless of the time taken for the send process.</li>
<li><code>FixedDelay</code>: Starts the next send after the specified interval from the completion of the send process.</li>
</ul>
<p>これらの構造体は, どのようにスレッドをスリープさせるかを指定する以下の構造体を持つ.
These structures have the following structures that specify how to put the thread to sleep:</p>
<ul>
<li><code>SpinSleeper</code>: Uses <a href="https://crates.io/crates/spin_sleep"><code>spin_sleep</code></a></li>
<li><code>StdSleeper</code>: Uses <a href="https://doc.rust-lang.org/std/thread/fn.sleep.html"><code>std::thread::sleep</code></a></li>
<li><code>SpinWait</code>: Uses busy-waiting</li>
</ul>
<p>Note that <code>Controller::send</code> and <code>Controller::group_send</code> are equivalent to <code>Sender::send</code> and <code>Sender::group_send</code> with the <code>Controller::default_sender_option</code> (which is configurable) and default <code>SpinSleeper</code>.</p>
<h3 id="about-ack-check"><a class="header" href="#about-ack-check">About ack check</a></h3>
<p>If the timeout value is</p>
<ul>
<li>greater than 0, the <code>send</code> function waits until the sent data is processed by the device or the specified timeout duration elapses. If it cannot confirm that the sent data was processed by the device, it returns an error.</li>
<li>0, the <code>send</code> function does not check whether the sent data was processed by the device.</li>
</ul>
<p>If you want to ensure that the data is sent, it is recommended to set this to an appropriate value.</p>
<p>If timeout is not specified in <code>SenderOption</code>, the default value (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">200</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">ms</span></span></span></span></span></span>) is used.</p>
<p>When sending multiple data at once, the maximum timeout value of each data is used.</p>
<h3 id="about-parallel-computation"><a class="header" href="#about-parallel-computation">About Parallel Computation</a></h3>
<p>Internal calculations for each data can be executed in parallel on a per-device basis.</p>
<p>Specifying <code>ParallelMode::On</code> enables parallel computation, and <code>ParallelMode::Off</code> disables it.</p>
<p>In the case of <code>ParallelMode::Auto</code>, parallel computation is enabled if the number of devices exceeds the parallel computation threshold value for each data as shown below.</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>Parallel Computation Threshold Value</th></tr></thead><tbody>
<tr><td><code>Clear</code>/<code>GPIOOutputs</code>/<br><code>ForceFan</code>/<code>PhaseCorrection</code>/<br><code>ReadsFPGAState</code>/<code>SwapSegment</code>/<br><code>Silencer</code>/<code>Synchronize</code>/<br><code>FociSTM</code> (less than 4000 foci)/<br><code>Modulation</code></td><td>18446744073709551615</td></tr>
<tr><td><code>PulseWidthEncoder</code>/<br><code>FociSTM</code> (4000 foci or more)/<br>/<code>GainSTM</code>/<code>Gain</code></td><td>4</td></tr>
</tbody></table>
</div>
<h2 id="inspect-available-only-in-rust"><a class="header" href="#inspect-available-only-in-rust"><code>inspect</code> (available only in Rust)</a></h2>
<p>The calculations for <code>Gain</code>, <code>Modulation</code>, <code>GainSTM</code>, and <code>FociSTM</code> are lazy for parallelization and to minimize memory allocation, and the calculation results are constructed directly within the frame.
Therefore, it is not possible to directly check these calculation results before sending.</p>
<p>By using <code>Controller::inspect</code>, you can check these calculation results without sending.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=1 for="Rust-tab-2">Rust</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">#[allow(unused_variables)]
</span><span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let autd = Controller::open([AUTD3::default()], autd3::link::Nop::new())?;
</span>let r = autd.inspect(Null {})?;
dbg!(&amp;r[0]); // result of device 0
// &amp;r[0] = Some(
//     GainInspectionResult {
//         name: "Null",
//         data: [
//             Drive {
//                 phase: 0x00,
//                 intensity: 0x00,
//             },
//             ︙
//             Drive {
//                 phase: 0x00,
//                 intensity: 0x00,
//             },
//         ],
//         segment: S0,
//         transition_mode: None,
//     },
// )

<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/controller.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="gain"><a class="header" href="#gain">Gain</a></h1>
<p>AUTD can individually control the phase/amplitude of each transducer, allowing it to generate various sound fields.
<code>Gain</code> is the structs that manages this, and the SDK provides several types of <code>Gain</code> to generate different sound fields by default.</p>
<ul>
<li><a href="Users_Manual/API/./gain/null.html">Null</a> ‐ No output</li>
<li><a href="Users_Manual/API/./gain/focus.html">Focus</a> - Single focus</li>
<li><a href="Users_Manual/API/./gain/bessel.html">Bessel</a> - Bessel beam</li>
<li><a href="Users_Manual/API/./gain/plane.html">Plane</a> - Plane wave</li>
<li><a href="Users_Manual/API/./gain/uniform.html">Uniform</a> - Drive all transducers with the same phase/amplitude</li>
<li><a href="Users_Manual/API/./gain/custom.html">Custom</a> - User can freely specify phase/amplitude</li>
<li><a href="Users_Manual/API/./gain/grouped.html">GainGroup</a> - Group transducers and apply different <code>Gain</code> to each group</li>
<li><a href="Users_Manual/API/./gain/holo.html">Holo</a> - Multi-focus sound field</li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gain.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="null"><a class="header" href="#null">Null</a></h1>
<p><code>Null</code> is a <code>Gain</code> with an intensity of zero.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>Null {};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>Null{};
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp.Gain;
</span>new Null();
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Null
</span>Null()
</code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gain/null.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="focus"><a class="header" href="#focus">Focus</a></h1>
<p><code>Focus</code> generates a single focal point.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let x = 0.;
</span><span class="boring">let y = 0.;
</span><span class="boring">let z = 0.;
</span><span class="boring">let _ = 
</span>Focus {
    pos: Point3::new(x, y, z),
    option: FocusOption {
        intensity: Intensity::MAX,
        phase_offset: Phase::ZERO,
    },
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">const auto x = 0.0;
</span><span class="boring">const auto y = 0.0;
</span><span class="boring">const auto z = 0.0;
</span>Focus(Point3(x, y, z),
      FocusOption{
          .intensity = std::numeric_limits&lt;Intensity&gt;::max(),
          .phase_offset = Phase::zero(),
      });
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using AUTD3Sharp.Gain;
</span><span class="boring">var x = 0.0f;
</span><span class="boring">var y = 0.0f;
</span><span class="boring">var z = 0.0f;
</span>new Focus(
    pos: new Point3(x, y, z),
    option: new FocusOption
    {
        Intensity = Intensity.Max,
        PhaseOffset = Phase.Zero
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Intensity, Focus, FocusOption, Phase
</span><span class="boring">
</span><span class="boring">x = 1.0
</span><span class="boring">y = 0.0
</span><span class="boring">z = 0.0
</span>Focus(
    pos=[x, y, z],
    option=FocusOption(
        intensity=Intensity.MAX,
        phase_offset=Phase.ZERO,
    ),
)
</code></pre>
</div></div>
<p>Optionally, you can specify the output intensity and phase offset.
The default values are as above.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gain/focus.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="bessel"><a class="header" href="#bessel">Bessel</a></h1>
<p><code>Bessel</code> generates a Bessel beam.
This <code>Gain</code> is based on the paper by Hasegawa et al. <sup class="footnote-reference"><a href="#hasegawa2017">1</a></sup>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let x = 0.;
</span><span class="boring">let y = 0.;
</span><span class="boring">let z = 0.;
</span><span class="boring">let nx = 0.;
</span><span class="boring">let ny = 0.;
</span><span class="boring">let nz = 0.;
</span><span class="boring">let theta = 0. * rad;
</span><span class="boring">let _ = 
</span>Bessel {
    pos: Point3::new(x, y, z),
    dir: UnitVector3::new_normalize(Vector3::new(nx, ny, nz)),
    theta,
    option: BesselOption {
        intensity: Intensity::MAX,
        phase_offset: Phase::ZERO,
    },
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">const auto x = 0.0;
</span><span class="boring">const auto y = 0.0;
</span><span class="boring">const auto z = 0.0;
</span><span class="boring">const auto nx = 0.0;
</span><span class="boring">const auto ny = 0.0;
</span><span class="boring">const auto nz = 1.0;
</span><span class="boring">const auto theta = 0.0;
</span>Bessel(Point3(x, y, z), Vector3(nx, ny, nz), theta* rad,
       BesselOption{
           .intensity = std::numeric_limits&lt;Intensity&gt;::max(),
           .phase_offset = Phase::zero(),
       });
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using AUTD3Sharp.Gain;
</span><span class="boring">using static AUTD3Sharp.Units;
</span><span class="boring">var x = 0.0f;
</span><span class="boring">var y = 0.0f;
</span><span class="boring">var z = 0.0f;
</span><span class="boring">var nx = 0.0f;
</span><span class="boring">var ny = 0.0f;
</span><span class="boring">var nz = 1.0f;
</span><span class="boring">var theta = 0.0f;
</span>new Bessel(
    pos: new Point3(x, y, z),
    dir: new Vector3(nx, ny, nz),
    theta: theta * rad,
    option: new BesselOption
    {
        Intensity = Intensity.Max,
        PhaseOffset = Phase.Zero
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Bessel, BesselOption, Intensity, Phase, rad
</span><span class="boring">
</span><span class="boring">x = 0.0
</span><span class="boring">y = 0.0
</span><span class="boring">z = 0.0
</span><span class="boring">nx = 1.0
</span><span class="boring">ny = 0.0
</span><span class="boring">nz = 0.0
</span><span class="boring">theta = 0.0
</span>Bessel(
    pos=[x, y, z],
    direction=[nx, ny, nz],
    theta=theta * rad,
    option=BesselOption(
        intensity=Intensity.MAX,
        phase_offset=Phase.ZERO,
    ),
)
</code></pre>
</div></div>
<p>Here, <code>pos</code> is the apex of the virtual cone (dotted line in the figure below) that generates the beam, <code>dir</code> is the direction of the beam, and <code>theta</code> is the angle between the plane perpendicular to the beam and the side of the virtual cone that generates the beam (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> in the figure below).</p>
<figure>
  <img src="Users_Manual/API/gain/../../../fig/Users_Manual/1.4985159.figures.online.f1.jpg"/>
  <figcaption>Bessel beam (cited from the paper by Hasegawa et al.)</figcaption>
</figure>
<p>Optionally, you can specify the output intensity and phase offset.
The default values are as above.</p>
<div class="footnote-definition" id="hasegawa2017"><sup class="footnote-definition-label">1</sup>
<p>Hasegawa, Keisuke, et al. “Electronically steerable ultrasound-driven long narrow air stream.” Applied Physics Letters 111.6 (2017): 064104.</p>
</div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gain/bessel.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="plane"><a class="header" href="#plane">Plane</a></h1>
<p><code>Plane</code> outputs a plane wave.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let nx = 0.;
</span><span class="boring">let ny = 0.;
</span><span class="boring">let nz = 0.;
</span><span class="boring">let _ = 
</span>Plane {
    dir: UnitVector3::new_normalize(Vector3::new(nx, ny, nz)),
    option: PlaneOption {
        intensity: Intensity::MAX,
        phase_offset: Phase::ZERO,
    },
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">const auto nx = 0.0;
</span><span class="boring">const auto ny = 0.0;
</span><span class="boring">const auto nz = 1.0;
</span>Plane(Vector3(nx, ny, nz),
      PlaneOption{
          .intensity = std::numeric_limits&lt;Intensity&gt;::max(),
          .phase_offset = Phase::zero(),
      });
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using AUTD3Sharp.Gain;
</span><span class="boring">var nx = 0.0f;
</span><span class="boring">var ny = 0.0f;
</span><span class="boring">var nz = 1.0f;
</span>new Plane(
    dir: new Vector3(nx, ny, nz),
    option: new PlaneOption
    {
        Intensity = Intensity.Max,
        PhaseOffset = Phase.Zero
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Intensity, Phase, Plane, PlaneOption
</span><span class="boring">nx = 1.0
</span><span class="boring">ny = 0.0
</span><span class="boring">nz = 0.0
</span>Plane(
    direction=[nx, ny, nz],
    option=PlaneOption(
        intensity=Intensity.MAX,
        phase_offset=Phase.ZERO,
    ),
)
</code></pre>
</div></div>
<p>Here, <code>dir</code> is the direction of the plane wave.</p>
<p>Optionally, you can specify the output amplitude and phase offset.
The default values are as above.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gain/plane.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="uniform"><a class="header" href="#uniform">Uniform</a></h1>
<p><code>Uniform</code> sets the same phase/intensity for all transducers.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>Uniform {
    intensity: Intensity::MAX, 
    phase: Phase::ZERO,
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include &lt;limits&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>Uniform(std::numeric_limits&lt;Intensity&gt;::max(), Phase::zero());
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Gain;
</span>new Uniform(
    intensity: Intensity.Max,
    phase: Phase.Zero
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Intensity, Phase, Uniform
</span>Uniform(intensity=Intensity.MAX, phase=Phase.ZERO)
</code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gain/uniform.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="custom"><a class="header" href="#custom">Custom</a></h1>
<p><code>Custom</code> is a <code>Gain</code> that allows the user to freely generate sound fields.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust">use autd3::gain::Custom;
<span class="boring">use autd3::prelude::*;
</span>
<span class="boring">fn main() {
</span><span class="boring">let _ =
</span>Custom::new(|_dev| {
    |_tr| Drive {
        phase: Phase::ZERO,
        intensity: Intensity::MIN,
    }
});
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span>#include &lt;autd3/gain/custom.hpp&gt;

<span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>gain::Custom([](const auto&amp; dev) {
  return [](const auto&amp; tr) {
    return Drive(Phase::zero(), std::numeric_limits&lt;Intensity&gt;::min());
  };
});
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using System;
</span><span class="boring">using AUTD3Sharp;
</span>using AUTD3Sharp.Gain;
<span class="boring">using static AUTD3Sharp.Units;
</span>
new Custom(dev =&gt; tr =&gt; new Drive(Phase.Zero, Intensity.Min));
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Drive, Intensity, Phase
</span>from pyautd3.gain import Custom

Custom(lambda _dev: lambda _tr: Drive(phase=Phase.ZERO, intensity=Intensity.MIN))
</code></pre>
</div></div>
<p>The argument of the <code>Custom</code> constructor is <code>Fn(&amp;Device) -&gt; Fn(&amp;Transducer) -&gt; Drive</code>.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gain/custom.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="gaingroup"><a class="header" href="#gaingroup">GainGroup</a></h1>
<p><code>GainGroup</code> is a <code>Gain</code> that set different <code>Gains</code> for each transducer.</p>
<blockquote>
<p>NOTE: If you only need to group by device, it is recommended to use <a href="Users_Manual/API/gain/../group.html"><code>Group</code></a>.</p>
</blockquote>
<p>In <code>GainGroup</code>, keys are assigned to transducers, and each key is associated with a <code>Gain</code>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust">use autd3::prelude::*;
<span class="boring">use std::collections::HashMap;
</span>
<span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let x = 0.;
</span><span class="boring">let y = 0.;
</span><span class="boring">let z = 0.;
</span><span class="boring">let _ =
</span>GainGroup::new(
    |_dev| {
        |tr| match tr.idx() {
            0..=100 =&gt; Some("null"),
            _ =&gt; Some("focus"),
        }
    },
    HashMap::from([
        ("null", BoxedGain::new(Null {})),
        (
            "focus",
            BoxedGain::new(Focus {
                pos: Point3::new(x, y, z),
                option: Default::default(),
            }),
        ),
    ]),
);
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
<blockquote>
<p>NOTE: In the Rust version, the values of <code>HashMap</code> must all be of the same type, so <code>BoxedGain</code> is used here to unify the types.</p>
</blockquote>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;optional&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">const auto x = 0.0;
</span><span class="boring">const auto y = 0.0;
</span><span class="boring">const auto z = 0.0;
</span>GainGroup(
    [](const auto&amp; dev) {
      return [](const auto&amp; tr) -&gt; std::optional&lt;const char*&gt; {
        if (tr.idx() &lt;= 100) return "null";
        return "focus";
      };
    },
    std::unordered_map&lt;const char*, std::shared_ptr&lt;Gain&gt;&gt;{
        {"focus", std::make_shared&lt;Focus&gt;(Point3(x, y, z), FocusOption{})},
        {"null", std::make_shared&lt;Null&gt;()}});
<span class="boring">return 0; }
</span></code></pre>
<blockquote>
<p>NOTE: In C++, <code>std::optional</code> must be used for the keys. Also, to unify the types, <code>std::shared_ptr&lt;autd3::Gain&gt;</code> is used.</p>
</blockquote>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using AUTD3Sharp.Gain;
</span><span class="boring">using AUTD3Sharp.Driver.Datagram;
</span><span class="boring">var x = 0.0f;
</span><span class="boring">var y = 0.0f;
</span><span class="boring">var z = 0.0f;
</span>new GainGroup(
    keyMap: dev =&gt; tr =&gt; tr.Idx() &lt;= 100 ? "null" : "focus",
    gainMap: new Dictionary&lt;object, IGain&gt; {
        { "null", new Null() },
        { "focus", new Focus(pos: new Point3(x, y, z), option: new FocusOption()) }
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Focus, FocusOption, Null, GainGroup
</span><span class="boring">x = 1.0
</span><span class="boring">y = 0.0
</span><span class="boring">z = 0.0
</span>GainGroup(
    key_map=lambda _: lambda tr: "null" if tr.idx() &lt;= 100 else "focus",
    gain_map={"null": Null(), "focus": Focus(pos=[x, y, z], option=FocusOption())},
)
</code></pre>
</div></div>
<p>In the above example, transducers with local indices from 0 to 100 output <code>Null</code>, and the rest output <code>Focus</code>.</p>
<blockquote>
<p>NOTE:
In this sample, <code>&amp;str</code> are used as keys, but any type that can be used as a key in <code>HashMap</code> is acceptable.</p>
</blockquote>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gain/grouped.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="holo"><a class="header" href="#holo">Holo</a></h1>
<p><code>Holo</code> is a <code>Gain</code> for generating multiple focal points.</p>
<h2 id="install-5"><a class="header" href="#install-5">Install</a></h2>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C#-tab-0">C#</label><input id="Unity-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Unity-tab-0">Unity</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-shell">cargo add autd3-gain-holo
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp name=CMakeLists.txt">target_link_libraries(&lt;TARGET&gt; PRIVATE autd3::gain::holo)
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Unity-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<p>Included in the main library.</p>
</div></div>
<h2 id="apis-5"><a class="header" href="#apis-5">APIs</a></h2>
<p>Several algorithms for generating multiple focal points have been proposed, and the SDK implements the following algorithms:</p>
<ul>
<li><a href="Users_Manual/API/gain/./holo/naive.html"><code>Naive</code></a> - Superimposition of single focal point solutions</li>
<li><a href="Users_Manual/API/gain/./holo/gs.html"><code>GS</code></a> - Gershberg-Saxon</li>
<li><a href="Users_Manual/API/gain/./holo/gspat.html"><code>GSPAT</code></a> - Gershberg-Saxon for Phased Arrays of Transducers</li>
<li><a href="Users_Manual/API/gain/./holo/greedy.html"><code>Greedy</code></a> - Greedy algorithm and Brute-force search</li>
</ul>
<h2 id="emission-constraints"><a class="header" href="#emission-constraints">Emission Constraints</a></h2>
<p>The intensity of the calculation results of each algorithm must ultimately be limited to the range that the transducers can output.
This can be controlled with the optional <code>EmissionConstraint</code>, and one of the following four must be specified:</p>
<ul>
<li>Normalize: Normalize all transducer intensities by dividing by the maximum intensity.</li>
<li>Uniform: Set the intensity of all transducers to the specified value.</li>
<li>Clamp: Clamp the intensity to the specified range.</li>
<li>Multiply: Multiply by a specified value after normalization.</li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gain/holo.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="naive"><a class="header" href="#naive">Naive</a></h1>
<p><code>Gain</code> for multiple focal points by superimposing single focal point solutions.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span>use autd3_gain_holo::{EmissionConstraint, Pa, Naive, NaiveOption};

<span class="boring">fn main() {
</span><span class="boring">let x1 = 0.;
</span><span class="boring">let y1 = 0.;
</span><span class="boring">let z1 = 0.;
</span><span class="boring">let x2 = 0.;
</span><span class="boring">let y2 = 0.;
</span><span class="boring">let z2 = 0.;
</span><span class="boring">let _ = 
</span>Naive::new(
    vec![
        (Point3::new(x1, y1, z1), 5e3 * Pa),
        (Point3::new(x2, y2, z2), 5e3 * Pa),
    ],
    NaiveOption {
        constraint: EmissionConstraint::Clamp(Intensity::MIN, Intensity::MAX),
        ..Default::default()
    },
);
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span>#include "autd3/gain/holo.hpp"

<span class="boring">using namespace autd3;
</span>using gain::holo::Pa;

<span class="boring">int main() {
</span><span class="boring">const auto x1 = 0.0;
</span><span class="boring">const auto y1 = 0.0;
</span><span class="boring">const auto z1 = 0.0;
</span><span class="boring">const auto x2 = 0.0;
</span><span class="boring">const auto y2 = 0.0;
</span><span class="boring">const auto z2 = 0.0;
</span>auto g = gain::holo::Naive(
    std::vector&lt;std::pair&lt;Point3, gain::holo::Amplitude&gt;&gt;{
        {Point3(x1, y1, z1), 5e3 * Pa},
        {Point3(x2, y2, z2), 5e3 * Pa},
    },
    gain::holo::NaiveOption{
        .constraint = gain::holo::EmissionConstraint::Clamp(
            std::numeric_limits&lt;Intensity&gt;::min(),
            std::numeric_limits&lt;Intensity&gt;::max()),
    });
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs">using AUTD3Sharp.Gain.Holo;

<span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using static AUTD3Sharp.Units;
</span><span class="boring">var x1 = 0.0f;
</span><span class="boring">var y1 = 0.0f;
</span><span class="boring">var z1 = 0.0f;
</span><span class="boring">var x2 = 0.0f;
</span><span class="boring">var y2 = 0.0f;
</span><span class="boring">var z2 = 0.0f;
</span>new Naive(
    foci: [
             (new Point3(x1, y1, z1), 5e3f * Pa),
             (new Point3(x2, y2, z2), 5e3f * Pa)
    ],
    option: new NaiveOption
    {
        EmissionConstraint = EmissionConstraint.Clamp(Intensity.Min, Intensity.Max),
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">import numpy as np
</span><span class="boring">from pyautd3 import Intensity
</span>from pyautd3.gain.holo import Naive, EmissionConstraint, NaiveOption, Pa

<span class="boring">x1 = 0.0
</span><span class="boring">y1 = 0.0
</span><span class="boring">z1 = 0.0
</span><span class="boring">x2 = 0.0
</span><span class="boring">y2 = 0.0
</span><span class="boring">z2 = 0.0
</span>Naive(
    foci=[(np.array([x1, y1, z1]), 5e3 * Pa), (np.array([x2, y2, z2]), 5e3 * Pa)],
    option=NaiveOption(
        constraint=EmissionConstraint.Clamp(Intensity.MIN, Intensity.MAX),
    ),
)
</code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gain/holo/naive.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="gs"><a class="header" href="#gs">GS</a></h1>
<p>Gershberg-Saxon, <code>Gain</code> for multiple focal points based on the paper by Marzo et al.<sup class="footnote-reference"><a href="#marzo2019">1</a></sup>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span>use autd3_gain_holo::{EmissionConstraint, Pa, GS, GSOption};
<span class="boring">use std::num::NonZeroUsize;
</span>
<span class="boring">fn main() {
</span><span class="boring">let x1 = 0.;
</span><span class="boring">let y1 = 0.;
</span><span class="boring">let z1 = 0.;
</span><span class="boring">let x2 = 0.;
</span><span class="boring">let y2 = 0.;
</span><span class="boring">let z2 = 0.;
</span><span class="boring">let _ = 
</span>GS::new(
    vec![
        (Point3::new(x1, y1, z1), 5e3 * Pa),
        (Point3::new(x2, y2, z2), 5e3 * Pa),
    ],
    GSOption {
        repeat: NonZeroUsize::new(100).unwrap(),
        constraint: EmissionConstraint::Clamp(Intensity::MIN, Intensity::MAX),
    },
);
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span>#include "autd3/gain/holo.hpp"

<span class="boring">using namespace autd3;
</span>using gain::holo::Pa;

<span class="boring">int main() {
</span><span class="boring">const auto x1 = 0.0;
</span><span class="boring">const auto y1 = 0.0;
</span><span class="boring">const auto z1 = 0.0;
</span><span class="boring">const auto x2 = 0.0;
</span><span class="boring">const auto y2 = 0.0;
</span><span class="boring">const auto z2 = 0.0;
</span>auto g = gain::holo::GS(
    std::vector&lt;std::pair&lt;Point3, gain::holo::Amplitude&gt;&gt;{
        {Point3(x1, y1, z1), 5e3 * Pa},
        {Point3(x2, y2, z2), 5e3 * Pa},
    },
    gain::holo::GSOption{
        .repeat = 100,
        .constraint = gain::holo::EmissionConstraint::Clamp(
            std::numeric_limits&lt;Intensity&gt;::min(),
            std::numeric_limits&lt;Intensity&gt;::max()),
    });
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs">using AUTD3Sharp.Gain.Holo;

<span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using static AUTD3Sharp.Units;
</span><span class="boring">var x1 = 0.0f;
</span><span class="boring">var y1 = 0.0f;
</span><span class="boring">var z1 = 0.0f;
</span><span class="boring">var x2 = 0.0f;
</span><span class="boring">var y2 = 0.0f;
</span><span class="boring">var z2 = 0.0f;
</span>new GS(
    foci: [
             (new Point3(x1, y1, z1), 5e3f * Pa),
             (new Point3(x2, y2, z2), 5e3f * Pa)
    ],
    option: new GSOption
    {
        Repeat = 100,
        EmissionConstraint = EmissionConstraint.Clamp(Intensity.Min, Intensity.Max),
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">import numpy as np
</span><span class="boring">from pyautd3 import Intensity
</span>from pyautd3.gain.holo import GS, EmissionConstraint, GSOption, Pa

<span class="boring">x1 = 0.0
</span><span class="boring">y1 = 0.0
</span><span class="boring">z1 = 0.0
</span><span class="boring">x2 = 0.0
</span><span class="boring">y2 = 0.0
</span><span class="boring">z2 = 0.0
</span>GS(
    foci=[(np.array([x1, y1, z1]), 5e3 * Pa), (np.array([x2, y2, z2]), 5e3 * Pa)],
    option=GSOption(
        repeat=100,
        constraint=EmissionConstraint.Clamp(Intensity.MIN, Intensity.MAX),
    ),
)
</code></pre>
</div></div>
<p><code>repeat</code> is the number of iterations, the default is as above.
For details on the parameters, refer to the paper<sup class="footnote-reference"><a href="#marzo2019">1</a></sup>.</p>
<div class="footnote-definition" id="marzo2019"><sup class="footnote-definition-label">1</sup>
<p>Marzo, Asier, and Bruce W. Drinkwater. “Holographic acoustic tweezers.” Proceedings of the National Academy of Sciences 116.1 (2019): 84-89.</p>
</div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gain/holo/gs.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="gspat"><a class="header" href="#gspat">GSPAT</a></h1>
<p>Gershberg-Saxon for Phased Arrays of Transducers, <code>Gain</code> for multiple focal points based on the paper by Plasencia et al.<sup class="footnote-reference"><a href="#plasencia2020">1</a></sup>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span>use autd3_gain_holo::{EmissionConstraint, Pa, GSPAT, GSPATOption};
<span class="boring">use std::num::NonZeroUsize;
</span>
<span class="boring">fn main() {
</span><span class="boring">let x1 = 0.;
</span><span class="boring">let y1 = 0.;
</span><span class="boring">let z1 = 0.;
</span><span class="boring">let x2 = 0.;
</span><span class="boring">let y2 = 0.;
</span><span class="boring">let z2 = 0.;
</span><span class="boring">let _ = 
</span>GSPAT::new(
    vec![
        (Point3::new(x1, y1, z1), 5e3 * Pa),
        (Point3::new(x2, y2, z2), 5e3 * Pa),
    ],
    GSPATOption {
        repeat: NonZeroUsize::new(100).unwrap(),
        constraint: EmissionConstraint::Clamp(Intensity::MIN, Intensity::MAX),
    },
);
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span>#include "autd3/gain/holo.hpp"

<span class="boring">using namespace autd3;
</span>using gain::holo::Pa;

<span class="boring">int main() {
</span><span class="boring">const auto x1 = 0.0;
</span><span class="boring">const auto y1 = 0.0;
</span><span class="boring">const auto z1 = 0.0;
</span><span class="boring">const auto x2 = 0.0;
</span><span class="boring">const auto y2 = 0.0;
</span><span class="boring">const auto z2 = 0.0;
</span>auto g = gain::holo::GSPAT(
    std::vector&lt;std::pair&lt;Point3, gain::holo::Amplitude&gt;&gt;{
        {Point3(x1, y1, z1), 5e3 * Pa},
        {Point3(x2, y2, z2), 5e3 * Pa},
    },
    gain::holo::GSPATOption{
        .repeat = 100,
        .constraint = gain::holo::EmissionConstraint::Clamp(
            std::numeric_limits&lt;Intensity&gt;::min(),
            std::numeric_limits&lt;Intensity&gt;::max()),
    });
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs">using AUTD3Sharp.Gain.Holo;

<span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using static AUTD3Sharp.Units;
</span><span class="boring">var x1 = 0.0f;
</span><span class="boring">var y1 = 0.0f;
</span><span class="boring">var z1 = 0.0f;
</span><span class="boring">var x2 = 0.0f;
</span><span class="boring">var y2 = 0.0f;
</span><span class="boring">var z2 = 0.0f;
</span>new GSPAT(
    foci: [
             (new Point3(x1, y1, z1), 5e3f * Pa),
             (new Point3(x2, y2, z2), 5e3f * Pa)
    ],
    option: new GSPATOption
    {
        Repeat = 100,
        EmissionConstraint = EmissionConstraint.Clamp(Intensity.Min, Intensity.Max),
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">import numpy as np
</span><span class="boring">from pyautd3 import Intensity
</span>from pyautd3.gain.holo import GSPAT, EmissionConstraint, GSPATOption, Pa

<span class="boring">x1 = 0.0
</span><span class="boring">y1 = 0.0
</span><span class="boring">z1 = 0.0
</span><span class="boring">x2 = 0.0
</span><span class="boring">y2 = 0.0
</span><span class="boring">z2 = 0.0
</span>GSPAT(
    foci=[(np.array([x1, y1, z1]), 5e3 * Pa), (np.array([x2, y2, z2]), 5e3 * Pa)],
    option=GSPATOption(
        repeat=100,
        constraint=EmissionConstraint.Clamp(Intensity.MIN, Intensity.MAX),
    ),
)
</code></pre>
</div></div>
<p><code>repeat</code> is the number of iterations, the default is as above.
For details on the parameters, refer to the paper<sup class="footnote-reference"><a href="#plasencia2020">1</a></sup>.</p>
<div class="footnote-definition" id="plasencia2020"><sup class="footnote-definition-label">1</sup>
<p>Plasencia, Diego Martinez, et al. “GS-PAT: high-speed multi-point sound-fields for phased arrays of transducers.” ACM Transactions on Graphics (TOG) 39.4 (2020): 138-1.</p>
</div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gain/holo/gspat.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="lm"><a class="header" href="#lm">LM</a></h1>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gain/holo/lm.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="greedy"><a class="header" href="#greedy">Greedy</a></h1>
<p>Greedy Algorithm with Brute-Force Search, <code>Gain</code> for multiple focal points based on the paper by Suzuki et al.<sup class="footnote-reference"><a href="#suzuki2021">1</a></sup>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span>use autd3_gain_holo::{EmissionConstraint, Pa, Greedy, GreedyOption, abs_objective_func};
<span class="boring">use std::num::NonZeroU8;
</span>
<span class="boring">fn main() {
</span><span class="boring">let x1 = 0.;
</span><span class="boring">let y1 = 0.;
</span><span class="boring">let z1 = 0.;
</span><span class="boring">let x2 = 0.;
</span><span class="boring">let y2 = 0.;
</span><span class="boring">let z2 = 0.;
</span><span class="boring">let _ = 
</span>Greedy::new(
    vec![
        (Point3::new(x1, y1, z1), 5e3 * Pa),
        (Point3::new(x2, y2, z2), 5e3 * Pa),
    ],
    GreedyOption {
        phase_quantization_levels: NonZeroU8::new(16).unwrap(),
        constraint: EmissionConstraint::Uniform(Intensity::MAX),
        objective_func: abs_objective_func,
    },
);
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include &lt;autd3.hpp&gt;
</span>#include "autd3/gain/holo.hpp"

<span class="boring">using namespace autd3;
</span>using gain::holo::Pa;

<span class="boring">int main() {
</span><span class="boring">const auto x1 = 0.0;
</span><span class="boring">const auto y1 = 0.0;
</span><span class="boring">const auto z1 = 0.0;
</span><span class="boring">const auto x2 = 0.0;
</span><span class="boring">const auto y2 = 0.0;
</span><span class="boring">const auto z2 = 0.0;
</span>auto g = gain::holo::Greedy(
    std::vector&lt;std::pair&lt;Point3, gain::holo::Amplitude&gt;&gt;{
        {Point3(x1, y1, z1), 5e3 * Pa},
        {Point3(x2, y2, z2), 5e3 * Pa},
    },
    gain::holo::GreedyOption{
        .phase_quantization_levels = 16,
        .constraint = gain::holo::EmissionConstraint::Uniform(
            std::numeric_limits&lt;Intensity&gt;::max())});
<span class="boring">  return 0;
</span><span class="boring">}
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs">using AUTD3Sharp.Gain.Holo;

<span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using static AUTD3Sharp.Units;
</span><span class="boring">var x1 = 0.0f;
</span><span class="boring">var y1 = 0.0f;
</span><span class="boring">var z1 = 0.0f;
</span><span class="boring">var x2 = 0.0f;
</span><span class="boring">var y2 = 0.0f;
</span><span class="boring">var z2 = 0.0f;
</span>new Greedy(
    foci: [
             (new Point3(x1, y1, z1), 5e3f * Pa),
             (new Point3(x2, y2, z2), 5e3f * Pa)
    ],
    option: new GreedyOption
    {
        PhaseQuantizationLevels = 16,
        EmissionConstraint = EmissionConstraint.Uniform(Intensity.Max),
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">import numpy as np
</span><span class="boring">from pyautd3 import Intensity
</span>from pyautd3.gain.holo import Greedy, EmissionConstraint, GreedyOption, Pa

<span class="boring">x1 = 0.0
</span><span class="boring">y1 = 0.0
</span><span class="boring">z1 = 0.0
</span><span class="boring">x2 = 0.0
</span><span class="boring">y2 = 0.0
</span><span class="boring">z2 = 0.0
</span>Greedy(
    foci=[(np.array([x1, y1, z1]), 5e3 * Pa), (np.array([x2, y2, z2]), 5e3 * Pa)],
    option=GreedyOption(
        phase_quantization_levels=16,
        constraint=EmissionConstraint.Uniform(Intensity.MAX),
    ),
)
</code></pre>
</div></div>
<p><code>phase_quantization_levels</code> is the discretization depth of the phase, the default is as above.
For details on the parameters, refer to the paper<sup class="footnote-reference"><a href="#suzuki2021">1</a></sup>.</p>
<div class="footnote-definition" id="suzuki2021"><sup class="footnote-definition-label">1</sup>
<p>Suzuki, Shun, et al. “Radiation Pressure Field Reconstruction for Ultrasound Midair Haptics by Greedy Algorithm with Brute-Force Search.” IEEE Transactions on Haptics (2021).</p>
</div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gain/holo/greedy.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="spatio-temporal-modulation"><a class="header" href="#spatio-temporal-modulation">Spatio-Temporal Modulation</a></h1>
<p>The SDK provides a feature for periodically switching sound fields called Spatio-Temporal Modulation (STM).
The SDK supports <code>FociSTM</code> for single to eight focal points and <code>GainSTM</code> for arbitrary <code>Gain</code>.
<code>FociSTM</code> and <code>GainSTM</code> use the timer on the AUTD3 hardware, providing high time precision but with some constraints.</p>
<ul>
<li><a href="Users_Manual/API/./stm/focus.html">FociSTM</a></li>
<li><a href="Users_Manual/API/./stm/gain.html">GainSTM</a></li>
</ul>
<h2 id="common-api-for-focistmgainstm"><a class="header" href="#common-api-for-focistmgainstm">Common API for FociSTM/GainSTM</a></h2>
<h3 id="getting-sampling-configuration"><a class="header" href="#getting-sampling-configuration">Getting Sampling Configuration</a></h3>
<p>You can get the sampling configuration with <code>sampling_config</code>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span>let stm = FociSTM {
    foci: vec![Point3::origin(), Point3::origin()],
    config: 1.0 * Hz,
};
dbg!(stm.sampling_config()?.freq()?); // -&gt; 2Hz
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;iostream&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>FociSTM stm(
    std::vector{
        Point3::origin(),
        Point3::origin(),
    },
    1.0f * Hz);
std::cout &lt;&lt; stm.sampling_config().freq() &lt;&lt; std::endl;  // -&gt; 2Hz
<span class="boring">                                                         return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using static AUTD3Sharp.Units;
</span>var stm = new FociSTM(foci: [Point3.Origin, Point3.Origin], config: 1.0f * Hz);
Console.WriteLine(stm.SamplingConfig().Freq()); // -&gt; 2 Hz
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">import numpy as np
</span><span class="boring">from pyautd3 import FociSTM, Hz
</span>stm = FociSTM(
    foci=[np.array([0.0, 0.0, 0.0]), np.array([0.0, 0.0, 0.0])],
    config=1.0 * Hz,
)
print(stm.sampling_config().freq())  # -&gt; 2Hz
</code></pre>
</div></div>
<h3 id="finiteloop"><a class="header" href="#finiteloop">FiniteLoop</a></h3>
<p>In <code>FociSTM</code>/<code>GainSTM</code>, you can control the loop behavior.
The default is an infinite loop.</p>
<p>For details, refer to <a href="Users_Manual/API/./segment.html">Segment/FiniteLoop</a>.</p>
<h3 id="utilities"><a class="header" href="#utilities">Utilities</a></h3>
<p>Only the Rust version provides utilities for generating linear and circular trajectories.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=1 for="Rust-tab-1">Rust</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let start = Point3::origin();
</span><span class="boring">let end = Point3::origin();
</span><span class="boring">let center = Point3::origin();
</span><span class="boring">let radius = 30.0 * mm;
</span><span class="boring">let num_points = 50;
</span><span class="boring">let n = Vector3::z_axis();
</span><span class="boring">let intensity = Intensity::MAX;
</span><span class="boring">let _ = 
</span>FociSTM {
    foci: Line {
        start,
        end,
        num_points,
        intensity,
    },
    config: 1.0 * Hz,
};

<span class="boring">let _ = 
</span>FociSTM {
    foci: Circle {
        center,
        radius,
        num_points,
        n, // normal vector to the plane where the circle is drawn
        intensity,
    },
    config: 1.0 * Hz,
};
<span class="boring">}</span></code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/stm.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="focistm"><a class="header" href="#focistm">FociSTM</a></h1>
<ul>
<li>The maximum number of sound field patterns is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8192</span></span></span></span>
<ul>
<li>In extended mode, it is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16384</span></span></span></span></li>
</ul>
</li>
<li>The sampling rate is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord">40</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">kHz</span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>, where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> is a 16-bit unsigned integer greater than 0</li>
</ul>
<p>The usage of <code>FociSTM</code> is as follows.
This is a sample that rotates a focus on the circumference of a circle with a radius of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">30</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">mm</span></span></span></span></span></span> centered at a point <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">150</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">mm</span></span></span></span></span></span> directly above the center of the array.
The circumference is sampled at 200 points, rotating at <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">Hz</span></span></span></span></span></span>. (That is, the sampling frequency is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">200</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">Hz</span></span></span></span></span></span>.)</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span>let center = Point3::new(0., 0., 150.0 * mm);
let point_num = 200;
let radius = 30.0 * mm;
<span class="boring">let _ = 
</span>FociSTM {
    foci: (0..point_num)
        .map(|i| {
            let theta = 2.0 * PI * i as f32 / point_num as f32;
            let p = radius * Vector3::new(theta.cos(), theta.sin(), 0.0);
            center + p
        })
        .collect::&lt;Vec&lt;_&gt;&gt;(),
    config: 1.0 * Hz,
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include &lt;ranges&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">using namespace std::ranges::views;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>const Point3 center(0, 0, 150);
const auto points_num = 200;
const auto radius = 30.0f;
std::vector&lt;Point3&gt; foci;
std::ranges::copy(iota(0) | take(points_num) | transform([&amp;](auto i) {
                    const auto theta = 2.0f * pi * static_cast&lt;float&gt;(i) /
                                       static_cast&lt;float&gt;(points_num);
                    Point3 p = center + radius * Vector3(std::cos(theta),
                                                         std::sin(theta), 0);
                    return p;
                  }),
                  std::back_inserter(foci));
FociSTM(foci, 1.0f * Hz);
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using AUTD3Sharp.Link;
</span><span class="boring">using static AUTD3Sharp.Units;
</span>var center = new Point3(0, 0, 150);
const int pointNum = 200;
const float radius = 30.0f;
new FociSTM(
    foci: Enumerable.Range(0, pointNum).Select(i =&gt;
    {
        var theta = 2.0f * MathF.PI * i / pointNum;
        return center + radius * new Vector3(MathF.Cos(theta), MathF.Sin(theta), 0);
    }),
    config: 1.0f * Hz
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">import numpy as np
</span><span class="boring">from pyautd3 import FociSTM, Hz
</span>center = np.array([0.0, 0.0, 150.0])
point_num = 200
radius = 30.0
FociSTM(
    foci=(
        center + radius * np.array([np.cos(theta), np.sin(theta), 0])
        for theta in (2.0 * np.pi * i / point_num for i in range(point_num))
    ),
    config=1.0 * Hz,
)
</code></pre>
</div></div>
<p>In <code>config</code>, you can specify the frequency, period, and sampling settings.</p>
<p>Due to constraints on the number of sampling points and the sampling period, it may not be possible to output at the specified frequency.
For example, in the above example, to rotate 200 points at <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">Hz</span></span></span></span></span></span>, the sampling frequency should be <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">200</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">Hz</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord">40</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">kHz</span></span></span></span><span class="mord">/200</span></span></span></span>.
However, if <code>point_num=199</code>, the sampling frequency must be <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">199</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">Hz</span></span></span></span></span></span>, but there is no integer <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> that satisfies <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">199</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">Hz</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord">40</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">kHz</span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>, resulting in an error.</p>
<p>Using <code>FociSTM::into_nearest</code>, the nearest <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> is selected, but note that the actual frequency may differ from the specified frequency.</p>
<h2 id="multiple-foci"><a class="header" href="#multiple-foci">Multiple Foci</a></h2>
<p><code>FociSTM</code> can output up to 8 foci simultaneously.</p>
<p>Below is an example with 2 foci.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span>let center = Point3::new(0., 0., 150.0 * mm);
let point_num = 200;
let radius = 30.0 * mm;
<span class="boring">let _ = 
</span>FociSTM {
    foci: (0..point_num)
        .map(|i| {
            let theta = 2.0 * PI * i as f32 / point_num as f32;
            let p = radius * Vector3::new(theta.cos(), theta.sin(), 0.0);
            ControlPoints {
                points: [
                    ControlPoint {
                        point: center + p,
                        phase_offset: Phase::ZERO,
                    },
                    ControlPoint {
                        point: center - p,
                        phase_offset: Phase::ZERO,
                    },
                ],
                intensity: Intensity::MAX,
            }
        })
        .collect::&lt;Vec&lt;_&gt;&gt;(),
    config: 1.0 * Hz,
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include &lt;ranges&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">using namespace std::ranges::views;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>const Point3 center(0, 0, 150);
const auto points_num = 200;
const auto radius = 30.0f;
std::vector&lt;ControlPoints&lt;2&gt;&gt; foci;
std::ranges::copy(iota(0) | take(points_num) | transform([&amp;](auto i) {
                    const auto theta = 2.0f * pi * static_cast&lt;float&gt;(i) /
                                       static_cast&lt;float&gt;(points_num);
                    Vector3 p =
                        radius * Vector3(std::cos(theta), std::sin(theta), 0);
                    return ControlPoints&lt;2&gt;{
                        .points = {ControlPoint{.point = center + p,
                                                .phase_offset = Phase::zero()},
                                   ControlPoint{.point = center - p,
                                                .phase_offset = Phase::zero()}},
                        .intensity = std::numeric_limits&lt;Intensity&gt;::max()};
                  }),
                  std::back_inserter(foci));
FociSTM stm(foci, 1.0f * Hz);
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using AUTD3Sharp.Link;
</span><span class="boring">using static AUTD3Sharp.Units;
</span>var center = new Point3(0, 0, 150);
const int pointNum = 200;
const float radius = 30.0f;
new FociSTM(
    foci: Enumerable.Range(0, pointNum).Select(i =&gt;
        {
            var theta = 2.0f * MathF.PI * i / pointNum;
            var p = radius * new Vector3(MathF.Cos(theta), MathF.Sin(theta), 0);
            return new ControlPoints(
                points: [
                    new ControlPoint { Point = center + p, PhaseOffset = Phase.Zero},
                    new ControlPoint { Point = center - p, PhaseOffset = Phase.Zero}
                ],
                intensity: Intensity.Max
            );
        }),
    config: 1.0f * Hz
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">import numpy as np
</span><span class="boring">from pyautd3 import ControlPoint, ControlPoints, Intensity, FociSTM, Hz, Phase
</span>center = np.array([0.0, 0.0, 150.0])
point_num = 200
radius = 30.0
FociSTM(
    foci=(
        ControlPoints(
            points=[
                ControlPoint(
                    point=center + radius * np.array([np.cos(theta), np.sin(theta), 0]),
                    phase_offset=Phase.ZERO,
                ),
                ControlPoint(
                    point=center - radius * np.array([np.cos(theta), np.sin(theta), 0]),
                    phase_offset=Phase.ZERO,
                ),
            ],
            intensity=Intensity.MAX,
        )
        for theta in (2.0 * np.pi * i / point_num for i in range(point_num))
    ),
    config=1.0 * Hz,
)
</code></pre>
</div></div>
<p>The multi-focus sound field of <code>FociSTM</code> is a simple superposition of single-focus sound fields.
That is, for the position of the transducer <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, each focus position <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, ultrasonic frequency <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>, and speed of sound <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>, the phase <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span> is calculated as follows.
<span class="katex-display fleqn"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3616em;vertical-align:-1.2777em;"></span><span class="mord">∠</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0839em;"><span style="top:-3.413em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mord mathrm mtight">j</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9584em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.4624em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mord mtight">∥</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord text mtight"><span class="mord mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight">∥</span><span class="mbin mtight">+</span><span class="mord mathrm mtight">j</span><span class="mord mtight"><span class="mord mathnormal mtight">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
Here, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the phase offset of each focus.
For amplitude, the specified value from the software is used <strong>instead of</strong> <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0276em;vertical-align:-1.2777em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43z M367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0839em;"><span style="top:-3.413em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">π</span><span class="mord mathrm mtight">j</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9584em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.4624em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span class="mord mtight">∥</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord text mtight"><span class="mord mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight">∥</span><span class="mbin mtight">+</span><span class="mord mathrm mtight">j</span><span class="mord mtight"><span class="mord mathnormal mtight">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:5em;"></span><span style="width:0.556em;height:3.000em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.556em' height='3.000em' viewBox='0 0 556 3000'><path d='M145 15 v585 v1800 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v1800 v585 h43z M367 15 v585 v1800 v585 c2.667,10,9.667,15,21,15 c10,0,16.667,-5,20,-15 v-585 v-1800 v-585 c-2.667,-10,-9.667,-15,-21,-15 c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v1800 v585 h43z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span>.</p>
<h2 id="constraints"><a class="header" href="#constraints">Constraints</a></h2>
<p>To reduce data volume, <code>FociSTM</code> encodes the focus position coordinates as <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord">18</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">bit</span></span></span></span></span></span> signed fixed-point numbers with a unit of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">0.025</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">mm</span></span></span></span></span></span>.
Therefore, for each axis direction, only foci within the range of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord">−</span><span class="mord">3276.8</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">mm</span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">3276.775</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">mm</span></span></span><span class="mclose">]</span></span></span></span> from all transducers can be output.</p>
<p>Also, since internal calculations are performed with fixed-point numbers, the phase may differ from that of <code>gain::Focus</code>.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/stm/focus.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="gainstm"><a class="header" href="#gainstm">GainSTM</a></h1>
<p><code>GainSTM</code> is different from <code>FociSTM</code> in that it can handle arbitrary <code>Gain</code>.
However, the number of <code>Gain</code> that can be used is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1024</span></span></span></span> (in extended mode <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2048</span></span></span></span>).</p>
<p>The usage of <code>GainSTM</code> is as follows.
This is a sample that rotates a focus on the circumference of a circle with a radius of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">30</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">mm</span></span></span></span></span></span> centered at a point <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">150</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">mm</span></span></span></span></span></span> directly above the center of the array.
The circumference is sampled at 200 points, rotating at <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">Hz</span></span></span></span></span></span>. (That is, the sampling frequency is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">200</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">Hz</span></span></span></span></span></span>.)</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span>let center = Point3::new(0., 0., 150.0 * mm);
let point_num = 200;
let radius = 30.0 * mm;
<span class="boring">let _ = 
</span>GainSTM {
    gains: (0..point_num)
        .map(|i| {
            let theta = 2.0 * PI * i as f32 / point_num as f32;
            let p = radius * Vector3::new(theta.cos(), theta.sin(), 0.0);
            Focus {
                pos: center + p,
                option: FocusOption::default(),
            }
        })
        .collect::&lt;Vec&lt;_&gt;&gt;(),
    config: 1.0 * Hz,
    option: GainSTMOption {
        mode: GainSTMMode::PhaseIntensityFull,
    },
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include &lt;ranges&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">using namespace std::ranges::views;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>const Point3 center(0, 0, 150);
const auto points_num = 200;
const auto radius = 30.0f;
std::vector&lt;Focus&gt; gains;
std::ranges::copy(iota(0) | take(points_num) | transform([&amp;](auto i) {
                    const auto theta = 2.0f * pi * static_cast&lt;float&gt;(i) /
                                       static_cast&lt;float&gt;(points_num);
                    return Focus(center + radius * Vector3(std::cos(theta),
                                                           std::sin(theta), 0),
                                 FocusOption{});
                  }),
                  std::back_inserter(gains));
GainSTM(gains, 1.0f * Hz,
        GainSTMOption{.mode = GainSTMMode::PhaseIntensityFull});
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">using AUTD3Sharp.Gain;
</span><span class="boring">using AUTD3Sharp.Link;
</span><span class="boring">using static AUTD3Sharp.Units;
</span>var center = new Point3(0, 0, 150);
const int pointNum = 200;
const float radius = 30.0f;
new GainSTM(
    gains: Enumerable.Range(0, pointNum).Select(i =&gt;
    {
        var theta = 2.0f * MathF.PI * i / pointNum;
        return new Focus(
            pos: center + radius * new Vector3(MathF.Cos(theta), MathF.Sin(theta), 0),
            option: new FocusOption()
        );
    }),
    config: 1.0f * Hz,
    option: new GainSTMOption
    {
        Mode = GainSTMMode.PhaseIntensityFull
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">import numpy as np
</span><span class="boring">from pyautd3 import Focus, FocusOption, GainSTM, GainSTMMode, GainSTMOption, Hz
</span>center = np.array([0.0, 0.0, 150.0])
point_num = 200
radius = 30.0
GainSTM(
    gains=(
        Focus(
            pos=center + radius * np.array([np.cos(theta), np.sin(theta), 0]),
            option=FocusOption(),
        )
        for theta in (2.0 * np.pi * i / point_num for i in range(point_num))
    ),
    config=1.0 * Hz,
    option=GainSTMOption(
        mode=GainSTMMode.PhaseIntensityFull,
    ),
)
</code></pre>
</div></div>
<h2 id="gainstmmode"><a class="header" href="#gainstmmode">GainSTMMode</a></h2>
<p><code>GainSTM</code> sends all phase/intensity data, resulting in high latency<sup class="footnote-reference"><a href="#fn_gain_seq">1</a></sup>.
To address this issue, <code>GainSTM</code> has a <code>PhaseFull</code> mode that sends only the phase, reducing the transmission time by half, and a <code>PhaseHalf</code> mode that compresses the phase to 4 bits, reducing the transmission time to a quarter.
In these two modes, the maximum intensity is used regardless of the intensity setting of <code>Gain</code>.</p>
<p>The default mode is <code>PhaseIntensityFull</code>, which sends both intensity and phase data.</p>
<div class="footnote-definition" id="fn_gain_seq"><sup class="footnote-definition-label">1</sup>
<p>Approximately 75 times the latency of <code>FociSTM&lt;1&gt;</code></p>
</div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/stm/gain.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="modulation"><a class="header" href="#modulation">Modulation</a></h1>
<p><code>Modulation</code> is a mechanism to control amplitude modulation.</p>
<p>Modulation data is multiplied by the sound pressure amplitude.
For example, when applying <code>Sine</code> modulation of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">kHz</span></span></span></span></span></span>, the sound pressure amplitude will be as follows, and the envelope of the positive (or negative) part of the sound pressure amplitude will follow a <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">kHz</span></span></span></span></span></span> sine wave.</p>
<figure>
  <img src="Users_Manual/API/../../fig/Users_Manual/sine_1k_mod.png"/>
</figure>
<p>Currently, <code>Modulation</code> has the following limitations.</p>
<ul>
<li>The buffer size is up to 32768
<ul>
<li>65536 when using extended mode</li>
</ul>
</li>
<li>The sampling rate is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord">40</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">kHz</span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>. Here, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> is a 16-bit unsigned integer greater than 0.</li>
</ul>
<p>The SDK provides several types of <code>Modulation</code> to generate AM by default.</p>
<ul>
<li><a href="Users_Manual/API/./modulation/static.html">Static</a> - Without modulation</li>
<li><a href="Users_Manual/API/./modulation/sine.html">Sine</a> - Sine wave
<ul>
<li><a href="Users_Manual/API/./modulation/fourier.html">Fourier</a> - Superposition of sine waves</li>
</ul>
</li>
<li><a href="Users_Manual/API/./modulation/square.html">Square</a> - Square wave</li>
<li><a href="Users_Manual/API/./modulation/wav.html">Wav</a> - Modulation based on Wav file</li>
<li><a href="Users_Manual/API/./modulation/csv.html">Csv</a> - Modulation based on Csv file</li>
<li><a href="Users_Manual/API/./modulation/custom.html">Custom</a> - User-defined modulation</li>
<li><a href="Users_Manual/API/./modulation/radiation.html">RadiationPressure</a> - Apply modulation to radiation pressure instead of sound pressure</li>
<li><a href="Users_Manual/API/./modulation/fir.html">Fir</a> - Apply Fir filter</li>
</ul>
<h2 id="common-api-for-modulation"><a class="header" href="#common-api-for-modulation">Common API for Modulation</a></h2>
<h3 id="sampling-configuration"><a class="header" href="#sampling-configuration">Sampling Configuration</a></h3>
<p>The sampling configuration of <code>Modulation</code> can be obtained with <code>sampling_config</code>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span>let m = Sine {
    freq: 150 * Hz,
    option: SineOption::default(),
};
dbg!(m.sampling_config().freq()?); // -&gt; 4kHz
<span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;iostream&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>const auto m = Sine(150 * Hz, SineOption{});
std::cout &lt;&lt; m.sampling_config().freq() &lt;&lt; std::endl;  // -&gt; 4kHz
<span class="boring">                                                       return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Modulation;
</span><span class="boring">using static AUTD3Sharp.Units;
</span>var m = new Sine(freq: 150u * Hz, option: new SineOption());
Console.WriteLine(m.SamplingConfig().Freq()); // -&gt; 4kHz
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Hz
</span><span class="boring">from pyautd3.modulation import Sine, SineOption
</span>m = Sine(freq=150 * Hz, option=SineOption())
print(m.sampling_config().freq())  # -&gt; 4kHz
</code></pre>
</div></div>
<p>Additionally, some <code>Modulation</code> can optionally change the sampling configuration.</p>
<p>For more details on sampling configuration, refer to <a href="Users_Manual/API/./sampling_config.html">About Sampling Configuration</a>.</p>
<h3 id="finiteloop-1"><a class="header" href="#finiteloop-1">FiniteLoop</a></h3>
<p><code>Modulation</code> can control the behavior of loops.
The default is an infinite loop.</p>
<p>For more details, refer to <a href="Users_Manual/API/./segment.html">Segment/FiniteLoop</a>.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/modulation.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="static"><a class="header" href="#static">Static</a></h1>
<p>No modulation.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>Static { intensity: 0xFF };
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>Static(0xFF);
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp.Modulation;
</span>new Static(intensity: 0xFF);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Static
</span>Static(intensity=0xFF)
</code></pre>
</div></div>
<p>The intensity can be specified with <code>intensity</code>.
The default is as above.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/modulation/static.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="sine"><a class="header" href="#sine">Sine</a></h1>
<p><code>Modulation</code> to transform sound pressure into a sine wave.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>Sine {
    freq: 150 * Hz,
    option: SineOption {
        intensity: u8::MAX,
        offset: 0x80,
        phase: 0. * rad,
        clamp: false,
        sampling_config: SamplingConfig::FREQ_4K,
    },
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>Sine(150 * Hz, SineOption{
                   .intensity = 0xFF,
                   .offset = 0x80,
                   .phase = 0.0f * rad,
                   .clamp = false,
                   .sampling_config = SamplingConfig::freq_4k(),
               });
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Modulation;
</span><span class="boring">using static AUTD3Sharp.Units;
</span>new Sine(
    freq: 150u * Hz,
    option: new SineOption
    {
        Intensity = 0xFF,
        Offset = 0x80,
        Phase = 0f * rad,
        Clamp = false,
        SamplingConfig = SamplingConfig.Freq4K
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Hz, SamplingConfig, Sine, SineOption, rad
</span>Sine(
    freq=150 * Hz,
    option=SineOption(
        intensity=0xFF,
        offset=0x80,
        phase=0.0 * rad,
        clamp=False,
        sampling_config=SamplingConfig.FREQ_4K,
    ),
)
</code></pre>
</div></div>
<p><code>Sine</code> applies AM so that the waveform of the sound pressure becomes
<span class="katex-display fleqn"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">⌊</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3449em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">intensity</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">freq</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">phase</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">offset</span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">⌋</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span></span></span></span></span>
where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mord">⋅</span><span class="mclose">⌋</span></span></span></span> represents the floor function.</p>
<p>If <code>clamp</code> is <code>false</code>, it returns an error if <code>intensity, offset</code> are specified such that the above formula results in values outside the range of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">255</span><span class="mclose">]</span></span></span></span>.
To clamp values outside the range to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">255</span><span class="mclose">]</span></span></span></span> instead of returning an error, specify <code>true</code> for <code>clamp</code>.</p>
<p>The default values for these are as above.</p>
<h2 id="frequency-constraints"><a class="header" href="#frequency-constraints">Frequency Constraints</a></h2>
<p><code>Sine</code> is strict about frequency by default, and if a frequency that cannot be output due to the sampling frequency is specified, it returns an error.</p>
<p>In that case, you have to change the sampling settings or use <code>into_nearest</code> to modulate at the nearest frequency that can be output.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">    let _ = 
</span>Sine {
    freq: 150. * Hz,
    option: SineOption::default(),
}
.into_nearest();
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>Sine(150.0f * Hz, SineOption{}).into_nearest();
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp.Modulation;
</span><span class="boring">using static AUTD3Sharp.Units;
</span>new Sine(freq: 150.0f * Hz, option: new SineOption()).IntoNearest();
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Hz, Sine, SineOption
</span>Sine(freq=150.0 * Hz, option=SineOption()).into_nearest()
</code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/modulation/sine.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="fourier"><a class="header" href="#fourier">Fourier</a></h1>
<p><code>Modulation</code> that generates a waveform by superimposing multiple sine waves of different frequencies.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust">use autd3::modulation::{Fourier, FourierOption};
<span class="boring">use autd3::prelude::*;
</span>
<span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>Fourier {
    components: vec![
        Sine {
            freq: 100 * Hz,
            option: Default::default(),
        },
        Sine {
            freq: 150 * Hz,
            option: Default::default(),
        },
    ],
    option: FourierOption {
        scale_factor: None,
        clamp: false,
        offset: 0x00,
    },
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span>#include &lt;autd3/modulation/fourier.hpp&gt;

<span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>modulation::Fourier({Sine(100 * Hz, SineOption{}),
                     Sine(150 * Hz, SineOption{})},
                    modulation::FourierOption{
                        .scale_factor = std::nullopt,
                        .clamp = false,
                        .offset = 0x00,
                    });

<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs">using AUTD3Sharp.Modulation;

<span class="boring">using static AUTD3Sharp.Units;
</span>new Fourier(
    components: [
        new Sine(freq: 100u * Hz, option: new SineOption()),
        new Sine(freq: 150u * Hz, option: new SineOption())
    ],
    option: new FourierOption
    {
        ScaleFactor = null,
        Clamp = false,
        Offset = 0x00
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Hz, Sine, SineOption
</span>from pyautd3.modulation import Fourier, FourierOption

Fourier(
    components=[
        Sine(freq=100 * Hz, option=SineOption()),
        Sine(freq=150 * Hz, option=SineOption()),
    ],
    option=FourierOption(
        scale_factor=None,
        clamp=False,
        offset=0x00,
    ),
)
</code></pre>
</div></div>
<h2 id="scale-factor-and-value-clamping"><a class="header" href="#scale-factor-and-value-clamping">Scale Factor and Value Clamping</a></h2>
<p>The calculation of <code>Fourier</code> is performed using the following formula,
<span class="katex-display fleqn"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0277em;vertical-align:-1.2777em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">⌊</span></span><span class="mord text"><span class="mord">offset</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">scale_factor</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">components</span></span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">⌋</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">.</span></span></span></span></span>
If the scale factor is not specified, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/</span><span class="mord text"><span class="mord">number of components</span></span></span></span></span> is used.</p>
<p>If <code>clamp</code> is <code>false</code>, it returns an error if <code>intensity, offset</code> are specified such that the above formula results in values outside the range of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">255</span><span class="mclose">]</span></span></span></span>.
To clamp values outside the range to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">255</span><span class="mclose">]</span></span></span></span> instead of returning an error, specify <code>true</code> for <code>clamp</code>.</p>
<p>The default values for these are as above.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/modulation/fourier.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="square"><a class="header" href="#square">Square</a></h1>
<p><code>Modulation</code> in the form of a square wave.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>Square {
    freq: 150 * Hz,
    option: SquareOption {
        low: u8::MIN,
        high: u8::MAX,
        duty: 0.5,
        sampling_config: SamplingConfig::FREQ_4K,
    },
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>Square(150 * Hz, SquareOption{
                     .low = 0x00,
                     .high = 0xFF,
                     .duty = 0.5f,
                     .sampling_config = SamplingConfig::freq_4k(),
                 });
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Modulation;
</span><span class="boring">using static AUTD3Sharp.Units;
</span>new Square(
    freq: 150u * Hz,
    option: new SquareOption
    {
        Low = 0x00,
        High = 0xFF,
        Duty = 0.5f,
        SamplingConfig = SamplingConfig.Freq4K
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Hz, SamplingConfig, Square, SquareOption
</span>Square(
    freq=150 * Hz,
    option=SquareOption(
        low=0x00,
        high=0xFF,
        duty=0.5,
        sampling_config=SamplingConfig.FREQ_4K,
    ),
)
</code></pre>
</div></div>
<h2 id="frequency-constraints-1"><a class="header" href="#frequency-constraints-1">Frequency Constraints</a></h2>
<p><code>Square</code> is strict about frequency by default, and if a frequency that cannot be output due to the sampling frequency is specified, it returns an error.</p>
<p>In that case, you can change the sampling settings or use <code>into_nearest</code> to modulate at the nearest frequency that can be output.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>Square {
    freq: 150.0 * Hz,
    option: Default::default(),
}
.into_nearest();
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>Square(150.0f * Hz, SquareOption{}).into_nearest();
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp.Modulation;
</span><span class="boring">using static AUTD3Sharp.Units;
</span>new Square(freq: 150.0f * Hz, option: new SquareOption()).IntoNearest();
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Hz, Square, SquareOption
</span>Square(freq=150.0 * Hz, option=SquareOption()).into_nearest()
</code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/modulation/square.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="wav"><a class="header" href="#wav">Wav</a></h1>
<p><code>Wav</code> is a <code>Modulation</code> composed based on Wav files.</p>
<h2 id="install-6"><a class="header" href="#install-6">Install</a></h2>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C#-tab-0">C#</label><input id="Unity-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Unity-tab-0">Unity</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-shell">cargo add autd3-modulation-audio-file
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp name=CMakeLists.txt">target_link_libraries(&lt;TARGET&gt; PRIVATE autd3::modulation::audio_file)
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Unity-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<p>Included in the main library.</p>
</div></div>
<h2 id="apis-6"><a class="header" href="#apis-6">APIs</a></h2>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust">use autd3_modulation_audio_file::Wav;

<span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let _ = 
</span>Wav::new("path/to/foo.wav")?;
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span>#include "autd3/modulation/audio_file.hpp"

<span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>modulation::audio_file::Wav("path/to/foo.wav");
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs">using AUTD3Sharp.Modulation.AudioFile;

new Wav(path: "path/to/foo.wav");
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">import pathlib
</span>from pyautd3.modulation.audio_file import Wav

Wav(path=pathlib.Path("path/to/foo.wav"))
</code></pre>
</div></div>
<p>Wav data supports mono, 8, 16, 24, 32-bit integers and 32-bit floating point data formats.</p>
<p>Each data value <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> is converted to 8-bit unsigned integer modulation data through the following formulas.
<span class="katex-display fleqn"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">8bit int</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">128</span></span></span></span></span>
<span class="katex-display fleqn"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">16bit int</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">257</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">32768</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span>
<span class="katex-display fleqn"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">24bit int</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">65793</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">8388608</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span>
<span class="katex-display fleqn"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">32bit int</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">16843009</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2147483648</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span>
<span class="katex-display fleqn"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">32bit float</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">255</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span>
Here, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">⋅</span><span class="mclose">]</span></span></span></span> represents the nearest integer.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/modulation/wav.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="csv"><a class="header" href="#csv">Csv</a></h1>
<p><code>Csv</code> is a <code>Modulation</code> composed based on a Csv file.</p>
<h2 id="install-7"><a class="header" href="#install-7">Install</a></h2>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="C#-tab-0">C#</label><input id="Unity-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Unity-tab-0">Unity</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=5 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-shell">cargo add autd3-modulation-audio-file
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp name=CMakeLists.txt">target_link_libraries(&lt;TARGET&gt; PRIVATE autd3::modulation::audio_file)
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Unity-content>
<p>Included in the main library.</p>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<p>Included in the main library.</p>
</div></div>
<h2 id="apis-7"><a class="header" href="#apis-7">APIs</a></h2>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span>use autd3_modulation_audio_file::{Csv, CsvOption};

<span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>Csv::new(
    "path/to/foo.csv",
    4000.0 * Hz,
    CsvOption { delimiter: b',', has_headers: false },
);
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span>#include "autd3/modulation/audio_file.hpp"

<span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>const auto path = "path/to/foo.csv";
modulation::audio_file::Csv(path, 4000.0f * Hz,
                            modulation::audio_file::CsvOption{
                                .delimiter = ',',
                            });
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs">using AUTD3Sharp.Modulation.AudioFile;

<span class="boring">using static AUTD3Sharp.Units;
</span>new Csv(
    path: "path/to/foo.csv",
    samplingConfig: 4000f * Hz,
    option: new CsvOption
    {
        Delimiter = ',',
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">import pathlib
</span><span class="boring">from pyautd3 import Hz
</span>from pyautd3.modulation.audio_file import Csv, CsvOption

Csv(
    path=pathlib.Path("path/to/foo.csv"),
    sampling_config=4000.0 * Hz,
    option=CsvOption(
        delimiter=",",
    ),
)
</code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/modulation/csv.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="custom-1"><a class="header" href="#custom-1">Custom</a></h1>
<p><code>Custom</code> is a <code>Modulation</code> that outputs the specified unsigned 8-bit data sequence.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024">use autd3::modulation::Custom;

<span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>Custom {
    buffer: vec![0xFF, 0x00],
    sampling_config: 4.0 * kHz,
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;vector&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span>#include &lt;autd3/modulation/custom.hpp&gt;

<span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>modulation::Custom(std::vector&lt;uint8_t&gt;{0xFF, 0x00}, 4000.0f * Hz);
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using static AUTD3Sharp.Units;
</span>using AUTD3Sharp.Modulation;

new Custom(
    buffer: [0xFF, 0x00],
    samplingConfig: 4000f * Hz
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Hz
</span><span class="boring">import numpy as np
</span>from pyautd3.modulation import Custom

Custom(
    buffer=np.array([0xFF, 0x00]),
    sampling_config=4000.0 * Hz,
)
</code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/modulation/custom.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="radiationpressure"><a class="header" href="#radiationpressure">RadiationPressure</a></h1>
<p><code>RadiationPressure</code> is a <code>Modulation</code> that applies modulation to radiation pressure (proportional to the square of sound pressure) instead of sound pressure.</p>
<p>For example, when <code>RadiationPressure</code> is applied to a <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">kHz</span></span></span></span></span></span> <code>Sine</code> modulation, the radiation pressure of the sound pressure amplitude will be as follows, and the envelope of the radiation pressure will follow a <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">kHz</span></span></span></span></span></span> sine wave.</p>
<figure>
  <img src="Users_Manual/API/modulation/../../../fig/Users_Manual/sine_1k_mod_rad.png"/>
</figure>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust"><span class="boring">use autd3::prelude::*;
</span>use autd3::modulation::RadiationPressure;
 
<span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>RadiationPressure {
    target: Sine {
        freq: 150 * Hz,
        option: Default::default(),
    },
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span>#include &lt;autd3/modulation/radiation_pressure.hpp&gt;

<span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>modulation::RadiationPressure(Sine(150 * Hz, SineOption{}));
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs">using AUTD3Sharp.Modulation;
<span class="boring">using static AUTD3Sharp.Units;
</span>
new RadiationPressure(target: new Sine(freq: 150u * Hz, option: new SineOption()));
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Hz, Sine, SineOption
</span>from pyautd3.modulation import RadiationPressure

RadiationPressure(target=Sine(freq=150 * Hz, option=SineOption()))
</code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/modulation/radiation.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="fir"><a class="header" href="#fir">Fir</a></h1>
<p>You can apply an FIR filter using <code>Fir</code>.</p>
<p>Below is an example of applying an LPF with a sampling frequency of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord">20</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">kHz</span></span></span></span></span></span>, 199 taps, and a cutoff frequency of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord">200</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">Hz</span></span></span></span></span></span>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span>use autd3::modulation::Fir;

<span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let _ = 
</span>Fir {
    target: Sine {
        freq: 150. * Hz,
        option: SineOption {
            sampling_config: SamplingConfig::new(20.0 * kHz),
            ..Default::default()
        },
    },
    coef: vec![
        -0.000009, -0.000013, -0.000016, -0.000021, -0.000025, -0.000030, -0.000036,
        -0.000042, -0.000049, -0.000056, -0.000064, -0.000072, -0.000080, -0.000088,
        -0.000096, -0.000105, -0.000113, -0.000120, -0.000128, -0.000134, -0.000139,
        -0.000143, -0.000146, -0.000146, -0.000145, -0.000141, -0.000135, -0.000124,
        -0.000111, -0.000093, -0.000071, -0.000044, -0.000012, 0.000026, 0.000071,
        0.000122, 0.000180, 0.000247, 0.000321, 0.000405, 0.000497, 0.000599, 0.000712,
        0.000835, 0.000968, 0.001113, 0.001270, 0.001439, 0.001619, 0.001812, 0.002018,
        0.002236, 0.002467, 0.002711, 0.002968, 0.003237, 0.003518, 0.003812, 0.004118,
        0.004435, 0.004764, 0.005103, 0.005452, 0.005811, 0.006178, 0.006554, 0.006937,
        0.007326, 0.007720, 0.008119, 0.008521, 0.008925, 0.009331, 0.009737, 0.010141,
        0.010543, 0.010941, 0.011335, 0.011722, 0.012101, 0.012472, 0.012833, 0.013183,
        0.013520, 0.013843, 0.014152, 0.014445, 0.014720, 0.014978, 0.015217, 0.015435,
        0.015633, 0.015810, 0.015964, 0.016096, 0.016204, 0.016289, 0.016350, 0.016386,
        0.016399, 0.016386, 0.016350, 0.016289, 0.016204, 0.016096, 0.015964, 0.015810,
        0.015633, 0.015435, 0.015217, 0.014978, 0.014720, 0.014445, 0.014152, 0.013843,
        0.013520, 0.013183, 0.012833, 0.012472, 0.012101, 0.011722, 0.011335, 0.010941,
        0.010543, 0.010141, 0.009737, 0.009331, 0.008925, 0.008521, 0.008119, 0.007720,
        0.007326, 0.006937, 0.006554, 0.006178, 0.005811, 0.005452, 0.005103, 0.004764,
        0.004435, 0.004118, 0.003812, 0.003518, 0.003237, 0.002968, 0.002711, 0.002467,
        0.002236, 0.002018, 0.001812, 0.001619, 0.001439, 0.001270, 0.001113, 0.000968,
        0.000835, 0.000712, 0.000599, 0.000497, 0.000405, 0.000321, 0.000247, 0.000180,
        0.000122, 0.000071, 0.000026, -0.000012, -0.000044, -0.000071, -0.000093,
        -0.000111, -0.000124, -0.000135, -0.000141, -0.000145, -0.000146, -0.000146,
        -0.000143, -0.000139, -0.000134, -0.000128, -0.000120, -0.000113, -0.000105,
        -0.000096, -0.000088, -0.000080, -0.000072, -0.000064, -0.000056, -0.000049,
        -0.000042, -0.000036, -0.000030, -0.000025, -0.000021, -0.000016, -0.000013,
        -0.000009,
    ],
};
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span>#include &lt;autd3/modulation/fir.hpp&gt;

<span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>modulation::Fir(
    Sine(150 * Hz,
         SineOption{
             .sampling_config = SamplingConfig(20.0f * kHz),
         }),
    std::vector{
        -0.000009f, -0.000013f, -0.000016f, -0.000021f, -0.000025f, -0.000030f,
        -0.000036f, -0.000042f, -0.000049f, -0.000056f, -0.000064f, -0.000072f,
        -0.000080f, -0.000088f, -0.000096f, -0.000105f, -0.000113f, -0.000120f,
        -0.000128f, -0.000134f, -0.000139f, -0.000143f, -0.000146f, -0.000146f,
        -0.000145f, -0.000141f, -0.000135f, -0.000124f, -0.000111f, -0.000093f,
        -0.000071f, -0.000044f, -0.000012f, 0.000026f,  0.000071f,  0.000122f,
        0.000180f,  0.000247f,  0.000321f,  0.000405f,  0.000497f,  0.000599f,
        0.000712f,  0.000835f,  0.000968f,  0.001113f,  0.001270f,  0.001439f,
        0.001619f,  0.001812f,  0.002018f,  0.002236f,  0.002467f,  0.002711f,
        0.002968f,  0.003237f,  0.003518f,  0.003812f,  0.004118f,  0.004435f,
        0.004764f,  0.005103f,  0.005452f,  0.005811f,  0.006178f,  0.006554f,
        0.006937f,  0.007326f,  0.007720f,  0.008119f,  0.008521f,  0.008925f,
        0.009331f,  0.009737f,  0.010141f,  0.010543f,  0.010941f,  0.011335f,
        0.011722f,  0.012101f,  0.012472f,  0.012833f,  0.013183f,  0.013520f,
        0.013843f,  0.014152f,  0.014445f,  0.014720f,  0.014978f,  0.015217f,
        0.015435f,  0.015633f,  0.015810f,  0.015964f,  0.016096f,  0.016204f,
        0.016289f,  0.016350f,  0.016386f,  0.016399f,  0.016386f,  0.016350f,
        0.016289f,  0.016204f,  0.016096f,  0.015964f,  0.015810f,  0.015633f,
        0.015435f,  0.015217f,  0.014978f,  0.014720f,  0.014445f,  0.014152f,
        0.013843f,  0.013520f,  0.013183f,  0.012833f,  0.012472f,  0.012101f,
        0.011722f,  0.011335f,  0.010941f,  0.010543f,  0.010141f,  0.009737f,
        0.009331f,  0.008925f,  0.008521f,  0.008119f,  0.007720f,  0.007326f,
        0.006937f,  0.006554f,  0.006178f,  0.005811f,  0.005452f,  0.005103f,
        0.004764f,  0.004435f,  0.004118f,  0.003812f,  0.003518f,  0.003237f,
        0.002968f,  0.002711f,  0.002467f,  0.002236f,  0.002018f,  0.001812f,
        0.001619f,  0.001439f,  0.001270f,  0.001113f,  0.000968f,  0.000835f,
        0.000712f,  0.000599f,  0.000497f,  0.000405f,  0.000321f,  0.000247f,
        0.000180f,  0.000122f,  0.000071f,  0.000026f,  -0.000012f, -0.000044f,
        -0.000071f, -0.000093f, -0.000111f, -0.000124f, -0.000135f, -0.000141f,
        -0.000145f, -0.000146f, -0.000146f, -0.000143f, -0.000139f, -0.000134f,
        -0.000128f, -0.000120f, -0.000113f, -0.000105f, -0.000096f, -0.000088f,
        -0.000080f, -0.000072f, -0.000064f, -0.000056f, -0.000049f, -0.000042f,
        -0.000036f, -0.000030f, -0.000025f, -0.000021f, -0.000016f, -0.000013f,
        -0.000009f});
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span>using AUTD3Sharp.Modulation;
<span class="boring">using static AUTD3Sharp.Units;
</span>
new Fir(
    target: new Sine(freq: 150u * Hz, option: new SineOption
    {
        SamplingConfig = new SamplingConfig(20f * kHz)
    }),
    coef: [-0.000009f, -0.000013f, -0.000016f, -0.000021f, -0.000025f,
            -0.000030f, -0.000036f, -0.000042f, -0.000049f, -0.000056f,
            -0.000064f, -0.000072f, -0.000080f, -0.000088f, -0.000096f,
            -0.000105f, -0.000113f, -0.000120f, -0.000128f, -0.000134f,
            -0.000139f, -0.000143f, -0.000146f, -0.000146f, -0.000145f,
            -0.000141f, -0.000135f, -0.000124f, -0.000111f, -0.000093f,
            -0.000071f, -0.000044f, -0.000012f, 0.000026f,  0.000071f,
            0.000122f,  0.000180f,  0.000247f,  0.000321f,  0.000405f,
            0.000497f,  0.000599f,  0.000712f,  0.000835f,  0.000968f,
            0.001113f,  0.001270f,  0.001439f,  0.001619f,  0.001812f,
            0.002018f,  0.002236f,  0.002467f,  0.002711f,  0.002968f,
            0.003237f,  0.003518f,  0.003812f,  0.004118f,  0.004435f,
            0.004764f,  0.005103f,  0.005452f,  0.005811f,  0.006178f,
            0.006554f,  0.006937f,  0.007326f,  0.007720f,  0.008119f,
            0.008521f,  0.008925f,  0.009331f,  0.009737f,  0.010141f,
            0.010543f,  0.010941f,  0.011335f,  0.011722f,  0.012101f,
            0.012472f,  0.012833f,  0.013183f,  0.013520f,  0.013843f,
            0.014152f,  0.014445f,  0.014720f,  0.014978f,  0.015217f,
            0.015435f,  0.015633f,  0.015810f,  0.015964f,  0.016096f,
            0.016204f,  0.016289f,  0.016350f,  0.016386f,  0.016399f,
            0.016386f,  0.016350f,  0.016289f,  0.016204f,  0.016096f,
            0.015964f,  0.015810f,  0.015633f,  0.015435f,  0.015217f,
            0.014978f,  0.014720f,  0.014445f,  0.014152f,  0.013843f,
            0.013520f,  0.013183f,  0.012833f,  0.012472f,  0.012101f,
            0.011722f,  0.011335f,  0.010941f,  0.010543f,  0.010141f,
            0.009737f,  0.009331f,  0.008925f,  0.008521f,  0.008119f,
            0.007720f,  0.007326f,  0.006937f,  0.006554f,  0.006178f,
            0.005811f,  0.005452f,  0.005103f,  0.004764f,  0.004435f,
            0.004118f,  0.003812f,  0.003518f,  0.003237f,  0.002968f,
            0.002711f,  0.002467f,  0.002236f,  0.002018f,  0.001812f,
            0.001619f,  0.001439f,  0.001270f,  0.001113f,  0.000968f,
            0.000835f,  0.000712f,  0.000599f,  0.000497f,  0.000405f,
            0.000321f,  0.000247f,  0.000180f,  0.000122f,  0.000071f,
            0.000026f,  -0.000012f, -0.000044f, -0.000071f, -0.000093f,
            -0.000111f, -0.000124f, -0.000135f, -0.000141f, -0.000145f,
            -0.000146f, -0.000146f, -0.000143f, -0.000139f, -0.000134f,
            -0.000128f, -0.000120f, -0.000113f, -0.000105f, -0.000096f,
            -0.000088f, -0.000080f, -0.000072f, -0.000064f, -0.000056f,
            -0.000049f, -0.000042f, -0.000036f, -0.000030f, -0.000025f,
            -0.000021f, -0.000016f, -0.000013f, -0.000009f]
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Hz, Sine, SineOption, kHz, SamplingConfig
</span>from pyautd3.modulation import Fir

Fir(
    target=Sine(
        freq=150 * Hz,
        option=SineOption(
            sampling_config=SamplingConfig(20.0 * kHz),
        ),
    ),
    coef=[
        -0.000009, -0.000013, -0.000016, -0.000021, -0.000025, -0.000030, -0.000036,
        -0.000042, -0.000049, -0.000056, -0.000064, -0.000072, -0.000080, -0.000088,
        -0.000096, -0.000105, -0.000113, -0.000120, -0.000128, -0.000134, -0.000139,
        -0.000143, -0.000146, -0.000146, -0.000145, -0.000141, -0.000135, -0.000124,
        -0.000111, -0.000093, -0.000071, -0.000044, -0.000012, 0.000026, 0.000071,
        0.000122, 0.000180, 0.000247, 0.000321, 0.000405, 0.000497, 0.000599, 0.000712,
        0.000835, 0.000968, 0.001113, 0.001270, 0.001439, 0.001619, 0.001812, 0.002018,
        0.002236, 0.002467, 0.002711, 0.002968, 0.003237, 0.003518, 0.003812, 0.004118,
        0.004435, 0.004764, 0.005103, 0.005452, 0.005811, 0.006178, 0.006554, 0.006937,
        0.007326, 0.007720, 0.008119, 0.008521, 0.008925, 0.009331, 0.009737, 0.010141,
        0.010543, 0.010941, 0.011335, 0.011722, 0.012101, 0.012472, 0.012833, 0.013183,
        0.013520, 0.013843, 0.014152, 0.014445, 0.014720, 0.014978, 0.015217, 0.015435,
        0.015633, 0.015810, 0.015964, 0.016096, 0.016204, 0.016289, 0.016350, 0.016386,
        0.016399, 0.016386, 0.016350, 0.016289, 0.016204, 0.016096, 0.015964, 0.015810,
        0.015633, 0.015435, 0.015217, 0.014978, 0.014720, 0.014445, 0.014152, 0.013843,
        0.013520, 0.013183, 0.012833, 0.012472, 0.012101, 0.011722, 0.011335, 0.010941,
        0.010543, 0.010141, 0.009737, 0.009331, 0.008925, 0.008521, 0.008119, 0.007720,
        0.007326, 0.006937, 0.006554, 0.006178, 0.005811, 0.005452, 0.005103, 0.004764,
        0.004435, 0.004118, 0.003812, 0.003518, 0.003237, 0.002968, 0.002711, 0.002467,
        0.002236, 0.002018, 0.001812, 0.001619, 0.001439, 0.001270, 0.001113, 0.000968,
        0.000835, 0.000712, 0.000599, 0.000497, 0.000405, 0.000321, 0.000247, 0.000180,
        0.000122, 0.000071, 0.000026, -0.000012, -0.000044, -0.000071, -0.000093,
        -0.000111, -0.000124, -0.000135, -0.000141, -0.000145, -0.000146, -0.000146,
        -0.000143, -0.000139, -0.000134, -0.000128, -0.000120, -0.000113, -0.000105,
        -0.000096, -0.000088, -0.000080, -0.000072, -0.000064, -0.000056, -0.000049,
        -0.000042, -0.000036, -0.000030, -0.000025, -0.000021, -0.000016, -0.000013,
        -0.000009,
    ],
)
</code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/modulation/fir.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="about-sampling-configuration"><a class="header" href="#about-sampling-configuration">About Sampling Configuration</a></h1>
<p>This section explains the sampling configuration for Modulation and FociSTM/GainSTM.</p>
<p>The sampling frequency is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord">40</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">kHz</span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>, where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> is a 16-bit unsigned integer greater than 0.</p>
<p>Additionally, the maximum sampling frequency that can be specified is determined by the Silencer settings.
For more details, refer to <a href="Users_Manual/API/./silencer.html#fixed-completion-steps-mode">Silencer</a>.</p>
<p>The constructor for the sampling configuration can specify the division ratio <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>, the sampling frequency, or the sampling period.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use std::num::NonZeroU16;
</span><span class="boring">use std::time::Duration;
</span><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span><span class="boring">let _ = 
</span>SamplingConfig::new(NonZeroU16::new(10).unwrap());
// or
<span class="boring">let _ = 
</span>SamplingConfig::new(4000.0 * Hz);
// or
<span class="boring">let _ = 
</span>SamplingConfig::new(Duration::from_micros(250));
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;chrono&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>SamplingConfig(10);
// or
SamplingConfig(4000.0f * Hz);
// or
SamplingConfig(std::chrono::microseconds(250));
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using static AUTD3Sharp.Units;
</span>new SamplingConfig(10);
// or
new SamplingConfig(4000f * Hz);
// or
new SamplingConfig(Duration.FromMicros(250));
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Duration, Hz, SamplingConfig
</span>SamplingConfig(10)
# or
SamplingConfig(4000.0 * Hz)
# or
SamplingConfig(Duration.from_micros(250))
</code></pre>
</div></div>
<h2 id="relaxation-of-sampling-frequency-limits"><a class="header" href="#relaxation-of-sampling-frequency-limits">Relaxation of Sampling Frequency Limits</a></h2>
<p><strong>Not recommended for use</strong>, but there is a method to use the frequency/period closest to the specified value within the possible output frequencies/periods.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use std::time::Duration;
</span><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>SamplingConfig::new(4000.0 * Hz).into_nearest();
// or
<span class="boring">let _ = 
</span>SamplingConfig::new(Duration::from_micros(250)).into_nearest();
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;chrono&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">const auto s =
</span>SamplingConfig(4000.0f * Hz).into_nearest();
// or
<span class="boring">const auto sp =
</span>SamplingConfig(std::chrono::microseconds(250)).into_nearest();
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Modulation;
</span><span class="boring">using static AUTD3Sharp.Units;
</span>new SamplingConfig(4000.0f * Hz).IntoNearest();
// or
new SamplingConfig(Duration.FromMicros(250)).IntoNearest();
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Duration, Hz, SamplingConfig
</span>SamplingConfig(4000.0 * Hz).into_nearest()
# or
SamplingConfig(Duration.from_micros(250)).into_nearest()
</code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/sampling_config.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="segmentfiniteloop"><a class="header" href="#segmentfiniteloop">Segment/FiniteLoop</a></h1>
<h2 id="segment"><a class="header" href="#segment">Segment</a></h2>
<p>The data areas of <code>Modulation</code>, <code>Gain</code>, <code>FociSTM</code>, and <code>GainSTM</code> each have two <code>Segments</code>.</p>
<p>Unless otherwise specified, <code>Segment::S0</code> is used.</p>
<p>The <code>Segment</code> to which data is written is specified with <code>WithSegment</code>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>WithSegment {
    inner: Static::default(),
    segment: Segment::S1,
    transition_mode: transition_mode::Immediate,
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>WithSegment(Static{}, Segment::S1, transition_mode::Immediate());
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.TransitionMode;
</span><span class="boring">using AUTD3Sharp.Modulation;
</span>new WithSegment(
    inner: new Static(),
    segment: Segment.S1,
    transitionMode: new Immediate()
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Segment, Static, transition_mode, WithSegment
</span>WithSegment(
    inner=Static(),
    segment=Segment.S1,
    transition_mode=transition_mode.Immediate(),
)
</code></pre>
</div></div>
<p>The <code>transition_mode</code> specifies the conditions for switching <code>Segments</code>.</p>
<ul>
<li>
<p>Only available when the destination segment is in an infinite loop</p>
<ul>
<li><code>Immediate</code>: Switch immediately</li>
<li><code>Ext</code>: Switch immediately and enter extended mode (automatically switch segments after outputting data from each <code>Segment</code>)</li>
</ul>
</li>
<li>
<p>Only available when the destination segment is in a finite loop</p>
<ul>
<li><code>SyncIdx</code>: Switch when the data index of the destination <code>Segment</code> becomes <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></li>
<li><code>SysTime(DcSysTime)</code>: Switch at the specified time</li>
<li><code>GPIO(GPIOIn)</code>: Switch when a signal is input to the specified GPIO pin</li>
</ul>
</li>
</ul>
<blockquote>
<p>NOTE: <code>Gain</code> only supports <code>Immediate</code>.</p>
</blockquote>
<blockquote>
<p>To specify the loop behavior of the destination loop, refer to <a href="Users_Manual/API/segment.html#finiteloop"><code>FiniteLoop</code></a>.</p>
</blockquote>
<p>To write data without switching <code>Segments</code>, specify <code>Later</code> for <code>transition_mode</code>.</p>
<h3 id="switching-segments"><a class="header" href="#switching-segments">Switching Segments</a></h3>
<p>To switch <code>Segments</code> only, use <code>SwapSegment</code>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span>SwapSegmentModulation(Segment::S1, transition_mode::Immediate);
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>SwapSegmentModulation(Segment::S1, transition_mode::Immediate());
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.TransitionMode;
</span>SwapSegment.Modulation(Segment.S1, new Immediate());
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Segment, SwapSegmentModulation, transition_mode
</span>SwapSegmentModulation(Segment.S1, transition_mode.Immediate())
</code></pre>
</div></div>
<h3 id="finiteloop-2"><a class="header" href="#finiteloop-2">FiniteLoop</a></h3>
<p><code>Modulation</code>, <code>FociSTM</code>, and <code>GainSTM</code> can control loop behavior with <code>WithFiniteLoop</code>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-2">Rust</label><input id="C++-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-2">C++</label><input id="C#-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-2">C#</label><input id="Python-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-2">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use std::num::NonZeroU16;
</span><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>WithFiniteLoop {
    inner: Static::default(),
    loop_count: NonZeroU16::new(1).unwrap(),
    segment: Segment::S1,
    transition_mode: transition_mode::SyncIdx,
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>WithFiniteLoop(Static{}, 1, Segment::S1, transition_mode::SyncIdx());
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.TransitionMode;
</span><span class="boring">using AUTD3Sharp.Modulation;
</span>new WithFiniteLoop(
    inner: new Static(),
    loopCount: 1,
    segment: Segment.S1,
    transitionMode: new SyncIdx()
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Segment, Static, transition_mode, WithFiniteLoop
</span>
WithFiniteLoop(
    inner=Static(),
    loop_count=1,
    segment=Segment.S1,
    transition_mode=transition_mode.SyncIdx(),
)
</code></pre>
</div></div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/segment.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="silencer"><a class="header" href="#silencer">Silencer</a></h1>
<p>AUTD3 provides a Silencer to reduce noise of the output.
The Silencer suppresses sudden changes in the drive signal of the transducers, making it quieter.</p>
<ul>
<li><a href="Users_Manual/API/silencer.html#theory">Theory</a></li>
<li><a href="Users_Manual/API/silencer.html#silencer-settings">Silencer Settings</a>
<ul>
<li><a href="Users_Manual/API/silencer.html#fixed-update-rate-mode">Fixed update rate mode</a></li>
<li><a href="Users_Manual/API/silencer.html#fixed-completion-time-mode">Fixed completion time mode</a></li>
</ul>
</li>
</ul>
<h2 id="theory"><a class="header" href="#theory">Theory</a></h2>
<p>For details, refer to the paper by Suzuki et al.<sup class="footnote-reference"><a href="#suzuki2020">1</a></sup>.</p>
<p>In summary,</p>
<ul>
<li>Amplitude-modulated ultrasound generates audible sound.</li>
<li>When driving ultrasonic transducers, phase changes cause amplitude fluctuations.
<ul>
<li>Therefore, audible noise is generated.</li>
</ul>
</li>
<li>By linearly interpolating phase changes and gradually changing them, amplitude fluctuations can be suppressed.
<ul>
<li>Therefore, noise can be reduced.</li>
</ul>
</li>
<li>The finer the interpolation, the smaller the noise.</li>
</ul>
<h2 id="silencer-settings"><a class="header" href="#silencer-settings">Silencer Settings</a></h2>
<p>To configure the Silencer, send <code>Silencer</code>.</p>
<p>The Silencer is set to appropriate values by default.
To disable the Silencer, send <code>disable</code>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>Silencer::default();
<span class="boring">let _ = 
</span>Silencer::disable();
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>Silencer();
Silencer::disable();
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span>new Silencer();
Silencer.Disable();
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Silencer
</span>Silencer()
Silencer.disable()
</code></pre>
</div></div>
<p>For finer settings, you need to choose between the following two modes:</p>
<ul>
<li><a href="Users_Manual/API/silencer.html#fixed-update-rate-mode">Fixed update rate mode</a></li>
<li><a href="Users_Manual/API/silencer.html#fixed-completion-time-mode">Fixed completion time mode</a></li>
</ul>
<p>By default, it is set to Fixed completion time mode.</p>
<h3 id="fixed-update-rate-mode"><a class="header" href="#fixed-update-rate-mode">Fixed update rate mode</a></h3>
<h4 id="phase-change-in-fixed-update-rate-mode"><a class="header" href="#phase-change-in-fixed-update-rate-mode">Phase Change in Fixed update rate mode</a></h4>
<p>In this mode, the Silencer linearly interpolates and gradually changes the phase <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> to reduce noise.
In other words, it is almost equivalent to passing the time series data of phase <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> through a moving average filter.
However, it differs in that it considers the periodicity of the phase data.</p>
<p>For example, consider the case where the period <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> of ultrasound is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span></span></span></span>. That is, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> corresponds to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">rad</span></span></span></span></span>, and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span></span></span></span> corresponds to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">rad</span></span></span></span></span>.
Here, suppose the phase changes from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">6</span></span></span></span> at time <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.
In this case, the phase change by the Silencer will be as shown in the following figure.</p>
<figure>
  <img src="Users_Manual/API/../../fig/Users_Manual/silent/phase.svg"/>
<figcaption>Phase <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> change</figcaption>
</figure>
<p>On the other hand, suppose the phase changes from <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span> at time <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.
In this case, the phase change by the Silencer will be as shown in the following figure.
This is because <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">2</span></span></span></span> is closer than <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">10</span></span></span></span>.</p>
<figure>
  <img src="Users_Manual/API/../../fig/Users_Manual/silent/phase2.svg"/>
<figcaption>Phase <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> change (when the phase change amount is greater than <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span>)</figcaption>
</figure>
<p>In other words, the Silencer updates the phase <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> as follows for the current <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> and target value <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>:
<span class="katex-display fleqn"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathrm">sign</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord">∣</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Δ</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathrm">sign</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord">∣</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Δ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if </span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord">/2</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">(otherwise)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span></span></span></span></span>
where <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span></span></span></span> represents the update amount per step (<code>step</code> of <code>Silencer</code>).
The update frequency is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord"><span class="mord"><span class="mord">40</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">kHz</span></span></span></span></span></span></span>.</p>
<p>The smaller <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span></span></span></span> is, the smoother the phase change and the more noise is suppressed.</p>
<figure>
  <img src="Users_Manual/API/../../fig/Users_Manual/silent/duty.svg"/>
<figcaption>Difference in changes due to <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span></span></span></span></figcaption>
</figure>
<p>Due to the nature of this implementation, it may behave differently from a moving average filter.
One case is when the phase change amount is greater than <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span>, as shown above, and another case is when the phase changes again in the middle.
An example of phase change in the second case is shown below.
From the perspective of fidelity to the original time series, the moving average filter is correct, but considering the phase change amount greater than <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span> or making <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span></span></span></span> variable (i.e., making the filter length variable) is difficult, so the current implementation is adopted.</p>
<figure>
  <img src="Users_Manual/API/../../fig/Users_Manual/silent/mean.svg"/>
<figcaption>Comparison with moving average filter</figcaption>
</figure>
<h4 id="amplitude-change-in-fixed-update-rate-mode"><a class="header" href="#amplitude-change-in-fixed-update-rate-mode">Amplitude Change in Fixed update rate mode</a></h4>
<p>Since amplitude fluctuations cause noise, applying the same filter to the intensity parameter <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> can suppress noise due to AM.</p>
<p>Unlike phase, the intensity parameter <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> is not periodic, so it is updated as follows for the current <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> and target value <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>:
<span class="katex-display fleqn"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">sign</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord">∣</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">Δ</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span></p>
<h4 id="setting-fixed-update-rate-mode"><a class="header" href="#setting-fixed-update-rate-mode">Setting Fixed update rate mode</a></h4>
<p>To set Fixed update rate mode, do as follows.
The arguments correspond to the aforementioned <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span></span></span></span> (unit is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord">/65536</span></span></span></span>).</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-1">Rust</label><input id="C++-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-1">C++</label><input id="C#-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-1">C#</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">use std::num::NonZeroU16;
</span><span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>Silencer {
    config: FixedUpdateRate {
        intensity: NonZeroU16::MIN,
        phase: NonZeroU16::MIN,
    },
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>Silencer{FixedUpdateRate{.intensity = 1, .phase = 1}};
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span>new Silencer(
    config: new FixedUpdateRate
    {
        Intensity = 1,
        Phase = 1
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Silencer, FixedUpdateRate
</span>Silencer(
    config=FixedUpdateRate(
        intensity=1,
        phase=1,
    ),
)
</code></pre>
</div></div>
<h3 id="fixed-completion-time-mode"><a class="header" href="#fixed-completion-time-mode">Fixed completion time mode</a></h3>
<p>In this mode, phase/intensity changes are completed within a fixed time.</p>
<h4 id="setting-fixed-completion-time-mode"><a class="header" href="#setting-fixed-completion-time-mode">Setting Fixed completion time mode</a></h4>
<p>To set Fixed completion time mode, do as follows.</p>
<p><code>intensity</code> and <code>phase</code> correspond to the completion time of intensity/phase changes, respectively.
These must be integer multiples of the ultrasound period (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">25</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">us</span></span></span></span></span></span>).</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-2">Rust</label><input id="C++-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-2">C++</label><input id="C#-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-2">C#</label><input id="Python-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-2">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">use std::time::Duration;
</span><span class="boring">fn main() {
</span><span class="boring">let _ = 
</span>Silencer {
    config: FixedCompletionTime {
        intensity: Duration::from_micros(250),
        phase: Duration::from_micros(250),
        strict: true,
    },
};
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;chrono&gt;
</span><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>Silencer{FixedCompletionTime{.intensity = std::chrono::microseconds(250),
                             .phase = std::chrono::microseconds(250),
                             .strict = true}};
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span>new Silencer(
    config: new FixedCompletionTime
    {
        Intensity = Duration.FromMicros(250),
        Phase = Duration.FromMicros(250),
        Strict = true
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Duration, FixedCompletionTime, Silencer
</span>Silencer(
    config=FixedCompletionTime(
        intensity=Duration.from_micros(250),
        phase=Duration.from_micros(250),
        strict=True,
    ),
)
</code></pre>
</div></div>
<p>The default values are <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">ms</span></span></span></span></span></span> for phase changes and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">0.25</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">ms</span></span></span></span></span></span> for intensity changes.
Disabling the Silencer is equivalent to completing phase/intensity changes within the ultrasound period (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">25</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">us</span></span></span></span></span></span>).</p>
<p>In this mode, an error is returned if the phase/intensity changes specified by <code>Modulation</code>, <code>FociSTM</code>, or <code>GainSTM</code> cannot be completed within the time specified by the Silencer.
Therefore, the following conditions must be met:</p>
<ul>
<li>Silencer intensity change completion time <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span></span></span></span> <code>Modulation</code> sampling period</li>
<li>Silencer intensity change completion time <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span></span></span></span> <code>FociSTM</code>/<code>GainSTM</code> sampling period</li>
<li>Silencer phase change completion time <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">≤</span></span></span></span> <code>FociSTM</code>/<code>GainSTM</code> sampling period</li>
</ul>
<p>If <code>strict</code> is set to <code>false</code>, no error is returned even if these conditions are not met, but it is not recommended.</p>
<div class="footnote-definition" id="suzuki2020"><sup class="footnote-definition-label">1</sup>
<p>Suzuki, Shun, et al. “Reducing amplitude fluctuation by gradual phase shift in midair ultrasound haptics.” IEEE transactions on haptics 13.1 (2020): 87-93.</p>
</div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/silencer.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="phase-correction"><a class="header" href="#phase-correction">Phase Correction</a></h1>
<p><code>PhaseCorrection</code> allows you to correct the phase.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ =
</span>PhaseCorrection::new(|_dev| |_tr| Phase::ZERO);
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>PhaseCorrection([](const auto&amp;) {
  return [](const auto&amp;) { return Phase::zero(); };
});
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Utils;
</span>new PhaseCorrection(_dev =&gt; _tr =&gt; Phase.Zero);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Phase, PhaseCorrection
</span>PhaseCorrection(lambda _dev: lambda _tr: Phase.ZERO)
</code></pre>
</div></div>
<p>The constructor argument for <code>PhaseCorrection</code> is <code>Fn(&amp;Device) -&gt; Fn(&amp;Transducer) -&gt; Phase</code>, which specifies the phase value for each transducer to be added to the values of <code>Gain</code>, <code>FociSTM</code>, and <code>GainSTM</code>.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/phase_corr.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="output-mask"><a class="header" href="#output-mask">Output mask</a></h1>
<blockquote>
<p>NOTE: Available since firmware v12.1.0</p>
</blockquote>
<p><code>OutputMask</code> can be sent to stop the output of each transducer regardless of the <code>Intensity</code> values of <code>Gain</code>, <code>FociSTM</code>, and <code>GainSTM</code>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ =
</span>OutputMask::new(|_dev| |_tr| false);
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>OutputMask([](const auto&amp;) { return [](const auto&amp;) { return false; }; });
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span>new OutputMask(_dev =&gt; _tr =&gt; false);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import OutputMask
</span>OutputMask(lambda _dev: lambda _tr: False)
</code></pre>
</div></div>
<p>The constructor argument for <code>OutputMask</code> is <code>Fn(&amp;Device) -&gt; Fn(&amp;Transducer) -&gt; bool</code> and the output of transducers set to <code>false</code> will be disabled.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/output_mask.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="intensity-and-pulse-width"><a class="header" href="#intensity-and-pulse-width">Intensity and Pulse Width</a></h1>
<p>There is a nonlinear relationship between the duty ratio of the PWM signal and the ultrasound output.
To correct this relationship, you can use <code>PulseWidthEncoder</code>.</p>
<p>Inside the firmware, there is a table that determines the pulse width (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>–<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">511</span></span></span></span>) of the PWM signal using the value (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>–<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">255</span></span></span></span>) obtained by multiplying the <code>Intensity</code> data of <code>Gain</code>/<code>FociSTM</code>/<code>GainSTM</code> by the data of <code>Modulation</code> (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>–<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">255</span></span></span></span>) and dividing by <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">255</span></span></span></span>.
This table can be modified by <code>PulseWidthEncoder</code>.
Note that the period of the PWM signal is 256 for firmware v10 and 512 for v11 and later.</p>
<p>By default, to make the intensity value and ultrasound output (theoretically) linear,
<span class="katex-display fleqn"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">table</span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mop"><span class="mop">sin</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8719em;"><span style="top:-3.1208em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3365em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">255</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span>
is written to the table.
Here, <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span> is the period and <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">⋅</span><span class="mclose">]</span></span></span></span> represents the nearest integer.</p>
<p>For example, if you send the following <code>PulseWidthEncoder</code>, the relationship between the intensity value and the pulse width will be linear (i.e., the intensity value and ultrasound output will be nonlinear).</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ =
</span>PulseWidthEncoder::new(|_dev| |i| PulseWidth::from_duty(i.0 as f32 / 510.0).unwrap());
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">#include&lt;autd3/link/nop.hpp&gt;
</span><span class="boring">#include&lt;vector&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">auto autd =
</span><span class="boring">Controller::open({AUTD3{}}, link::Nop{});
</span>PulseWidthEncoder([](const auto&amp; dev) {
  return [](const auto i) {
    return PulseWidth::from_duty(static_cast&lt;float&gt;(i.value()) / 510.0f);
  };
});
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span>new PulseWidthEncoder(_dev =&gt; i =&gt; PulseWidth.FromDuty((float)i.Item1 / 510.0f));
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import PulseWidthEncoder, PulseWidth
</span>PulseWidthEncoder(lambda _dev: lambda i: PulseWidth.from_duty(i.value / 510.0))
</code></pre>
</div></div>
<p>The constructor argument is a function <code>Fn(&amp;Device) -&gt; Fn(Intensity) -&gt; PulseWidth</code> that returns a function that returns the pulse width for each device using the table index as an argument.</p>
<blockquote>
<p>NOTE: Support for firmware v10 is only available in the Rust version.</p>
</blockquote>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/pulse_width_encoder.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="gpiooutputs"><a class="header" href="#gpiooutputs">GPIOOutputs</a></h1>
<p><code>GPIOOutputs</code> allows you to set the output of GPIO output pins for each device.</p>
<figure>
    <img src="Users_Manual/API/../../fig/Users_Manual/gpio_pin.jpg"/>
    <figcaption>GPIO pins</figcaption>
</figure>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ =
</span>GPIOOutputs::new(|_dev, gpio| {
    if gpio == GPIOOut::O0 {
        Some(GPIOOutputType::BaseSignal)
    } else {
        None
    }
});
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>GPIOOutputs([](const auto&amp; dev,
               const auto&amp; gpio) -&gt; std::optional&lt;GPIOOutputType&gt; {
  if (gpio == GPIOOut::O0)
    return GPIOOutputType::BaseSignal;
  else
    return std::nullopt;
});
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Utils;
</span>new GPIOOutputs(
    (dev, gpio) =&gt; gpio == GPIOOut.O0 ? GPIOOutputType.BaseSignal : null
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import GPIOOutputs, GPIOOutputType, GPIOOut
</span>GPIOOutputs(
    lambda _dev, gpio: (
        GPIOOutputType.BaseSignal if gpio == GPIOOut.O0 else None
    ),
)
</code></pre>
</div></div>
<p>The following data can be output.</p>
<ul>
<li><code>BaseSignal</code>: Reference signal (50% duty cycle square wave with the same frequency as ultrasound)</li>
<li><code>Thermo</code>: Whether the temperature sensor is asserted</li>
<li><code>ForceFan</code>: Whether the ForceFan flag is asserted</li>
<li><code>Sync</code>: EtherCAT synchronization signal</li>
<li><code>ModSegment</code>: Modulation segment (High if segment is 1)</li>
<li><code>ModIdx(u16)</code>: High when the modulation index is the specified value</li>
<li><code>StmSegment</code>: STM segment (High if segment is 1)</li>
<li><code>StmIdx(u16)</code>: High when the STM index is the specified value</li>
<li><code>IsStmMode</code>: Whether FociSTM/GainSTM is being used</li>
<li><code>PwmOut(&amp;Transducer)</code>: PWM output of the specified transducer</li>
<li><code>SysTimeEq(DcSysTime)</code>: High during the specified system time</li>
<li><code>Direct(bool)</code>: Output the specified value (if <code>true</code>, High; if <code>false</code>, Low)</li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/gpio_out.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="fan-control"><a class="header" href="#fan-control">Fan Control</a></h1>
<p>AUTD3 devices have fans with three modes: Auto, Off, and On.</p>
<p>In Auto mode, the temperature monitoring IC monitors the temperature of the IC and automatically activates the fan when it exceeds a certain temperature.
In Off mode, the fan is always off, and in On mode, the fan is always on.</p>
<p>The mode can be switched using the jumper switch next to the fan. It is a bit difficult to understand, but as shown in the figure below, shorting the fan side sets it to Auto, the middle to Off, and the right side to On.</p>
<figure>
    <img src="Users_Manual/API/../../fig/Users_Manual/fan.jpg"/>
    <figcaption>Jumper switch for AUTD fan control</figcaption>
</figure>
<p>In Auto mode, the fan automatically activates when the temperature rises.</p>
<p>In Auto mode, the fan can be forcibly activated with <code>ForceFan</code>.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span><span class="boring">fn main() {
</span><span class="boring">let _ =
</span>ForceFan::new(|_dev| true);
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span>ForceFan([](const auto&amp;) { return true; });
<span class="boring">return 0; }
</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span>new ForceFan(_ =&gt; true);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import ForceFan
</span>ForceFan(lambda _: True)
</code></pre>
</div></div>
<p>The argument of the <code>ForceFan</code> constructor is <code>Fn(&amp;Device) -&gt; bool</code>, which specifies whether to forcibly drive the fan for each device.</p>
<blockquote>
<p>NOTE: You cannot forcibly turn off the fan in Auto mode.</p>
</blockquote>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/fan.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="group"><a class="header" href="#group">Group</a></h1>
<p>Using the <code>Group</code>, you can group devices by device, and send different data for each group.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Rust-tab-0">Rust</label><input id="C++-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C++-tab-0">C++</label><input id="C#-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="C#-tab-0">C#</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=4 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span>
<span class="boring">use std::collections::HashMap;
</span><span class="boring">fn main() {
</span><span class="boring">    let x = 0.;
</span><span class="boring">    let y = 0.;
</span><span class="boring">    let z = 0.;
</span><span class="boring">    let _ = 
</span>Group::new(
    |dev| match dev.idx() {
        0 =&gt; Some("focus"),
        1 =&gt; Some("null"),
        _ =&gt; None,
    },
    HashMap::from([
        (
            "focus",
            BoxedDatagram::new(Focus {
                pos: Point3::new(x, y, z),
                option: Default::default(),
            }),
        ),
        ("null", BoxedDatagram::new(Null {})),
    ]),
);
<span class="boring">}</span></code></pre>
<blockquote>
<p>NOTE: In the Rust version, since the values of <code>HashMap</code> must all be of the same type, <code>BoxedDatagram</code> is used here to unify the types.</p>
</blockquote>
</div><div class="mdbook-inpage-tab-content" id=C++-content>
<pre><code class="language-cpp"><span class="boring">#include&lt;autd3.hpp&gt;
</span><span class="boring">int main() {
</span><span class="boring">using namespace autd3;
</span><span class="boring">const auto x = 0.0;
</span><span class="boring">const auto y = 0.0;
</span><span class="boring">const auto z = 0.0;
</span>autd3::Group(
    [](const Device&amp; dev) -&gt; std::optional&lt;const char*&gt; {
      if (dev.idx() == 0) {
        return "null";
      } else if (dev.idx() == 1) {
        return "focus";
      } else {
        return std::nullopt;
      }
    },
    std::unordered_map&lt;const char*, std::shared_ptr&lt;driver::Datagram&gt;&gt;{
        {"focus",
         std::make_shared&lt;Focus&gt;(Focus(Point3(x, y, z), FocusOption{}))},
        {"null", std::make_shared&lt;Null&gt;()}});
<span class="boring">return 0; }
</span></code></pre>
<blockquote>
<p>NOTE: In C++, <code>std::optional</code> must be used for the keys. Also, to unify the types, <code>std::shared_ptr&lt;driver::Datagram&gt;</code> is used.</p>
</blockquote>
</div><div class="mdbook-inpage-tab-content" id=C#-content>
<pre><code class="language-cs"><span class="boring">using AUTD3Sharp;
</span><span class="boring">using AUTD3Sharp.Link;
</span><span class="boring">using AUTD3Sharp.Gain;
</span><span class="boring">using AUTD3Sharp.Modulation;
</span><span class="boring">using AUTD3Sharp.Utils;
</span><span class="boring">var x = 0.0f;
</span><span class="boring">var y = 0.0f;
</span><span class="boring">var z = 0.0f;
</span>new AUTD3Sharp.Group(dev =&gt;
    {
        return dev.Idx() switch
        {
            0 =&gt; "null",
            1 =&gt; "focus",
            _ =&gt; null
        };
    },
    new GroupDictionary {
        { "null", new Null() },
        { "focus", new Focus(pos: new Point3(x, y, z), option: new FocusOption()) }
    }
);
</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import Device, Group
</span><span class="boring">from pyautd3.gain import Focus, FocusOption, Null
</span><span class="boring">x = 0.0
</span><span class="boring">y = 0.0
</span><span class="boring">z = 0.0
</span>def key_map(dev: Device) -&gt; str | None:
    if dev.idx == 0:
        return "null"
    if dev.idx == 1:
        return "focus"
    return None


Group(
    key_map=key_map,
    data_map={"null": Null(), "focus": Focus(pos=[x, y, z], option=FocusOption())},
)
</code></pre>
</div></div>
<p>Unlike <a href="Users_Manual/API/./gain/grouped.html"><code>GainGroup</code></a>, you can use any data that can be sent with the usual <code>send</code>.
However, you can only group by device.</p>
<blockquote>
<p>NOTE:
In this sample, strings are used as keys, but you can use anything that can be used as a key for <code>HashMap</code>.</p>
</blockquote>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/API/group.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="autd3-simulator"><a class="header" href="#autd3-simulator">AUTD3 Simulator</a></h1>
<p>AUTD Simulator (hereinafter referred to as the simulator) is a simulator for AUTD and works on Windows/Linux/macOS.</p>
<h2 id="autd-server"><a class="header" href="#autd-server">AUTD Server</a></h2>
<p>The simulator is included with the <code>AUTD Server</code>.
The installer is distributed on <a href="https://github.com/shinolab/autd3-server">GitHub</a>, so download it and follow the instructions to install it.</p>
<p>When you run <code>AUTD Server</code>, you will see a screen like the one below. Open the <code>Simulator</code> tab and press the <code>Run</code> button to start the simulator.</p>
<figure>
  <img src="Users_Manual/Simulator/../../fig/Users_Manual/autdserver_simulator.jpg"/>
</figure>
<p>When the simulator starts, it will be in a waiting state.</p>
<figure>
  <img src="Users_Manual/Simulator/../../fig/sim_waiting.jpg"/>
</figure>
<p>In this state, when you open the <code>Controller</code> using the <code>Simulator</code> link, circles representing the positions of the transducers and a black panel in the center of the screen will be displayed on the simulator.</p>
<figure>
  <img src="Users_Manual/Simulator/../../fig/sim_init.jpg"/>
</figure>
<p>This black panel is called a “Slice”, and you can use this “Slice” to visualize the sound field at any position.
At that time, the phase of the transducers is represented by hue, and the amplitude is represented by color intensity.</p>
<figure>
  <img src="Users_Manual/Simulator/../../fig/sim_focus.jpg"/>
</figure>
<p>Note that the sound field displayed by the simulator is a simple superposition of spherical waves, and does not consider directivity or nonlinear effects.</p>
<p>You can operate the Slice and camera using the GUI displayed on the left side of the screen.</p>
<h3 id="slice-tab"><a class="header" href="#slice-tab">Slice Tab</a></h3>
<p>In the Slice tab, you can change the size, position, and rotation of the Slice.
Rotation is specified by XYZ Euler angles.
Pressing the “xy”, “yz”, or “zx” buttons rotates the Slice to be parallel to each plane.</p>
<p>In addition, in the “Color settings” section, you can change the coloring palette and the Max pressure.
If the colors become saturated when using a large number of devices, you can increase the value of “Max pressure”.</p>
<h3 id="camera-tab"><a class="header" href="#camera-tab">Camera Tab</a></h3>
<p>In the Camera tab, you can change the position, rotation, Field of View, Near clip, and Far clip settings of the camera.
Rotation is specified by XYZ Euler angles.</p>
<h3 id="config-tab"><a class="header" href="#config-tab">Config Tab</a></h3>
<p>In the Config tab, you can set the speed of sound, font size, and background color.</p>
<p>You can also toggle the show/enable/overheat settings for each device.
If show is turned off, the device will not be displayed but will still contribute to the sound field.
If enable is turned off, the device will not contribute to the sound field.
If overheat is turned on, you can simulate a state where the temperature sensor is asserted.</p>
<h3 id="info-tab"><a class="header" href="#info-tab">Info Tab</a></h3>
<p>In the Info tab, you can check the information of Silencer, Modulation, and STM for each device.</p>
<p>You can check the settings of Silencer, but they are not reflected in the sound field.</p>
<p>If “Mod enable” is turned on, Modulation will be reflected in the sound field.</p>
<p>Modulation and STM determine which index data to output based on real time.
This time is represented by “System time”, which is the elapsed time in nanoseconds since January 1, 2000, 0:00:00.</p>
<p>If “Auto play” is turned on, “System time” is automatically set.
Otherwise, you can manually advance the time.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/Simulator/simulator.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="emulator"><a class="header" href="#emulator">Emulator</a></h1>
<p>By using the <code>Emulator</code>, you can perform more detailed calculations of output phase/pulse width, output voltage, output sound wave, and sound field compared to the <code>Simulator</code>.</p>
<blockquote>
<p>NOTE: Currently, the <code>Emulator</code> is only available in Rust and Python.
There are no plans to port it to C++ or C#.</p>
</blockquote>
<ul>
<li><a href="Users_Manual/Emulator/emulator.html#install">Install</a></li>
<li><a href="Users_Manual/Emulator/emulator.html#apis">APIs</a>
<ul>
<li><a href="Users_Manual/Emulator/emulator.html#transducer-table">Transducer Table</a></li>
<li><a href="Users_Manual/Emulator/emulator.html#calculation-of-output-phasepulse-width">Calculation of Output Phase/Pulse Width</a></li>
<li><a href="Users_Manual/Emulator/emulator.html#output-voltage">Output Voltage</a></li>
<li><a href="Users_Manual/Emulator/emulator.html#output-sound-pressure">Output Sound Pressure</a></li>
<li><a href="Users_Manual/Emulator/emulator.html#calculation-of-sound-field-instantaneous-value">Calculation of Sound Field (Instantaneous Value)</a></li>
<li><a href="Users_Manual/Emulator/emulator.html#calculation-of-sound-field-rms">Calculation of Sound Field (RMS)</a></li>
</ul>
</li>
</ul>
<h2 id="install-8"><a class="header" href="#install-8">Install</a></h2>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=2 for="Rust-tab-0">Rust</label><input id="Python-tab-0" type="radio" class="mdbook-inpage-tab" name="tab-0">
                                <label class="mdbook-inpage-tab-item" num-tabs=2 for="Python-tab-0">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust name=shell">cargo add autd3-emulator</code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python name=shell">pip install pyautd3_emulator
</code></pre>
</div></div>
<h2 id="apis-8"><a class="header" href="#apis-8">APIs</a></h2>
<p>The data output by the <code>Emulator</code> is a Polars DataFrame.
For more details, please refer to the <a href="https://pola.rs/">Polars documentation</a>.</p>
<h3 id="transducer-table"><a class="header" href="#transducer-table">Transducer Table</a></h3>
<p>Displays a list of transducers.</p>
<p>Each column contains the device index, the (local) index of the transducer, position, and axial direction.</p>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=2 for="Rust-tab-1">Rust</label><input id="Python-tab-1" type="radio" class="mdbook-inpage-tab" name="tab-1">
                                <label class="mdbook-inpage-tab-item" num-tabs=2 for="Python-tab-1">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span>use autd3_emulator::*;

<span class="boring">fn main() {
</span>let emulator = Emulator::new([AUTD3::default()]);
let df = emulator.transducer_table();
dbg!(df);
<span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">from pyautd3 import AUTD3
</span>from pyautd3_emulator import Emulator

with Emulator([AUTD3()]) as emulator:
    df = emulator.transducer_table()
    print(df)
</code></pre>
</div></div>
<pre><code>┌─────────┬────────┬────────────┬────────────┬───────┬─────┬─────┬─────┐
│ dev_idx ┆ tr_idx ┆ x[mm]      ┆ y[mm]      ┆ z[mm] ┆ nx  ┆ ny  ┆ nz  │
│ ---     ┆ ---    ┆ ---        ┆ ---        ┆ ---   ┆ --- ┆ --- ┆ --- │
│ u16     ┆ u8     ┆ f32        ┆ f32        ┆ f32   ┆ f32 ┆ f32 ┆ f32 │
╞═════════╪════════╪════════════╪════════════╪═══════╪═════╪═════╪═════╡
│ 0       ┆ 0      ┆ 0.0        ┆ 0.0        ┆ 0.0   ┆ 0.0 ┆ 0.0 ┆ 1.0 │
│ 0       ┆ 1      ┆ 10.16      ┆ 0.0        ┆ 0.0   ┆ 0.0 ┆ 0.0 ┆ 1.0 │
│ 0       ┆ 2      ┆ 20.32      ┆ 0.0        ┆ 0.0   ┆ 0.0 ┆ 0.0 ┆ 1.0 │
│ 0       ┆ 3      ┆ 30.48      ┆ 0.0        ┆ 0.0   ┆ 0.0 ┆ 0.0 ┆ 1.0 │
│ 0       ┆ 4      ┆ 40.639999  ┆ 0.0        ┆ 0.0   ┆ 0.0 ┆ 0.0 ┆ 1.0 │
│ …       ┆ …      ┆ …          ┆ …          ┆ …     ┆ …   ┆ …   ┆ …   │
│ 0       ┆ 244    ┆ 132.080002 ┆ 132.080002 ┆ 0.0   ┆ 0.0 ┆ 0.0 ┆ 1.0 │
│ 0       ┆ 245    ┆ 142.23999  ┆ 132.080002 ┆ 0.0   ┆ 0.0 ┆ 0.0 ┆ 1.0 │
│ 0       ┆ 246    ┆ 152.399994 ┆ 132.080002 ┆ 0.0   ┆ 0.0 ┆ 0.0 ┆ 1.0 │
│ 0       ┆ 247    ┆ 162.559998 ┆ 132.080002 ┆ 0.0   ┆ 0.0 ┆ 0.0 ┆ 1.0 │
│ 0       ┆ 248    ┆ 172.720001 ┆ 132.080002 ┆ 0.0   ┆ 0.0 ┆ 0.0 ┆ 1.0 │
└─────────┴────────┴────────────┴────────────┴───────┴─────┴─────┴─────┘
</code></pre>
<h3 id="calculation-of-output-phasepulse-width"><a class="header" href="#calculation-of-output-phasepulse-width">Calculation of Output Phase/Pulse Width</a></h3>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=2 for="Rust-tab-2">Rust</label><input id="Python-tab-2" type="radio" class="mdbook-inpage-tab" name="tab-2">
                                <label class="mdbook-inpage-tab-item" num-tabs=2 for="Python-tab-2">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span>use autd3_emulator::*;
<span class="boring">use std::time::Duration;
</span>
<span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span>let emulator = Emulator::new([AUTD3::default()]);

let record = emulator.record(|autd| {
    autd.send(Silencer::default())?;
    autd.send((
        Sine {
            freq: 200 * Hz,
            option: Default::default(),
        },
        Uniform {
            intensity: Intensity::MAX,
            phase: Phase::ZERO,
        },
    ))?;
    autd.tick(Duration::from_millis(10))?;
    Ok(())
})?;
let df = record.phase();
dbg!(df);

let df = record.pulse_width();
dbg!(df);
<span class="boring">Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python">from pyautd3 import (
    AUTD3,
    Duration,
    Hz,
    Intensity,
    Phase,
    Silencer,
    Sine,
    SineOption,
    Uniform,
)
from pyautd3_emulator import Emulator, Recorder

with Emulator([AUTD3()]) as emulator:

    def f(autd: Recorder) -&gt; None:
        autd.send(Silencer())
        autd.send(
            (
                Sine(freq=200.0 * Hz, option=SineOption()),
                Uniform(intensity=Intensity.MAX, phase=Phase.ZERO),
            ),
        )
        autd.tick(Duration.from_millis(10))

    record = emulator.record(f)

    df = record.phase()
    print(df)

    df = record.pulse_width()
    print(df)
</code></pre>
</div></div>
<blockquote>
<p>NOTE: The time interval specified by <code>tick</code> must be a multiple of <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">25</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">us</span></span></span></span></span></span>.</p>
</blockquote>
<p>At each time (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">25</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">us</span></span></span></span></span></span> unit), the phase/pulse width is stored in each column.
Each column name is <code>&lt;phase/pulse_width&gt;@&lt;time&gt;[ns]</code>.</p>
<p>Each row corresponds to the rows in the <a href="Users_Manual/Emulator/emulator.html#transducer-table">Transducer Table</a>.</p>
<pre><code>┌─────────────┬────────────────┬────────────────┬────────────────┬───┬────────────────┬───────────────┬───────────────┬───────────────┐
│ phase@0[ns] ┆ phase@25000[ns ┆ phase@50000[ns ┆ phase@75000[ns ┆ … ┆ phase@9900000[ ┆ phase@9925000 ┆ phase@9950000 ┆ phase@9975000 │
│ ---         ┆ ]              ┆ ]              ┆ ]              ┆   ┆ ns]            ┆ [ns]          ┆ [ns]          ┆ [ns]          │
│ u8          ┆ ---            ┆ ---            ┆ ---            ┆   ┆ ---            ┆ ---           ┆ ---           ┆ ---           │
│             ┆ u8             ┆ u8             ┆ u8             ┆   ┆ u8             ┆ u8            ┆ u8            ┆ u8            │
╞═════════════╪════════════════╪════════════════╪════════════════╪═══╪════════════════╪═══════════════╪═══════════════╪═══════════════╡
│ 0           ┆ 0              ┆ 0              ┆ 0              ┆ … ┆ 0              ┆ 0             ┆ 0             ┆ 0             │
│ 0           ┆ 0              ┆ 0              ┆ 0              ┆ … ┆ 0              ┆ 0             ┆ 0             ┆ 0             │
│ 0           ┆ 0              ┆ 0              ┆ 0              ┆ … ┆ 0              ┆ 0             ┆ 0             ┆ 0             │
│ 0           ┆ 0              ┆ 0              ┆ 0              ┆ … ┆ 0              ┆ 0             ┆ 0             ┆ 0             │
│ 0           ┆ 0              ┆ 0              ┆ 0              ┆ … ┆ 0              ┆ 0             ┆ 0             ┆ 0             │
│ …           ┆ …              ┆ …              ┆ …              ┆ … ┆ …              ┆ …             ┆ …             ┆ …             │
│ 0           ┆ 0              ┆ 0              ┆ 0              ┆ … ┆ 0              ┆ 0             ┆ 0             ┆ 0             │
│ 0           ┆ 0              ┆ 0              ┆ 0              ┆ … ┆ 0              ┆ 0             ┆ 0             ┆ 0             │
│ 0           ┆ 0              ┆ 0              ┆ 0              ┆ … ┆ 0              ┆ 0             ┆ 0             ┆ 0             │
│ 0           ┆ 0              ┆ 0              ┆ 0              ┆ … ┆ 0              ┆ 0             ┆ 0             ┆ 0             │
│ 0           ┆ 0              ┆ 0              ┆ 0              ┆ … ┆ 0              ┆ 0             ┆ 0             ┆ 0             │
└─────────────┴────────────────┴────────────────┴────────────────┴───┴────────────────┴───────────────┴───────────────┴───────────────┘
</code></pre>
<pre><code>┌───────────────────┬───────────────────────┬───────────────────────┬───────────────────────┬───┬─────────────────────────┬─────────────────────────┬────────────────────────┬────────────────────────┐
│ pulse_width@0[ns] ┆ pulse_width@25000[ns] ┆ pulse_width@50000[ns] ┆ pulse_width@75000[ns] ┆ … ┆ pulse_width@9900000[ns] ┆ pulse_width@9925000[ns] ┆ pulse_width@9950000[ns ┆ pulse_width@9975000[ns │
│ ---               ┆ ---                   ┆ ---                   ┆ ---                   ┆   ┆ ---                     ┆ ---                     ┆ ]                      ┆ ]                      │
│ u16               ┆ u16                   ┆ u16                   ┆ u16                   ┆   ┆ u16                     ┆ u16                     ┆ ---                    ┆ ---                    │
│                   ┆                       ┆                       ┆                       ┆   ┆                         ┆                         ┆ u16                    ┆ u16                    │
╞═══════════════════╪═══════════════════════╪═══════════════════════╪═══════════════════════╪═══╪═════════════════════════╪═════════════════════════╪════════════════════════╪════════════════════════╡
│ 8                 ┆ 16                    ┆ 24                    ┆ 33                    ┆ … ┆ 50                      ┆ 53                      ┆ 55                     ┆ 57                     │
│ 8                 ┆ 16                    ┆ 24                    ┆ 33                    ┆ … ┆ 50                      ┆ 53                      ┆ 55                     ┆ 57                     │
│ 8                 ┆ 16                    ┆ 24                    ┆ 33                    ┆ … ┆ 50                      ┆ 53                      ┆ 55                     ┆ 57                     │
│ 8                 ┆ 16                    ┆ 24                    ┆ 33                    ┆ … ┆ 50                      ┆ 53                      ┆ 55                     ┆ 57                     │
│ 8                 ┆ 16                    ┆ 24                    ┆ 33                    ┆ … ┆ 50                      ┆ 53                      ┆ 55                     ┆ 57                     │
│ …                 ┆ …                     ┆ …                     ┆ …                     ┆ … ┆ …                       ┆ …                       ┆ …                      ┆ …                      │
│ 8                 ┆ 16                    ┆ 24                    ┆ 33                    ┆ … ┆ 50                      ┆ 53                      ┆ 55                     ┆ 57                     │
│ 8                 ┆ 16                    ┆ 24                    ┆ 33                    ┆ … ┆ 50                      ┆ 53                      ┆ 55                     ┆ 57                     │
│ 8                 ┆ 16                    ┆ 24                    ┆ 33                    ┆ … ┆ 50                      ┆ 53                      ┆ 55                     ┆ 57                     │
│ 8                 ┆ 16                    ┆ 24                    ┆ 33                    ┆ … ┆ 50                      ┆ 53                      ┆ 55                     ┆ 57                     │
│ 8                 ┆ 16                    ┆ 24                    ┆ 33                    ┆ … ┆ 50                      ┆ 53                      ┆ 55                     ┆ 57                     │
└───────────────────┴───────────────────────┴───────────────────────┴───────────────────────┴───┴─────────────────────────┴─────────────────────────┴────────────────────────┴────────────────────────┘
</code></pre>
<h3 id="output-voltage"><a class="header" href="#output-voltage">Output Voltage</a></h3>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-3" type="radio" class="mdbook-inpage-tab" name="tab-3" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=2 for="Rust-tab-3">Rust</label><input id="Python-tab-3" type="radio" class="mdbook-inpage-tab" name="tab-3">
                                <label class="mdbook-inpage-tab-item" num-tabs=2 for="Python-tab-3">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span>use autd3_emulator::*;
<span class="boring">use std::time::Duration;
</span>
<span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span>let emulator = Emulator::new([AUTD3::default()]);

let record = emulator.record(|autd| {
    autd.send(Silencer::disable())?;
    autd.send((
        Static { intensity: 0xFF },
        Uniform {
            intensity: Intensity::MAX,
            phase: Phase(0x40),
        },
    ))?;
    autd.tick(Duration::from_millis(1))?;
    Ok(())
})?;

let df = record.output_voltage();
dbg!(df);
<span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python">from pyautd3 import AUTD3, Duration, Intensity, Phase, Silencer, Static, Uniform
from pyautd3_emulator import Emulator, Recorder

with Emulator([AUTD3()]) as emulator:

    def f(autd: Recorder) -&gt; None:
        autd.send(Silencer.disable())
        autd.send((Static(), Uniform(phase=Phase(0x40), intensity=Intensity.MAX)))
        autd.tick(Duration.from_millis(1))

    record = emulator.record(f)

    df = record.output_voltage()
    print(df)
</code></pre>
</div></div>
<p>The output voltage at each time (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">25</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">us</span></span></span><span class="mord">/512</span></span></span></span> unit) is stored in each column.
Each column name is <code>voltage[V]@&lt;time&gt;[25us/512]</code>.</p>
<p>Each row corresponds to the rows in the <a href="Users_Manual/Emulator/emulator.html#transducer-table">Transducer Table</a>.</p>
<pre><code>┌────────────────────────┬────────────────────────┬────────────────────────┬────────────────────────┬───┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┐
│ voltage[V]@0[25us/512] ┆ voltage[V]@1[25us/512] ┆ voltage[V]@2[25us/512] ┆ voltage[V]@3[25us/512] ┆ … ┆ voltage[V]@20476[25us/512] ┆ voltage[V]@20477[25us/512] ┆ voltage[V]@20478[25us/512] ┆ voltage[V]@20479[25us/512] │
│ ---                    ┆ ---                    ┆ ---                    ┆ ---                    ┆   ┆ ---                        ┆ ---                        ┆ ---                        ┆ ---                        │
│ f32                    ┆ f32                    ┆ f32                    ┆ f32                    ┆   ┆ f32                        ┆ f32                        ┆ f32                        ┆ f32                        │
╞════════════════════════╪════════════════════════╪════════════════════════╪════════════════════════╪═══╪════════════════════════════╪════════════════════════════╪════════════════════════════╪════════════════════════════╡
│ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ … ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      │
│ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ … ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      │
│ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ … ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      │
│ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ … ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      │
│ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ … ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      │
│ …                      ┆ …                      ┆ …                      ┆ …                      ┆ … ┆ …                          ┆ …                          ┆ …                          ┆ …                          │
│ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ … ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      │
│ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ … ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      │
│ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ … ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      │
│ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ … ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      │
│ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ 12.0                   ┆ … ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      ┆ -12.0                      │
└────────────────────────┴────────────────────────┴────────────────────────┴────────────────────────┴───┴────────────────────────────┴────────────────────────────┴────────────────────────────┴────────────────────────────┘
</code></pre>
<h3 id="output-sound-pressure"><a class="header" href="#output-sound-pressure">Output Sound Pressure</a></h3>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-4" type="radio" class="mdbook-inpage-tab" name="tab-4" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=2 for="Rust-tab-4">Rust</label><input id="Python-tab-4" type="radio" class="mdbook-inpage-tab" name="tab-4">
                                <label class="mdbook-inpage-tab-item" num-tabs=2 for="Python-tab-4">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span>use autd3_emulator::*;
<span class="boring">use std::time::Duration;
</span>
<span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span>let emulator = Emulator::new([AUTD3::default()]);

let record = emulator.record(|autd| {
    autd.send(Silencer::disable())?;
    autd.send((
        Static { intensity: 0xFF },
        Uniform {
            intensity: Intensity::MAX,
            phase: Phase(0x40),
        },
    ))?;
    autd.tick(Duration::from_millis(1))?;
    Ok(())
})?;

let df = record.output_ultrasound();
dbg!(df);
<span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python">from pyautd3 import AUTD3, Duration, Intensity, Phase, Silencer, Static, Uniform
from pyautd3_emulator import Emulator, Recorder

with Emulator([AUTD3()]) as emulator:

    def f(autd: Recorder) -&gt; None:
        autd.send(Silencer.disable())
        autd.send((Static(), Uniform(phase=Phase(0x40), intensity=Intensity.MAX)))
        autd.tick(Duration.from_millis(1))

    record = emulator.record(f)

    df = record.output_ultrasound()
    print(df)
</code></pre>
</div></div>
<p>The normalized output sound pressure at each time (<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">25</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">us</span></span></span><span class="mord">/512</span></span></span></span> unit) is stored in each column.
Each column name is <code>p[a.u.]@&lt;time&gt;[25us/512]</code>.</p>
<p>Each row corresponds to the rows in the <a href="Users_Manual/Emulator/emulator.html#transducer-table">Transducer Table</a>.</p>
<pre><code>┌─────────────────────┬─────────────────────┬─────────────────────┬─────────────────────┬───┬─────────────────────────┬─────────────────────────┬─────────────────────────┬─────────────────────────┐
│ p[a.u.]@0[25us/512] ┆ p[a.u.]@1[25us/512] ┆ p[a.u.]@2[25us/512] ┆ p[a.u.]@3[25us/512] ┆ … ┆ p[a.u.]@20476[25us/512] ┆ p[a.u.]@20477[25us/512] ┆ p[a.u.]@20478[25us/512] ┆ p[a.u.]@20479[25us/512] │
│ ---                 ┆ ---                 ┆ ---                 ┆ ---                 ┆   ┆ ---                     ┆ ---                     ┆ ---                     ┆ ---                     │
│ f32                 ┆ f32                 ┆ f32                 ┆ f32                 ┆   ┆ f32                     ┆ f32                     ┆ f32                     ┆ f32                     │
╞═════════════════════╪═════════════════════╪═════════════════════╪═════════════════════╪═══╪═════════════════════════╪═════════════════════════╪═════════════════════════╪═════════════════════════╡
│ 0.0                 ┆ -0.000272           ┆ -0.000481           ┆ -0.000618           ┆ … ┆ -0.36185                ┆ -0.350698               ┆ -0.339501               ┆ -0.328258               │
│ 0.0                 ┆ -0.000272           ┆ -0.000481           ┆ -0.000618           ┆ … ┆ -0.36185                ┆ -0.350698               ┆ -0.339501               ┆ -0.328258               │
│ 0.0                 ┆ -0.000272           ┆ -0.000481           ┆ -0.000618           ┆ … ┆ -0.36185                ┆ -0.350698               ┆ -0.339501               ┆ -0.328258               │
│ 0.0                 ┆ -0.000272           ┆ -0.000481           ┆ -0.000618           ┆ … ┆ -0.36185                ┆ -0.350698               ┆ -0.339501               ┆ -0.328258               │
│ 0.0                 ┆ -0.000272           ┆ -0.000481           ┆ -0.000618           ┆ … ┆ -0.36185                ┆ -0.350698               ┆ -0.339501               ┆ -0.328258               │
│ …                   ┆ …                   ┆ …                   ┆ …                   ┆ … ┆ …                       ┆ …                       ┆ …                       ┆ …                       │
│ 0.0                 ┆ -0.000272           ┆ -0.000481           ┆ -0.000618           ┆ … ┆ -0.36185                ┆ -0.350698               ┆ -0.339501               ┆ -0.328258               │
│ 0.0                 ┆ -0.000272           ┆ -0.000481           ┆ -0.000618           ┆ … ┆ -0.36185                ┆ -0.350698               ┆ -0.339501               ┆ -0.328258               │
│ 0.0                 ┆ -0.000272           ┆ -0.000481           ┆ -0.000618           ┆ … ┆ -0.36185                ┆ -0.350698               ┆ -0.339501               ┆ -0.328258               │
│ 0.0                 ┆ -0.000272           ┆ -0.000481           ┆ -0.000618           ┆ … ┆ -0.36185                ┆ -0.350698               ┆ -0.339501               ┆ -0.328258               │
│ 0.0                 ┆ -0.000272           ┆ -0.000481           ┆ -0.000618           ┆ … ┆ -0.36185                ┆ -0.350698               ┆ -0.339501               ┆ -0.328258               │
└─────────────────────┴─────────────────────┴─────────────────────┴─────────────────────┴───┴─────────────────────────┴─────────────────────────┴─────────────────────────┴─────────────────────────┘
</code></pre>
<h3 id="calculation-of-sound-field-instantaneous-value"><a class="header" href="#calculation-of-sound-field-instantaneous-value">Calculation of Sound Field (Instantaneous Value)</a></h3>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-5" type="radio" class="mdbook-inpage-tab" name="tab-5" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=2 for="Rust-tab-5">Rust</label><input id="Python-tab-5" type="radio" class="mdbook-inpage-tab" name="tab-5">
                                <label class="mdbook-inpage-tab-item" num-tabs=2 for="Python-tab-5">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span>use autd3_emulator::*;
<span class="boring">use std::time::Duration;
</span>
<span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span>let emulator = Emulator::new([AUTD3::default()]);

let focus = emulator.center() + Vector3::new(0., 0., 150. * mm);

let record = emulator.record(|autd| {
    autd.send(Silencer::disable())?;
    autd.send((
        Static { intensity: 0xFF },
        Focus {
            pos: focus,
            option: Default::default(),
        },
    ))?;
    autd.tick(Duration::from_millis(1))?;
    Ok(())
})?;

let mut sound_field = record.sound_field(
    RangeXY {
        x: focus.x - 20.0..=focus.x + 20.0,
        y: focus.y - 20.0..=focus.y + 20.0,
        z: focus.z,
        resolution: 1.,
    },
    InstantRecordOption {
        sound_speed: 340e3 * mm,
        time_step: Duration::from_micros(1),
        memory_limits_hint_mb: 128,
        gpu: true,
    },
)?;

let df = sound_field.observe_points();
dbg!(df);

let df = sound_field
    .skip(Duration::from_micros(500))?
    .next(Duration::from_micros(500))?;
dbg!(df);
<span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
<blockquote>
<p>NOTE: The <code>gpu</code> option is only available if the <code>gpu</code> feature is enabled.</p></p>
</blockquote>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">import numpy as np
</span>from pyautd3 import AUTD3, Focus, FocusOption, Silencer, Static, Duration
from pyautd3_emulator import Emulator, RangeXYZ, Recorder, InstantRecordOption

with Emulator([AUTD3()]) as emulator:
    focus = emulator.center() + np.array([0.0, 0.0, 150.0])

    def f(autd: Recorder) -&gt; None:
        autd.send(Silencer.disable())
        autd.send((Static(), Focus(pos=focus, option=FocusOption())))
        autd.tick(Duration.from_millis(1))

    record = emulator.record(f)

    sound_field = record.sound_field(
        RangeXYZ(
            x=(focus[0] - 20.0, focus[0] + 20.0),
            y=(focus[1] - 20.0, focus[1] + 20.0),
            z=(focus[2], focus[2]),
            resolution=1.0,
        ),
        InstantRecordOption(
            sound_speed=340e3,
            time_step=Duration.from_micros(1),
            memory_limits_hint_mb=128,
            gpu=True,
        ),
    )

    df = sound_field.observe_points()
    print(df)

    df = sound_field.skip(Duration.from_micros(500)).next(
        Duration.from_micros(500),
    )
    print(df)
</code></pre>
</div></div>
<blockquote>
<p>NOTE: In Rust, besides <code>RangeXYZ</code>, you can use <code>RangeZXY</code>, <code>RangeXY</code> for 2D, <code>RangeX</code> for 1D and so on, or <code>Vec&lt;Vector3&gt;</code> to specify arbitrary points.
In Python, only <code>RangeXYZ</code> is available.</p>
</blockquote>
<p>Enabling the <code>print_progress</code> option will display the calculation progress.
Enabling the <code>gpu</code> option will execute the calculation on the GPU.</p>
<p>Due to the potential for high memory consumption, the <code>next</code> function is used to retrieve only specific times.
The <code>skip</code> function can be used to skip a specified amount of time.</p>
<p>The output sound pressure at each observation point is stored in each column in chronological order (unit specified by <code>time_step</code>).
Each column name is <code>p[Pa]@&lt;time&gt;[ns]</code>.
Each row corresponds to the observation points obtained with <code>observe_points</code>.</p>
<pre><code>┌────────────┬───────────┬───────┐
│ x[mm]      ┆ y[mm]     ┆ z[mm] │
│ ---        ┆ ---       ┆ ---   │
│ f32        ┆ f32       ┆ f32   │
╞════════════╪═══════════╪═══════╡
│ 66.625267  ┆ 46.713196 ┆ 150.0 │
│ 67.625267  ┆ 46.713196 ┆ 150.0 │
│ 68.625267  ┆ 46.713196 ┆ 150.0 │
│ 69.625267  ┆ 46.713196 ┆ 150.0 │
│ 70.625267  ┆ 46.713196 ┆ 150.0 │
│ …          ┆ …         ┆ …     │
│ 102.625267 ┆ 86.713196 ┆ 150.0 │
│ 103.625267 ┆ 86.713196 ┆ 150.0 │
│ 104.625267 ┆ 86.713196 ┆ 150.0 │
│ 105.625267 ┆ 86.713196 ┆ 150.0 │
│ 106.625267 ┆ 86.713196 ┆ 150.0 │
└────────────┴───────────┴───────┘
</code></pre>
<pre><code>┌──────────────────┬──────────────────┬──────────────────┬──────────────────┬───┬──────────────────┬──────────────────┬──────────────────┬──────────────────┐
│ p[Pa]@500000[ns] ┆ p[Pa]@501000[ns] ┆ p[Pa]@502000[ns] ┆ p[Pa]@503000[ns] ┆ … ┆ p[Pa]@996000[ns] ┆ p[Pa]@997000[ns] ┆ p[Pa]@998000[ns] ┆ p[Pa]@999000[ns] │
│ ---              ┆ ---              ┆ ---              ┆ ---              ┆   ┆ ---              ┆ ---              ┆ ---              ┆ ---              │
│ f32              ┆ f32              ┆ f32              ┆ f32              ┆   ┆ f32              ┆ f32              ┆ f32              ┆ f32              │
╞══════════════════╪══════════════════╪══════════════════╪══════════════════╪═══╪══════════════════╪══════════════════╪══════════════════╪══════════════════╡
│ 22.249609        ┆ 14.994699        ┆ 11.20509         ┆ 3.416157         ┆ … ┆ 167.468948       ┆ 143.434677       ┆ 115.029839       ┆ 78.702179        │
│ 22.973528        ┆ 17.704706        ┆ 14.598668        ┆ 6.462077         ┆ … ┆ 128.688828       ┆ 102.245392       ┆ 73.068733        ┆ 39.29715         │
│ 23.043713        ┆ 20.534163        ┆ 15.762163        ┆ 9.015405         ┆ … ┆ 72.13736         ┆ 50.06559         ┆ 25.516897        ┆ -1.414132        │
│ 21.61729         ┆ 19.986338        ┆ 16.669203        ┆ 11.957072        ┆ … ┆ 6.599095         ┆ -8.152014        ┆ -22.183277       ┆ -34.678905       │
│ 17.479811        ┆ 18.30769         ┆ 16.697689        ┆ 12.929367        ┆ … ┆ -61.525105       ┆ -64.023788       ┆ -62.711498       ┆ -56.925694       │
│ …                ┆ …                ┆ …                ┆ …                ┆ … ┆ …                ┆ …                ┆ …                ┆ …                │
│ 14.888723        ┆ 14.758762        ┆ 13.289121        ┆ 9.737269         ┆ … ┆ -73.181961       ┆ -85.114655       ┆ -92.114983       ┆ -93.623962       │
│ 17.559294        ┆ 15.889968        ┆ 12.346513        ┆ 7.979947         ┆ … ┆ -28.419638       ┆ -61.184322       ┆ -90.326851       ┆ -113.895905      │
│ 18.171673        ┆ 15.26449         ┆ 10.946121        ┆ 5.410897         ┆ … ┆ 19.804182        ┆ -28.594215       ┆ -73.595749       ┆ -115.230705      │
│ 18.815191        ┆ 12.321008        ┆ 7.800498         ┆ 3.680776         ┆ … ┆ 65.869225        ┆ 9.351333         ┆ -48.561874       ┆ -98.87677        │
│ 16.717573        ┆ 10.482997        ┆ 4.044011         ┆ 0.89806          ┆ … ┆ 102.099556       ┆ 44.310383        ┆ -16.616224       ┆ -70.65287        │
└──────────────────┴──────────────────┴──────────────────┴──────────────────┴───┴──────────────────┴──────────────────┴──────────────────┴──────────────────┘
</code></pre>
<h3 id="calculation-of-sound-field-rms"><a class="header" href="#calculation-of-sound-field-rms">Calculation of Sound Field (RMS)</a></h3>
<div class="mdbook-inpage-tabs"><input id="Rust-tab-6" type="radio" class="mdbook-inpage-tab" name="tab-6" checked>
                                <label class="mdbook-inpage-tab-item" num-tabs=2 for="Rust-tab-6">Rust</label><input id="Python-tab-6" type="radio" class="mdbook-inpage-tab" name="tab-6">
                                <label class="mdbook-inpage-tab-item" num-tabs=2 for="Python-tab-6">Python</label><div class="mdbook-inpage-tab-content" id=Rust-content>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span>use autd3_emulator::*;
<span class="boring">use std::time::Duration;
</span>
<span class="boring">fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
</span>let emulator = Emulator::new([AUTD3::default()]);

let focus = emulator.center() + Vector3::new(0., 0., 150. * mm);

let record = emulator.record(|autd| {
    autd.send(Silencer::disable())?;
    autd.send((
        Static { intensity: 0xFF },
        Focus {
            pos: focus,
            option: Default::default(),
        },
    ))?;
    autd.tick(Duration::from_micros(25))?;
    Ok(())
})?;

let mut sound_field = record.sound_field(
    RangeXY {
        x: focus.x - 20.0..=focus.x + 20.0,
        y: focus.y - 20.0..=focus.y + 20.0,
        z: focus.z,
        resolution: 1.,
    },
    RmsRecordOption {
        sound_speed: 340e3 * mm,
        gpu: true,
    },
)?;

let df = sound_field.observe_points();
dbg!(df);

let df = sound_field.next(Duration::from_micros(25))?;
dbg!(df);
<span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
<blockquote>
<p>NOTE: The <code>gpu</code> option is only available if the <code>gpu</code> feature is enabled.</p></p>
</blockquote>
</div><div class="mdbook-inpage-tab-content" id=Python-content>
<pre><code class="language-python"><span class="boring">import numpy as np
</span>from pyautd3 import AUTD3, Duration, Focus, FocusOption, Silencer, Static
from pyautd3_emulator import Emulator, RangeXYZ, Recorder, RmsRecordOption

with Emulator([AUTD3()]) as emulator:
    focus = emulator.center() + np.array([0.0, 0.0, 150.0])

    def f(autd: Recorder) -&gt; None:
        autd.send(Silencer.disable())
        autd.send((Static(), Focus(pos=focus, option=FocusOption())))
        autd.tick(Duration.from_micros(25))

    record = emulator.record(f)

    sound_field = record.sound_field(
        RangeXYZ(
            x=(focus[0] - 20.0, focus[0] + 20.0),
            y=(focus[1] - 20.0, focus[1] + 20.0),
            z=(focus[2], focus[2]),
            resolution=1.0,
        ),
        RmsRecordOption(
            sound_speed=340e3,
            gpu=False,
        ),
    )

    df = sound_field.observe_points()
    print(df)

    df = sound_field.next(Duration.from_micros(25))
    print(df)
</code></pre>
</div></div>
<blockquote>
<p>NOTE: The time must advance by at least <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">25</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">us</span></span></span></span></span></span>.</p>
</blockquote>
<blockquote>
<p>NOTE: The values calculated by RMS are <strong>not the RMS of the instantaneous sound field above</strong>. They are a linear superposition that ignores propagation delays and transducer responses.</p>
</blockquote>
<p>The RMS of the output sound pressure at each observation point is stored in each column in chronological order (unit is <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord"><span class="mord">25</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">us</span></span></span></span></span></span>).
Each column name is <code>rms[Pa]@&lt;time&gt;[ns]</code>.
Each row corresponds to the observation points obtained with <code>observe_points</code>.</p>
<pre><code>┌────────────┬───────────┬───────┐
│ x[mm]      ┆ y[mm]     ┆ z[mm] │
│ ---        ┆ ---       ┆ ---   │
│ f32        ┆ f32       ┆ f32   │
╞════════════╪═══════════╪═══════╡
│ 66.625267  ┆ 46.713196 ┆ 150.0 │
│ 67.625267  ┆ 46.713196 ┆ 150.0 │
│ 68.625267  ┆ 46.713196 ┆ 150.0 │
│ 69.625267  ┆ 46.713196 ┆ 150.0 │
│ 70.625267  ┆ 46.713196 ┆ 150.0 │
│ …          ┆ …         ┆ …     │
│ 102.625267 ┆ 86.713196 ┆ 150.0 │
│ 103.625267 ┆ 86.713196 ┆ 150.0 │
│ 104.625267 ┆ 86.713196 ┆ 150.0 │
│ 105.625267 ┆ 86.713196 ┆ 150.0 │
│ 106.625267 ┆ 86.713196 ┆ 150.0 │
└────────────┴───────────┴───────┘
</code></pre>
<pre><code>┌───────────────┐
│ rms[Pa]@0[ns] │
│ ---           │
│ f32           │
╞═══════════════╡
│ 97.675339     │
│ 83.525314     │
│ 60.54364      │
│ 34.229084     │
│ 33.827206     │
│ …             │
│ 51.324219     │
│ 75.84668      │
│ 102.852501    │
│ 120.575188    │
│ 125.698715    │
└───────────────┘
</code></pre>
<p>For more examples, please refer to <a href="https://github.com/shinolab/autd3-emulator/tree/main/examples">autd3-emulator (Rust)</a> and <a href="https://github.com/shinolab/pyautd3/tree/main/example/emulator">pyautd3 (Python)</a>.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/Emulator/emulator.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="advanced-topics"><a class="header" href="#advanced-topics">Advanced Topics</a></h1>
<p>The following introduces advanced settings for core users.</p>
<ul>
<li><a href="Users_Manual/./advanced/custom_gain.html">Custom Gain</a></li>
<li><a href="Users_Manual/./advanced/custom_modulation.html">Custom Modulation</a></li>
<li><a href="Users_Manual/./advanced/async.html">Asynchronous API</a></li>
<li><a href="Users_Manual/./advanced/dynamic_freq.html">Changing Ultrasonic Frequency</a></li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/advanced.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="creating-custom-gain"><a class="header" href="#creating-custom-gain">Creating Custom Gain</a></h1>
<p>In the Rust library, you can create your own <code>Gain</code>.</p>
<blockquote>
<p>NOTE: This feature is not available in the C++, C#, and Python libraries.
However, you can use <a href="Users_Manual/advanced/../API/gain/custom.html">Custom</a> for the same purpose.</p>
</blockquote>
<p>Here, let’s actually define a <code>FocalPoint</code> that generates a single focal point like <code>Focus</code>.</p>
<pre><code class="language-rust edition2024">use autd3::core::derive::*;
<span class="boring">use autd3::prelude::*;
</span>
#[derive(Gain, Debug)]
pub struct FocalPoint {
    pos: Point3,
}

#[derive(Clone, Copy)]
pub struct Impl {
    pos: Point3,
    wavenumber: f32,
}

impl GainCalculator&lt;'_&gt; for Impl {
    fn calc(&amp;self, tr: &amp;Transducer) -&gt; Drive {
        Drive {
            phase: Phase::from(-(self.pos - tr.position()).norm() * self.wavenumber * rad),
            intensity: Intensity::MAX,
        }
    }
}

impl GainCalculatorGenerator&lt;'_&gt; for Impl {
    type Calculator = Impl;

    fn generate(&amp;mut self, _: &amp;Device) -&gt; Self::Calculator {
        *self
    }
}

impl Gain&lt;'_&gt; for FocalPoint {
    type G = Impl;

    fn init(
        self,
        _geometry: &amp;Geometry,
        env: &amp;Environment,
        _mask: &amp;TransducerMask,
    ) -&gt; Result&lt;Self::G, GainError&gt; {
        Ok(Impl {
            pos: self.pos,
            wavenumber: env.wavenumber(),
        })
    }
}
<span class="boring">fn main() {}</span></code></pre>
<p><code>Gain::init</code> returns a (struct that implements) <code>GainContextGenerator</code> that generates a (struct that implements) <code>GainCalculator</code> for each device.
The actual phase and intensity calculations are performed in the <code>GainCalculator::calc</code> function.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/advanced/custom_gain.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="creating-custom-modulation"><a class="header" href="#creating-custom-modulation">Creating Custom Modulation</a></h1>
<p>In the Rust version, you can create your own <code>Modulation</code>.
Here, let’s create a <code>Burst</code> that outputs only at a certain moment during the period<sup class="footnote-reference"><a href="#fn_burst">1</a></sup>.</p>
<blockquote>
<p>NOTE: This feature is not available in the C++, C#, and Python libraries.
However, you can use <a href="Users_Manual/advanced/../API/modulation/custom.html">Custom</a> for the same purpose.</p>
</blockquote>
<p>Below is a sample of this <code>Burst</code>.</p>
<pre><code class="language-rust edition2024"><span class="boring">use autd3::prelude::*;
</span>use autd3::core::derive::*;

#[derive(Modulation, Debug)]
pub struct Burst {
    config: SamplingConfig,
}

impl Burst {
    pub fn new() -&gt; Self {
        Self { 
            config: SamplingConfig::FREQ_4K,
        }
    }
}

impl Modulation for Burst {
    fn calc(self, _: &amp;FirmwareLimits) -&gt; Result&lt;Vec&lt;u8&gt;, ModulationError&gt; {
        Ok((0..4000)
            .map(|i| if i == 3999 { u8::MAX } else { u8::MIN })
            .collect())
    }

    fn sampling_config(&amp;self) -&gt; SamplingConfig {
        self.config
    }
}
<span class="boring">fn main() { 
</span><span class="boring">}</span></code></pre>
<div class="footnote-definition" id="fn_burst"><sup class="footnote-definition-label">1</sup>
<p>Not included in the SDK.</p>
</div>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/advanced/custom_modulation.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="asynchronous-api"><a class="header" href="#asynchronous-api">Asynchronous API</a></h1>
<p>The Rust library supports asynchronous processing.</p>
<blockquote>
<p>NOTE: This feature is not available in the C++, C#, and Python libraries.</p>
</blockquote>
<h2 id="setup-2"><a class="header" href="#setup-2">Setup</a></h2>
<p>To perform asynchronous processing, you need to enable the <code>async</code> feature of the <code>autd3</code> crate.</p>
<pre><code class="language-shell">cargo add autd3 --features "async"
</code></pre>
<p>Also, you may need to enable the <code>async</code> feature for each Link.</p>
<ul>
<li>
<p><code>TwinCAT</code></p>
<pre><code class="language-shell">cargo add autd3-link-twincat --features "async"
</code></pre>
</li>
<li>
<p><code>RemoteTwinCAT</code></p>
<pre><code class="language-shell">cargo add autd3-link-twincat --features "remote async"
</code></pre>
</li>
<li>
<p><code>EtherCrab</code>, <code>Simulator</code></p>
<ul>
<li>Enabled by default</li>
</ul>
</li>
</ul>
<p>To use the asynchronous API, use <code>autd3::r#async::Controller</code> instead of the <code>Controller</code>.</p>
<pre><code class="language-rust edition2024">use autd3::prelude::*;
use autd3_link_ethercrab::{EtherCrab, EtherCrabOption};

#[tokio::main]
async fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
    let mut autd = autd3::r#async::Controller::open(
        [AUTD3 {
            pos: Point3::origin(),
            rot: UnitQuaternion::identity(),
        }],
        EtherCrab::new(
            |idx, status| {
                eprintln!("Device[{}]: {}", idx, status);
            },
            EtherCrabOption::default(),
        ),
    )
    .await?;

    autd.firmware_version().await?.iter().for_each(|firm_info| {
        println!("{}", firm_info);
    });

    autd.send(Silencer::default()).await?;

    let g = Focus {
        pos: autd.center() + Vector3::new(0., 0., 150.0 * mm),
        option: FocusOption::default(),
    };

    let m = Sine {
        freq: 150 * Hz,
        option: SineOption::default(),
    };

    autd.send((m, g)).await?;

    println!("press enter to quit...");
    let mut _s = String::new();
    std::io::stdin().read_line(&amp;mut _s)?;

    autd.close().await?;

    Ok(())
}</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/advanced/async.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="versioning"><a class="header" href="#versioning">Versioning</a></h1>
<p>AUTD3 follows <a href="https://semver.org/">Semantic Versioning</a> starting from v8.2.0.</p>
<p>The version of the AUTD3 SDK is represented as vX.Y.Z.</p>
<ul>
<li>X represents the major version, and compatibility is not guaranteed between SDKs with different major versions.</li>
<li>Y represents the minor version, which is incremented when backward-compatible features are added.</li>
<li>Z represents the patch version, which is incremented when backward-compatible bug fixes are made.</li>
</ul>
<h2 id="firmware-version"><a class="header" href="#firmware-version">Firmware Version</a></h2>
<p>The firmware version is also represented as vX.Y.Z and follows Semantic Versioning.</p>
<p>However, the firmware version is different from the software version.</p>
<p>Refer to the <a href="Users_Manual/./release_notes.html">release notes</a> for the compatibility table between firmware and software versions.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/versioning.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="faq"><a class="header" href="#faq">FAQ</a></h1>
<ul>
<li><a href="Users_Manual/FAQ/faq.html#frequent-link-disconnections">Frequent link disconnections</a></li>
<li><a href="Users_Manual/FAQ/faq.html#errors-when-using-remotetwincat-link">Errors when using <code>RemoteTwinCAT</code> link</a></li>
<li><a href="Users_Manual/FAQ/faq.html#how-to-access-transducer-phaseamplitude-data">How to access transducer phase/amplitude data?</a></li>
<li><a href="Users_Manual/FAQ/faq.html#how-to-access-am-modulation-data">How to access AM modulation data?</a></li>
<li><a href="Users_Manual/FAQ/faq.html#others">Others</a></li>
</ul>
<h2 id="frequent-link-disconnections"><a class="header" href="#frequent-link-disconnections">Frequent link disconnections</a></h2>
<ul>
<li>If this frequently occurs when outputting ultrasound, check if the power supply is sufficient.
<ul>
<li>Each device can consume up to 50W.</li>
</ul>
</li>
</ul>
<h2 id="errors-when-using-remotetwincat-link"><a class="header" href="#errors-when-using-remotetwincat-link">Errors when using <code>RemoteTwinCAT</code> link</a></h2>
<ul>
<li>It may be blocked by the firewall, so either disable the firewall or open TCP/UDP port 48898.</li>
<li>Disconnect all LAN connections other than the server on the client PC.</li>
</ul>
<h2 id="how-to-access-transducer-phaseamplitude-data"><a class="header" href="#how-to-access-transducer-phaseamplitude-data">How to access transducer phase/amplitude data?</a></h2>
<ol>
<li>Use <a href="Users_Manual/FAQ/../API/controller.html#inspect-available-only-in-rust"><code>Controller::inspect</code></a>.</li>
<li>Create your desired <code>Gain</code>. Refer to <a href="Users_Manual/FAQ/../advanced/custom_gain.html">Creating Custom Gain</a>.</li>
</ol>
<h2 id="how-to-access-am-modulation-data"><a class="header" href="#how-to-access-am-modulation-data">How to access AM modulation data?</a></h2>
<ol>
<li>Use <a href="Users_Manual/FAQ/../API/controller.html#inspect-available-only-in-rust"><code>Controller::inspect</code></a>.</li>
<li>Create your desired <code>Modulation</code>. Refer to <a href="Users_Manual/FAQ/../advanced/custom_modulation.html">Creating Custom Modulation</a>.</li>
</ol>
<h2 id="others"><a class="header" href="#others">Others</a></h2>
<ul>
<li>Feel free to ask questions or report bugs on <a href="https://github.com/shinolab/autd3/issues">GitHub Issues</a>.</li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/FAQ/faq.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="citation"><a class="header" href="#citation">Citation</a></h1>
<p>When using this SDK, please consider citing the following papers.</p>
<ul>
<li><a href="https://ieeexplore.ieee.org/document/9392322">S. Suzuki, S. Inoue, M. Fujiwara, Y. Makino and H. Shinoda, “AUTD3: Scalable Airborne Ultrasound Tactile Display,” in IEEE Transactions on Haptics, doi: 10.1109/TOH.2021.3069976.</a></li>
<li>S. Inoue, Y. Makino and H. Shinoda “Scalable Architecture for Airborne Ultrasound Tactile Display”, Asia Haptics 2016</li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/Citation/citation.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="license-1"><a class="header" href="#license-1">LICENSE</a></h1>
<p>The autd3 library itself is licensed under the MIT license.</p>
<p>The autd3 library depends on several third-party libraries.
Refer to <a href="https://github.com/shinolab/autd3">each repository</a> for details on their licenses.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/LICENSE.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="firmware-v10-vs-v11"><a class="header" href="#firmware-v10-vs-v11">Firmware v10 vs v11</a></h1>
<p>This software supports the following firmware versions.</p>
<p>Refer to the table below for differences between versions.</p>
<div class="table-wrapper"><table><thead><tr><th></th><th>v10.0.0</th><th>v11.0.0</th><th>v12.0.0</th><th>v12.1.0</th></tr></thead><tbody>
<tr><td>Maximum buffer size of <a href="Users_Manual/./API/modulation.html">Modulation</a></td><td>32768</td><td>65536</td><td>65536</td><td>65536</td></tr>
<tr><td>Maximum number of patterns for <a href="Users_Manual/./API/stm/focus.html">FociSTM</a></td><td>8192 patterns regardless of the number of foci</td><td>Total number of foci is 65536</td><td>Total number of foci is 65536</td><td>Total number of foci is 65536</td></tr>
<tr><td><a href="Users_Manual/./API/pulse_width_encoder.html">PulseWidthEncoder</a></td><td>Supported (Rust version only)</td><td>Supported</td><td>Supported</td><td>Supported</td></tr>
<tr><td><a href="Users_Manual/./API/gpio_out.html">GPIOOutputType::SysTime</a></td><td>Not supported</td><td>Supported</td><td>Supported</td><td>Supported</td></tr>
<tr><td><a href="Users_Manual/./API/gpio_out.html">GPIOOutputType::SyncDiff</a></td><td>Not supported</td><td>Not supported</td><td>Supported</td><td>Supported</td></tr>
<tr><td><a href="Users_Manual/./API/output_mask.html">OutputMask</a></td><td>Not supported</td><td>Not supported</td><td>Supported</td><td>Supported</td></tr>
</tbody></table>
</div><footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/firmware_version.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="release-notes"><a class="header" href="#release-notes">Release Notes</a></h1>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Date</th><th style="text-align: left">Software Version</th><th style="text-align: left">Firmware Version</th></tr></thead><tbody>
<tr><td style="text-align: left">2025/10/02</td><td style="text-align: left">36.0.2</td><td style="text-align: left">10.0.0+</td></tr>
<tr><td style="text-align: left">2025/07/01</td><td style="text-align: left">35.0.1</td><td style="text-align: left">10.0.0+</td></tr>
<tr><td style="text-align: left">2025/06/25</td><td style="text-align: left">34.0.0</td><td style="text-align: left">10.0.0-12.0.0</td></tr>
<tr><td style="text-align: left">2025/05/25</td><td style="text-align: left">33.0.0</td><td style="text-align: left">10.0.0/11.0.0</td></tr>
<tr><td style="text-align: left">2025/04/22</td><td style="text-align: left">32.1.1</td><td style="text-align: left">10.0.0/11.0.0</td></tr>
<tr><td style="text-align: left">2025/04/16</td><td style="text-align: left">32.1.0</td><td style="text-align: left">10.0.0/11.0.0</td></tr>
<tr><td style="text-align: left">2025/03/26</td><td style="text-align: left">32.0.1</td><td style="text-align: left">10.0.0/11.0.0</td></tr>
<tr><td style="text-align: left">2025/03/24</td><td style="text-align: left">32.0.0</td><td style="text-align: left">10.0.0/11.0.0</td></tr>
<tr><td style="text-align: left">2025/03/07</td><td style="text-align: left">31.0.1</td><td style="text-align: left">10.0.0</td></tr>
<tr><td style="text-align: left">2025/02/24</td><td style="text-align: left">30.0.1</td><td style="text-align: left">10.0.0</td></tr>
<tr><td style="text-align: left">2025/02/10</td><td style="text-align: left">29.0.0</td><td style="text-align: left">10.0.0</td></tr>
<tr><td style="text-align: left">2024/10/15</td><td style="text-align: left">28.1.0</td><td style="text-align: left">10.0.0</td></tr>
<tr><td style="text-align: left">2024/10/14</td><td style="text-align: left">28.0.1</td><td style="text-align: left">10.0.0</td></tr>
<tr><td style="text-align: left">2024/10/12</td><td style="text-align: left">28.0.0</td><td style="text-align: left">10.0.0</td></tr>
<tr><td style="text-align: left">2024/08/09</td><td style="text-align: left">27.0.0</td><td style="text-align: left">9.0.0</td></tr>
<tr><td style="text-align: left">2024/06/29</td><td style="text-align: left">26.0.0</td><td style="text-align: left">8.0.1</td></tr>
<tr><td style="text-align: left">2024/06/18</td><td style="text-align: left">25.3.2</td><td style="text-align: left">8.0.1</td></tr>
<tr><td style="text-align: left">2024/06/17</td><td style="text-align: left">25.3.1</td><td style="text-align: left">8.0.1</td></tr>
<tr><td style="text-align: left">2024/06/14</td><td style="text-align: left">25.2.3</td><td style="text-align: left">8.0.1</td></tr>
<tr><td style="text-align: left">2024/06/10</td><td style="text-align: left">25.1.0</td><td style="text-align: left">8.0.1</td></tr>
<tr><td style="text-align: left">2024/06/08</td><td style="text-align: left">25.0.1</td><td style="text-align: left">8.0.0</td></tr>
<tr><td style="text-align: left">2024/06/06</td><td style="text-align: left">25.0.0</td><td style="text-align: left">8.0.0</td></tr>
<tr><td style="text-align: left">2024/05/22</td><td style="text-align: left">24.1.0</td><td style="text-align: left">7.0.0</td></tr>
<tr><td style="text-align: left">2024/05/18</td><td style="text-align: left">24.0.0</td><td style="text-align: left">7.0.0</td></tr>
<tr><td style="text-align: left">2024/05/13</td><td style="text-align: left">23.1.0</td><td style="text-align: left">7.0.0</td></tr>
<tr><td style="text-align: left">2024/05/11</td><td style="text-align: left">23.0.1</td><td style="text-align: left">7.0.0</td></tr>
<tr><td style="text-align: left">2024/05/11</td><td style="text-align: left">23.0.0</td><td style="text-align: left">7.0.0</td></tr>
<tr><td style="text-align: left">2024/04/08</td><td style="text-align: left">22.1.0</td><td style="text-align: left">6.1.x</td></tr>
<tr><td style="text-align: left">2024/03/30</td><td style="text-align: left">22.0.4</td><td style="text-align: left">6.0.x</td></tr>
<tr><td style="text-align: left">2024/02/25</td><td style="text-align: left">22.0.1</td><td style="text-align: left">6.0.x</td></tr>
<tr><td style="text-align: left">2024/01/29</td><td style="text-align: left">21.1.0</td><td style="text-align: left">5.1.x</td></tr>
<tr><td style="text-align: left">2024/01/26</td><td style="text-align: left">21.0.1</td><td style="text-align: left">5.1.x</td></tr>
<tr><td style="text-align: left">2024/01/11</td><td style="text-align: left">20.0.3</td><td style="text-align: left">5.0.x</td></tr>
<tr><td style="text-align: left">2024/01/05</td><td style="text-align: left">20.0.0</td><td style="text-align: left">5.0.x</td></tr>
<tr><td style="text-align: left">2023/12/14</td><td style="text-align: left">19.1.0</td><td style="text-align: left">4.1.x</td></tr>
<tr><td style="text-align: left">2023/12/10</td><td style="text-align: left">19.0.0</td><td style="text-align: left">4.1.x</td></tr>
<tr><td style="text-align: left">2023/12/04</td><td style="text-align: left">18.0.1</td><td style="text-align: left">4.0.x</td></tr>
<tr><td style="text-align: left">2023/12/02</td><td style="text-align: left">18.0.0</td><td style="text-align: left">4.0.x</td></tr>
<tr><td style="text-align: left">2023/11/29</td><td style="text-align: left">17.0.3</td><td style="text-align: left">4.0.x</td></tr>
<tr><td style="text-align: left">2023/11/28</td><td style="text-align: left">17.0.2</td><td style="text-align: left">4.0.x</td></tr>
<tr><td style="text-align: left">2023/11/27</td><td style="text-align: left">17.0.1</td><td style="text-align: left">4.0.x</td></tr>
<tr><td style="text-align: left">2023/11/27</td><td style="text-align: left">17.0.0</td><td style="text-align: left">4.0.x</td></tr>
<tr><td style="text-align: left">2023/10/14</td><td style="text-align: left">16.0.0</td><td style="text-align: left">3.0.x</td></tr>
<tr><td style="text-align: left">2023/10/04</td><td style="text-align: left">15.3.1</td><td style="text-align: left">3.0.x</td></tr>
<tr><td style="text-align: left">2023/10/04</td><td style="text-align: left">15.3.0</td><td style="text-align: left">3.0.x</td></tr>
<tr><td style="text-align: left">2023/09/29</td><td style="text-align: left">15.2.1</td><td style="text-align: left">3.0.x</td></tr>
<tr><td style="text-align: left">2023/09/28</td><td style="text-align: left">15.2.0</td><td style="text-align: left">3.0.x</td></tr>
<tr><td style="text-align: left">2023/09/22</td><td style="text-align: left">15.1.2</td><td style="text-align: left">3.0.x</td></tr>
<tr><td style="text-align: left">2023/09/15</td><td style="text-align: left">15.1.1</td><td style="text-align: left">3.0.x</td></tr>
<tr><td style="text-align: left">2023/09/14</td><td style="text-align: left">15.1.0</td><td style="text-align: left">3.0.x</td></tr>
<tr><td style="text-align: left">2023/09/14</td><td style="text-align: left">15.0.2</td><td style="text-align: left">3.0.x</td></tr>
<tr><td style="text-align: left">2023/08/07</td><td style="text-align: left">14.2.2</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/08/01</td><td style="text-align: left">14.2.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/07/28</td><td style="text-align: left">14.2.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/07/27</td><td style="text-align: left">14.1.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/07/19</td><td style="text-align: left">14.0.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/07/18</td><td style="text-align: left">14.0.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/07/11</td><td style="text-align: left">13.0.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/07/04</td><td style="text-align: left">12.3.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/07/04</td><td style="text-align: left">12.3.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/06/24</td><td style="text-align: left">12.2.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/06/23</td><td style="text-align: left">12.1.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/06/22</td><td style="text-align: left">12.1.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/06/21</td><td style="text-align: left">12.0.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/06/12</td><td style="text-align: left">11.1.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/06/09</td><td style="text-align: left">11.0.2</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/06/09</td><td style="text-align: left">11.0.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/06/08</td><td style="text-align: left">11.0.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/05/30</td><td style="text-align: left">10.0.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/05/01</td><td style="text-align: left">9.0.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/04/29</td><td style="text-align: left">9.0.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/04/26</td><td style="text-align: left">8.5.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/04/23</td><td style="text-align: left">8.4.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/04/18</td><td style="text-align: left">8.4.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/03/21</td><td style="text-align: left">8.3.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/03/10</td><td style="text-align: left">8.2.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/02/19</td><td style="text-align: left">8.1.2</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/02/03</td><td style="text-align: left">8.1.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/02/02</td><td style="text-align: left">8.1.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/01/24</td><td style="text-align: left">2.8.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/01/18</td><td style="text-align: left">2.7.6</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/01/17</td><td style="text-align: left">2.7.5</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2023/01/12</td><td style="text-align: left">2.7.4</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/12/29</td><td style="text-align: left">2.7.2</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/12/24</td><td style="text-align: left">2.7.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/12/16</td><td style="text-align: left">2.7.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/12/13</td><td style="text-align: left">2.6.8</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/12/10</td><td style="text-align: left">2.6.7</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/12/06</td><td style="text-align: left">2.6.6</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/11/28</td><td style="text-align: left">2.6.5</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/11/22</td><td style="text-align: left">2.6.4</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/11/21</td><td style="text-align: left">2.6.3</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/11/15</td><td style="text-align: left">2.6.2</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/11/13</td><td style="text-align: left">2.6.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/11/10</td><td style="text-align: left">2.6.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/11/08</td><td style="text-align: left">2.5.2</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/11/06</td><td style="text-align: left">2.5.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/11/04</td><td style="text-align: left">2.5.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/10/25</td><td style="text-align: left">2.4.5</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/10/21</td><td style="text-align: left">2.4.4</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/10/18</td><td style="text-align: left">2.4.3</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/10/14</td><td style="text-align: left">2.4.2</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/10/09</td><td style="text-align: left">2.4.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/09/28</td><td style="text-align: left">2.4.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/08/14</td><td style="text-align: left">2.3.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/08/08</td><td style="text-align: left">2.3.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/06/29</td><td style="text-align: left">2.2.2</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/06/22</td><td style="text-align: left">2.2.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/06/10</td><td style="text-align: left">2.2.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/06/02</td><td style="text-align: left">2.1.0</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/05/25</td><td style="text-align: left">2.0.3</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/05/24</td><td style="text-align: left">2.0.2</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/05/22</td><td style="text-align: left">2.0.1</td><td style="text-align: left">N/A</td></tr>
<tr><td style="text-align: left">2022/05/17</td><td style="text-align: left">2.0.0</td><td style="text-align: left">N/A</td></tr>
</tbody></table>
</div><footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/Users_Manual/release_notes.md">Edit this page on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
<h1 id="document-history"><a class="header" href="#document-history">Document History</a></h1>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">Date</th><th style="text-align: left">Description</th></tr></thead><tbody>
<tr><td style="text-align: left">2025/10/02</td><td style="text-align: left">Version 36.0.2 Initial release</td></tr>
<tr><td style="text-align: left">2025/07/01</td><td style="text-align: left">Version 35.0.1 Initial release</td></tr>
<tr><td style="text-align: left">2025/06/25</td><td style="text-align: left">Version 34.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2025/05/28</td><td style="text-align: left">Version 33.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2025/04/22</td><td style="text-align: left">Version 32.1.1 Initial release</td></tr>
<tr><td style="text-align: left">2025/04/16</td><td style="text-align: left">Version 32.1.0 Initial release</td></tr>
<tr><td style="text-align: left">2025/03/26</td><td style="text-align: left">Version 32.0.1 Initial release</td></tr>
<tr><td style="text-align: left">2025/03/25</td><td style="text-align: left">Version 32.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2025/03/07</td><td style="text-align: left">Version 31.0.1 Initial release</td></tr>
<tr><td style="text-align: left">2025/02/24</td><td style="text-align: left">Version 30.0.1 Initial release</td></tr>
<tr><td style="text-align: left">2025/02/10</td><td style="text-align: left">Version 29.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2024/10/15</td><td style="text-align: left">Version 28.1.0 Initial release</td></tr>
<tr><td style="text-align: left">2024/10/14</td><td style="text-align: left">Version 28.0.1 Initial release</td></tr>
<tr><td style="text-align: left">2024/10/12</td><td style="text-align: left">Version 28.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2024/08/09</td><td style="text-align: left">Version 27.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2024/06/29</td><td style="text-align: left">Version 26.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2024/06/18</td><td style="text-align: left">Version 25.3.2 Initial release</td></tr>
<tr><td style="text-align: left">2024/06/17</td><td style="text-align: left">Version 25.3.1 Initial release</td></tr>
<tr><td style="text-align: left">2024/06/14</td><td style="text-align: left">Version 25.2.3 Initial release</td></tr>
<tr><td style="text-align: left">2024/06/10</td><td style="text-align: left">Version 25.1.0 Initial release</td></tr>
<tr><td style="text-align: left">2024/06/08</td><td style="text-align: left">Version 25.0.1 Initial release</td></tr>
<tr><td style="text-align: left">2024/06/06</td><td style="text-align: left">Version 25.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2024/05/22</td><td style="text-align: left">Version 24.1.0 Initial release</td></tr>
<tr><td style="text-align: left">2024/05/18</td><td style="text-align: left">Version 24.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2024/05/13</td><td style="text-align: left">Version 23.1.0 Initial release</td></tr>
<tr><td style="text-align: left">2024/05/11</td><td style="text-align: left">Version 23.0.1 Initial release</td></tr>
<tr><td style="text-align: left">2024/05/11</td><td style="text-align: left">Version 23.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2024/04/08</td><td style="text-align: left">Version 22.1.0 Initial release</td></tr>
<tr><td style="text-align: left">2024/03/30</td><td style="text-align: left">Version 22.0.4 Initial release</td></tr>
<tr><td style="text-align: left">2024/02/25</td><td style="text-align: left">Version 22.0.1 Initial release</td></tr>
<tr><td style="text-align: left">2024/01/29</td><td style="text-align: left">Version 21.1.0 Initial release</td></tr>
<tr><td style="text-align: left">2024/01/26</td><td style="text-align: left">Version 21.0.1 Initial release</td></tr>
<tr><td style="text-align: left">2024/01/11</td><td style="text-align: left">Version 20.0.3 Initial release</td></tr>
<tr><td style="text-align: left">2024/01/05</td><td style="text-align: left">Version 20.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/12/14</td><td style="text-align: left">Version 19.1.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/12/10</td><td style="text-align: left">Version 19.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/12/04</td><td style="text-align: left">Version 18.0.1 Initial release</td></tr>
<tr><td style="text-align: left">2023/12/02</td><td style="text-align: left">Version 18.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/11/29</td><td style="text-align: left">Version 17.0.3 Initial release</td></tr>
<tr><td style="text-align: left">2023/11/28</td><td style="text-align: left">Version 17.0.2 Initial release</td></tr>
<tr><td style="text-align: left">2023/10/14</td><td style="text-align: left">Version 16.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/10/04</td><td style="text-align: left">Version 15.3.1 Initial release</td></tr>
<tr><td style="text-align: left">2023/10/04</td><td style="text-align: left">Version 15.3.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/09/29</td><td style="text-align: left">Version 15.2.1 Initial release</td></tr>
<tr><td style="text-align: left">2023/09/28</td><td style="text-align: left">Version 15.2.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/09/22</td><td style="text-align: left">Version 15.1.2 Initial release</td></tr>
<tr><td style="text-align: left">2023/09/15</td><td style="text-align: left">Version 15.1.1 Initial release</td></tr>
<tr><td style="text-align: left">2023/09/14</td><td style="text-align: left">Version 15.1.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/09/14</td><td style="text-align: left">Version 15.0.2 Initial release</td></tr>
<tr><td style="text-align: left">2023/08/07</td><td style="text-align: left">Version 14.2.2 Initial release</td></tr>
<tr><td style="text-align: left">2023/08/01</td><td style="text-align: left">Version 14.2.1 Initial release</td></tr>
<tr><td style="text-align: left">2023/07/28</td><td style="text-align: left">Version 14.2.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/07/27</td><td style="text-align: left">Version 14.1.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/07/19</td><td style="text-align: left">Version 14.0.1 Initial release</td></tr>
<tr><td style="text-align: left">2023/07/19</td><td style="text-align: left">Version 14.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/07/11</td><td style="text-align: left">Version 13.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/07/04</td><td style="text-align: left">Version 12.3.1 Initial release</td></tr>
<tr><td style="text-align: left">2023/07/04</td><td style="text-align: left">Version 12.3.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/06/24</td><td style="text-align: left">Version 12.2.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/06/23</td><td style="text-align: left">Version 12.1.1 Initial release</td></tr>
<tr><td style="text-align: left">2023/06/22</td><td style="text-align: left">Version 12.1.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/06/21</td><td style="text-align: left">Version 12.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/06/12</td><td style="text-align: left">Version 11.1.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/05/01</td><td style="text-align: left">Version 9.0.1 Initial release</td></tr>
<tr><td style="text-align: left">2023/04/29</td><td style="text-align: left">Version 9.0.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/04/26</td><td style="text-align: left">Version 8.5.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/04/23</td><td style="text-align: left">Version 8.4.1 Initial release</td></tr>
<tr><td style="text-align: left">2023/04/18</td><td style="text-align: left">Version 8.4.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/03/21</td><td style="text-align: left">Version 8.3.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/03/10</td><td style="text-align: left">Version 8.2.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/02/19</td><td style="text-align: left">Version 8.1.2 Initial release</td></tr>
<tr><td style="text-align: left">2023/02/03</td><td style="text-align: left">Version 8.1.1 Initial release</td></tr>
<tr><td style="text-align: left">2023/02/02</td><td style="text-align: left">Version 8.1.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/01/24</td><td style="text-align: left">Version 2.8.0 Initial release</td></tr>
<tr><td style="text-align: left">2023/01/18</td><td style="text-align: left">Version 2.7.6 Initial release</td></tr>
<tr><td style="text-align: left">2023/01/17</td><td style="text-align: left">Version 2.7.5 Initial release</td></tr>
<tr><td style="text-align: left">2023/01/12</td><td style="text-align: left">Version 2.7.4 Initial release</td></tr>
<tr><td style="text-align: left">2022/12/29</td><td style="text-align: left">Version 2.7.2 Initial release</td></tr>
<tr><td style="text-align: left">2022/12/24</td><td style="text-align: left">Version 2.7.1 Initial release</td></tr>
<tr><td style="text-align: left">2022/12/16</td><td style="text-align: left">Version 2.7.0 Initial release</td></tr>
<tr><td style="text-align: left">2022/12/13</td><td style="text-align: left">Version 2.6.8 Initial release</td></tr>
<tr><td style="text-align: left">2022/12/10</td><td style="text-align: left">Version 2.6.7 Initial release</td></tr>
<tr><td style="text-align: left">2022/12/06</td><td style="text-align: left">Version 2.6.6 Initial release</td></tr>
<tr><td style="text-align: left">2022/11/28</td><td style="text-align: left">Version 2.6.5 Initial release</td></tr>
<tr><td style="text-align: left">2022/11/22</td><td style="text-align: left">Version 2.6.4 Initial release</td></tr>
<tr><td style="text-align: left">2022/11/21</td><td style="text-align: left">Version 2.6.3 Initial release</td></tr>
<tr><td style="text-align: left">2022/11/15</td><td style="text-align: left">Version 2.6.2 Initial release</td></tr>
<tr><td style="text-align: left">2022/11/13</td><td style="text-align: left">Version 2.6.1 Initial release</td></tr>
<tr><td style="text-align: left">2022/11/10</td><td style="text-align: left">Version 2.6.0 Initial release</td></tr>
<tr><td style="text-align: left">2022/11/08</td><td style="text-align: left">Version 2.5.2 Initial release</td></tr>
<tr><td style="text-align: left">2022/11/06</td><td style="text-align: left">Version 2.5.1 Initial release</td></tr>
<tr><td style="text-align: left">2022/11/04</td><td style="text-align: left">Version 2.5.0 Initial release</td></tr>
<tr><td style="text-align: left">2022/10/25</td><td style="text-align: left">Version 2.4.5 Initial release</td></tr>
<tr><td style="text-align: left">2022/10/21</td><td style="text-align: left">Version 2.4.4 Initial release</td></tr>
<tr><td style="text-align: left">2022/10/18</td><td style="text-align: left">Version 2.4.3 Initial release</td></tr>
<tr><td style="text-align: left">2022/10/14</td><td style="text-align: left">Version 2.4.2 Initial release</td></tr>
<tr><td style="text-align: left">2022/10/09</td><td style="text-align: left">Version 2.4.1 Initial release</td></tr>
<tr><td style="text-align: left">2022/09/28</td><td style="text-align: left">Version 2.4.0 Initial release</td></tr>
<tr><td style="text-align: left">2022/08/14</td><td style="text-align: left">Version 2.3.1 Initial release</td></tr>
<tr><td style="text-align: left">2022/08/08</td><td style="text-align: left">Version 2.3.0 Initial release</td></tr>
<tr><td style="text-align: left">2022/07/28</td><td style="text-align: left">Version 2.2.2 Added FAQ and TwinCAT</td></tr>
<tr><td style="text-align: left">2022/06/29</td><td style="text-align: left">Version 2.2.2 Initial release</td></tr>
<tr><td style="text-align: left">2022/06/22</td><td style="text-align: left">Version 2.2.1 Initial release</td></tr>
<tr><td style="text-align: left">2022/06/10</td><td style="text-align: left">Version 2.2.0 Initial release</td></tr>
<tr><td style="text-align: left">2022/06/02</td><td style="text-align: left">Version 2.1.0 Initial release</td></tr>
<tr><td style="text-align: left">2022/05/25</td><td style="text-align: left">Version 2.0.3 Initial release</td></tr>
<tr><td style="text-align: left">2022/05/24</td><td style="text-align: left">Version 2.0.2 Initial release</td></tr>
<tr><td style="text-align: left">2022/05/23</td><td style="text-align: left">Added FFI/python, FFI/csharp, migration guide</td></tr>
<tr><td style="text-align: left">2022/05/22</td><td style="text-align: left">Version 2.0.1 Initial release</td></tr>
<tr><td style="text-align: left">2022/05/17</td><td style="text-align: left">Version 2.0.0 Initial release</td></tr>
</tbody></table>
</div><footer id="open-on-gh">Found a bug? <a href="https://github.com/shinolab/autd3-doc/edit/main/src/en/document_history.md">Edit this page on GitHub.</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="js/codeblock_filename.js"></script>
        <script src="js/lightbox-plus-jquery.min.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
